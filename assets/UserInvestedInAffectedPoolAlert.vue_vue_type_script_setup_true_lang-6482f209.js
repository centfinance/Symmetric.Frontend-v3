import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import{b as t,p as i,q as T,h as ue,d as G,ao as me,u as B,z as a,c as g,l as p,A as P,v as C,j as $,i as y,r as V,F,k as pe,x as Y}from"./runtime-core.esm-bundler-558f8953.js";import{at as M,aw as Q,aS as ge,au as ke,bn as fe,ch as _e}from"./BalBtn-cca6788c.js";import{_ as he}from"./BalTable.vue_vue_type_style_index_0_lang-26788def.js";import{_ as Z}from"./BalTooltip.vue_vue_type_style_index_0_lang-8bf6235c.js";import{_ as ye}from"./BalAsset-fcab7531.js";import{_ as ve}from"./BalAssetSet-0f096fdb.js";import{u as be}from"./vue-router-461057a5.js";import{P as Ce}from"./constants-5d025550.js";import{_ as we}from"./APRTooltip.vue_vue_type_script_setup_true_lang-c7384c0d.js";import{u as Pe}from"./useBreakpoints-ee2a85bc.js";import{u as $e,L as U}from"./useDarkMode-6a81be08.js";import{u as I,aa as E,Z as Be,aq as K,ab as Se,Q as Ae,l as Te,R as Le}from"./connector-16147cef.js";import{q as xe,r as Me,s as Ne,v as De,x as Ge,y as Re,u as qe,z as Oe,i as Ve,B as Fe,D as Ee,g as q,k as Ie,c as ze,G as He,H as W,m as je,I as Ue,j as Ke}from"./usePoolHelpers-eb955974.js";import{_ as We}from"./TokenPills.vue_vue_type_script_setup_true_lang-7a301204.js";import{T as Je,a as Ye}from"./tokens_black-ddc115cd.js";import{_ as Qe}from"./BalChip-951d5b52.js";import{P as O,a as Ze}from"./pools-18fd7fb0.js";import{_ as Xe}from"./BalChipNew.vue_vue_type_script_setup_true_lang-8ef0bb16.js";import{_ as es}from"./PoolWarningTooltip.vue_vue_type_script_setup_true_lang-ee6c5f9c.js";import{_ as J}from"./PoolFeatureChip.vue_vue_type_script_setup_true_lang-de605f2d.js";import{P as ss}from"./useProtocols-aae81d2e.js";import{o as os}from"./index.esm-d99d5267.js";import{u as ts}from"./useDisabledJoinPool-118f9751.js";import{i as as,f as ns}from"./useVeBAL-5fa15e49.js";import{_ as is}from"./BalAlert-fdfde589.js";const rs={},ls={class:"app-hero"},ds={class:"mx-auto w-full max-w-lg"};function cs(c,n){return t(),i("div",ls,[T("div",ds,[ue(c.$slots,"default")])])}const ko=ce(rs,[["render",cs]]),us={class:"flex justify-center py-4 px-2"},ms={key:4},ps=G({__name:"PoolsTableActionsCell",props:{pool:{},poolsType:{default:"unstaked"}},emits:["click:stake","click:unstake","click:migrate"],setup(c,{emit:n}){const l=c,{isMigratablePool:f}=xe(me(l,"pool")),{networkSlug:u}=I(),r=B(()=>E.Stakable.VotingGaugePools.concat(E.Stakable.AllowList)),S=B(()=>Me(l.pool.id));return(m,_)=>{const v=Q;return t(),i("div",us,[a(f)(m.pool)?(t(),g(v,{key:0,color:"gradient",size:"sm",onClick:_[0]||(_[0]=M(A=>n("click:migrate",m.pool),["prevent","stop"]))},{default:p(()=>[P(C(m.$t("migrate")),1)]),_:1})):m.poolsType==="unstaked"&&r.value.includes(m.pool.id)?(t(),g(v,{key:1,color:"gradient",size:"sm",disabled:a(f)(m.pool),onClick:_[1]||(_[1]=M(A=>n("click:stake",m.pool),["prevent","stop"]))},{default:p(()=>[P(C(m.$t("stake")),1)]),_:1},8,["disabled"])):m.poolsType==="staked"?(t(),g(v,{key:2,class:"dark:text-gray-300 dark:border-gray-300",outline:"",size:"sm",onClick:_[2]||(_[2]=M(A=>n("click:unstake",m.pool),["prevent","stop"]))},{default:p(()=>[P(C(m.$t("unstake")),1)]),_:1})):S.value?(t(),g(v,{key:3,tag:"router-link",to:{name:"get-vebal",query:{networkSlug:a(u),returnRoute:m.$route.name,returnParams:JSON.stringify({networkSlug:a(u)})}},color:"gradient-pink-yellow",size:"sm"},{default:p(()=>[P(C(m.$t("transactionAction.createLock")),1)]),_:1},8,["to"])):(t(),i("div",ms,"-"))])}}}),gs={class:"flex items-center"},ks=G({__name:"PoolsTableExtraInfo",props:{pool:{}},setup(c){return(n,l)=>{var r;const f=Z,u=Qe;return t(),i("div",gs,[a(Ne)(n.pool)?(t(),g(f,{key:0,text:n.$t("boostedTooltip"),width:"56"},{activator:p(()=>[$(J,{feature:a(O).Boosted,protocols:a(De)(n.pool,a(O).Boosted),class:"ml-1"},null,8,["feature","protocols"])]),_:1},8,["text"])):y("",!0),a(Ge)(n.pool)?(t(),g(f,{key:1,text:n.$t("clpTooltip"),width:"56"},{activator:p(()=>[$(J,{feature:a(O).CLP,protocols:[a(ss).Gyro],class:"ml-1"},null,8,["feature","protocols"])]),_:1},8,["text"])):y("",!0),a(Re)(n.pool.poolType)?(t(),g(u,{key:2,label:"LBP",color:"amber",class:"text-xs font-medium"})):(r=n.pool)!=null&&r.isNew?(t(),g(Xe,{key:3,class:"text-lg font-medium"})):y("",!0),$(es,{pool:n.pool},null,8,["pool"])])}}}),fs="/assets/add-95e5000c.svg",_s="/assets/migrateGauge-f2513340.svg",hs="/assets/poke-76ed2d85.svg",ys="/assets/remove-7aa97297.svg",vs="/assets/stake-19a52128.svg",bs="/assets/unstake-2d312a6e.svg",Cs="/assets/vote-c987fd96.svg";var w=(c=>(c.Add="add",c.Remove="remove",c.Stake="stake",c.Unstake="unstake",c.Vote="vote",c.MigrateGauge="migrateGauge",c.Poke="poke",c))(w||{});const ws={key:0,class:"absolute w-3 h-3 bg-red-500 rounded-full border-2 border-white right-[-4px] top-[-4px]"},Ps={key:0,class:"absolute z-10 bg-white dark:bg-gray-700 rounded border border-gray-200 shadow right-[60px] top-[50px] radius-md"},$s=["onClick"],Bs=["src"],Ss={class:"pr-5 pl-2"},As=G({__name:"PoolsTableActionSelector",props:{pool:{},defaultPoolActions:{},showPokeAction:{type:Boolean,default:!1},showMigrateGaugeAction:{type:Boolean,default:!1}},emits:["click:add","click:remove","click:unstake","click:vote","click:poke","click:migrateGauge"],setup(c){const n=c,{isAffectedBy:l}=qe(B(()=>n.pool.id)),{shouldDisableJoins:f}=ts(n.pool),u=V(!1);function r(){u.value=!1}function S(d){return new URL(Object.assign({"/src/assets/images/icons/pool-actions/add.svg":fs,"/src/assets/images/icons/pool-actions/migrateGauge.svg":_s,"/src/assets/images/icons/pool-actions/poke.svg":hs,"/src/assets/images/icons/pool-actions/remove.svg":ys,"/src/assets/images/icons/pool-actions/stake.svg":vs,"/src/assets/images/icons/pool-actions/unstake.svg":bs,"/src/assets/images/icons/pool-actions/vote.svg":Cs})[`/src/assets/images/icons/pool-actions/${d}.svg`],self.location).href}function m(d){var N;const L=Boolean(Oe(n.pool.id))||l(Ze.PoolProtocolFeeVulnWarning)||Ve(n.pool.id)||f.value||((N=E.BrandedRedirect)==null?void 0:N[n.pool.poolType]),h=[w.Add,w.Stake,w.MigrateGauge];return L&&h.includes(d)||d=="stake"&&!as.value}const _=B(()=>{const d=[...n.defaultPoolActions];return n.showMigrateGaugeAction?d.unshift(w.MigrateGauge):n.showPokeAction&&d.unshift(w.Poke),d}),v=B(()=>_.value.some(d=>d==="migrateGauge"||d==="poke")),A=V(null);return os(A,r),(d,L)=>a(_)?(t(),i("div",{key:0,ref_key:"clickOutsideTarget",ref:A,class:"flex relative justify-end py-4 pr-8"},[T("div",{class:"flex relative justify-center items-center w-7 h-7 text-blue-600 hover:bg-blue-50 rounded-md border-2 border-blue-600 transition-all duration-200 text-[8px]",onClick:L[0]||(L[0]=M(h=>u.value=!a(u),["stop"]))},[a(v)?(t(),i("div",ws)):y("",!0),P(" ••• ")]),a(u)?(t(),i("ul",Ps,[(t(!0),i(F,null,pe(a(_),h=>(t(),i(F,{key:h},[m(h)?y("",!0):(t(),i("li",{key:0,class:Y(["flex items-center py-3 pr-10 pl-3 font-medium text-left dark:hover:text-gray-600 whitespace-pre hover:bg-gray-100 first:rounded-t cursor-pointer radius-md",{"bg-red-50 hover:bg-red-100 dark:bg-red-300 border-b border-gray-200":h===a(w).Poke||h===a(w).MigrateGauge}]),onClick:M(N=>d.$emit(`click:${h}`,d.pool),["stop"])},[T("img",{src:S(h),alt:"",class:"p-0.5 rounded-full w-[20px]"},null,8,Bs),T("div",Ss,C(d.$t(`poolActions.${h}`)),1)],10,$s))],64))),128))])):y("",!0)],512)):y("",!0)}}),Ts={class:"flex items-center"},Ls=["src"],xs=["src"],Ms=["data-testid"],Ns={key:0,class:"flex items-center py-4 px-6"},Ds={key:0,class:"pr-2 text-left"},Gs={key:1},Rs={key:1,class:"text-right"},qs={key:1},Os={class:"flex justify-center py-4 px-2"},Vs={class:"py-4 px-6 text-right"},fo=G({__name:"PoolsTable",props:{data:{default:()=>[]},poolsType:{default:"unstaked"},isLoading:{type:Boolean},isLoadingMore:{type:Boolean,default:!1},showPoolShares:{type:Boolean,default:!1},noPoolsLabel:{default:"No pools"},isPaginated:{type:Boolean,default:!1},sortColumn:{default:"totalLiquidity"},selectedTokens:{default:()=>[]},hiddenColumns:{default:()=>[]},showBoost:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},columnStates:{default:()=>({})},skeletonClass:{default:"h-64"},shares:{},boosts:{},defaultPoolActions:{},shouldPokePoolsMap:{},hasNonPrefGaugesPoolsAddresses:{}},emits:["loadMore","triggerVote","triggerStake","triggerUnstake","triggerCheckpoint","onColumnSort"],setup(c,{emit:n}){const l=c,{fNum:f}=ge(),u=be(),{t:r}=ke(),{trackGoal:S,Goals:m}=_e(),{darkMode:_}=$e(),{upToLargeBreakpoint:v,upToSmallBreakpoint:A}=Pe(),{networkSlug:d}=I(),L=B(()=>A.value?250:350),h=B(()=>[{name:"Icons",id:"icons",accessor:"uri",Header:"iconColumnHeader",Cell:"iconColumnCell",width:125,noGrow:!0},{name:r("composition"),id:"poolName",accessor:"id",Cell:"poolNameCell",width:l.hiddenColumns.length>=2?L.value:350},{name:r("myBoost"),accessor:e=>`${Be(R(e)).toFixed(3)}x`,align:"right",id:"myBoost",hidden:!l.showBoost,sortKey:e=>Number(R(e)),width:150,cellClassName:"font-numeric"},{name:r("myBalance"),accessor:e=>f(H(e),{style:"currency",maximumFractionDigits:0,fixedFormat:!0}),align:"right",id:"myBalance",hidden:!l.showPoolShares,sortKey:e=>Number(H(e)),width:160,cellClassName:"font-numeric"},{name:r("poolValue"),accessor:e=>f(e.totalLiquidity||0,{style:"currency",maximumFractionDigits:0}),align:"right",id:"totalLiquidity",sortKey:e=>{const o=Number(e.totalLiquidity);return o===1/0||isNaN(o)?0:o},width:150,cellClassName:"font-numeric"},{name:r("volume24h",[r("hourAbbrev")]),accessor:e=>(e==null?void 0:e.volumeSnapshot)||"0",align:"right",id:"volume",Cell:"volumeCell",sortKey:e=>{const o=Number(e==null?void 0:e.volumeSnapshot);return o===1/0||isNaN(o)||o>K?0:o},width:175,cellClassName:"font-numeric"},{name:l.showPoolShares?r("myApr"):r("apr"),Cell:"aprCell",accessor:e=>{var o;return((o=e==null?void 0:e.apr)==null?void 0:o.min.toString())||"0"},align:"right",id:"apr",sortKey:e=>{var b;let o=0;return e!=null&&e.apr&&(o=Number(Fe(e.apr,e.boost))),isFinite(o)&&(((b=e.apr)==null?void 0:b.swapFees)||0)<Se?o:0},width:150},{name:r("expiryDate"),Cell:"lockEndDateCell",accessor:"lockedEndDate",align:"right",id:"lockEndDate",width:150},{name:r("migrate"),Cell:"migrateCell",accessor:"migrate",align:"center",id:"migrate",width:150},{name:r("actions"),Cell:"actionsCell",accessor:"actions",align:"right",id:"actions",hidden:!l.showActions,width:150}]),N=B(()=>h.value.filter(e=>!l.hiddenColumns.includes(e.id)));function X(e,o){S(m.ClickPoolsTableRow);const b=u.resolve({name:"pool",params:{id:e.id,networkSlug:d}});o?window.open(b.href):u.push(b)}function z(e){var o;u.push({name:"migrate-pool",params:{from:e.id,to:(o=Ae.network.pools.Migrations)==null?void 0:o[e.id].toPoolId},query:{returnRoute:"home"}})}function H(e){var b;const o=((b=l==null?void 0:l.shares)==null?void 0:b[e.id])||"0";return Ee(e,o)}function R(e){var o;return e.boost||((o=l==null?void 0:l.boosts)==null?void 0:o[e.id])||"1"}function ee(e){const o=e==null?void 0:e.apr;return o?Ue(o,R(e)):"0"}function se(e){return e?ns(e,Ce):"—"}function oe(e){var o;return(o=q(e.id))!=null&&o.hasIcon?[e.address]:Ke(e)}function te(e){u.push({name:"add-liquidity",params:{id:e,networkSlug:d}})}function ae(e){u.push({name:"withdraw",params:{id:e,networkSlug:d}})}function ne(e){u.push({name:"pool",params:{id:e,networkSlug:d}})}return(e,o)=>{const b=ve,j=ye,ie=Z,re=Q,le=he,de=fe;return t(),g(de,{shadow:"lg",square:a(v),noBorder:a(v),noPad:"",exposeOverflow:""},{default:p(()=>[$(le,{columns:N.value,data:e.data,noResultsLabel:e.noPoolsLabel,isLoading:e.isLoading,isLoadingMore:e.isLoadingMore,skeletonClass:e.skeletonClass,sticky:"both",square:a(v),onRowClick:X,isPaginated:e.isPaginated,isOnlyDescSort:"",initialState:{sortColumn:e.sortColumn,sortDirection:"desc"},onOnColumnSort:o[1]||(o[1]=s=>n("onColumnSort",s)),onLoadMore:o[2]||(o[2]=s=>n("loadMore"))},{iconColumnHeader:p(()=>[T("div",Ts,[a(_)?(t(),i("img",{key:0,src:a(Je),alt:"token",loading:"lazy",width:"24",height:"15"},null,8,Ls)):(t(),i("img",{key:1,src:a(Ye),alt:"token",loading:"lazy",width:"24",height:"15"},null,8,xs))])]),iconColumnCell:p(s=>[e.isLoading?y("",!0):(t(),i("div",{key:0,class:"py-4 px-6","data-testid":s==null?void 0:s.id},[$(b,{addresses:oe(s),width:100},null,8,["addresses"])],8,Ms))]),poolNameCell:p(s=>{var x,D;return[e.isLoading?y("",!0):(t(),i("div",Ns,[(x=a(q)(s.id))!=null&&x.name?(t(),i("div",Ds,C((D=a(q)(s.id))==null?void 0:D.name),1)):(t(),i("div",Gs,[$(We,{tokens:a(Ie)(s,s.tokens),isStablePool:a(ze)(s.poolType),selectedTokens:e.selectedTokens,pickedTokens:e.selectedTokens},null,8,["tokens","isStablePool","selectedTokens","pickedTokens"])])),$(ks,{pool:s},null,8,["pool"])]))]}),volumeCell:p(s=>[(t(),i("div",{key:e.columnStates.volume,class:"flex justify-end py-4 px-6 -mt-1 font-numeric"},[s!=null&&s.volumeSnapshot?(t(),i("span",Rs,C(a(f)((s==null?void 0:s.volumeSnapshot)<a(K)?s==null?void 0:s.volumeSnapshot:"-",{style:"currency",maximumFractionDigits:0})),1)):(t(),g(j,{key:0,class:"w-12 h-4"}))]))]),aprCell:p(s=>[(t(),i("div",{key:e.columnStates.aprs,class:Y(["flex justify-end py-4 px-6 -mt-1 font-numeric text-right",{"text-gray-300 dark:text-gray-600 line-through":a(W)(s.poolType)}])},[s!=null&&s.apr?a(He)(s.id)?(t(),i("span",qs,"-")):(t(),i(F,{key:2},[P(C(ee(s))+" ",1),a(W)(s.poolType)?(t(),g(ie,{key:0,width:"36",text:e.$t("lbpAprTooltip"),iconSize:"sm",iconClass:"ml-1"},null,8,["text"])):s!=null&&s.apr?(t(),g(we,{key:1,pool:s},null,8,["pool"])):y("",!0)],64)):(t(),g(j,{key:0,class:"w-12 h-4"}))],2))]),migrateCell:p(s=>[T("div",Os,[a(je)(s)?(t(),g(re,{key:0,color:"gradient",size:"sm",onClick:M(x=>z(s),["prevent"])},{default:p(()=>[P(C(e.$t("migrate")),1)]),_:2},1032,["onClick"])):y("",!0)])]),lockEndDateCell:p(s=>[T("div",Vs,C(se(s.lockedEndDate)),1)]),actionsCell:p(s=>{var x,D;return[e.defaultPoolActions?(t(),g(As,{key:0,defaultPoolActions:e.defaultPoolActions,pool:s,showPokeAction:Boolean((x=e.shouldPokePoolsMap)==null?void 0:x[s.address])||!1,showMigrateGaugeAction:((D=e.hasNonPrefGaugesPoolsAddresses)==null?void 0:D.includes(s.address))||!1,"onClick:add":k=>te(s.id),"onClick:remove":k=>ae(s.id),"onClick:unstake":k=>n("triggerUnstake",k),"onClick:stake":k=>n("triggerStake",k),"onClick:vote":o[0]||(o[0]=k=>n("triggerVote")),"onClick:migrateGauge":k=>ne(s.id),"onClick:poke":k=>n("triggerCheckpoint",k)},null,8,["defaultPoolActions","pool","showPokeAction","showMigrateGaugeAction","onClick:add","onClick:remove","onClick:unstake","onClick:stake","onClick:migrateGauge","onClick:poke"])):(t(),g(ps,{key:1,pool:s,poolsType:e.poolsType,"onClick:stake":k=>n("triggerStake",k),"onClick:unstake":k=>n("triggerUnstake",k),"onClick:migrate":k=>z(k)},null,8,["pool","poolsType","onClick:stake","onClick:unstake","onClick:migrate"]))]}),_:1},8,["columns","data","noResultsLabel","isLoading","isLoadingMore","skeletonClass","square","isPaginated","initialState"])]),_:1},8,["square","noBorder"])}}}),Fs={key:0,class:"px-4 xl:px-0"},Es=!1,_o=G({__name:"UserInvestedInAffectedPoolAlert",setup(c){const n=V(Te(U.Alerts.RecoveryExitDismissed,!1)),{networkSlug:l}=I();function f(){Le(U.Alerts.RecoveryExitDismissed,!0),n.value=!0}return(u,r)=>{const S=is;return Es&&!a(n)?(t(),i("div",Fs,[$(S,{type:"error",title:"Pool Vulnerability - August 22, 2023",actionLabel:"Withdraw now",class:"mb-4",block:"",dismissable:"",onClose:f,onActionClick:r[0]||(r[0]=m=>u.$router.push({name:"recovery-exit",params:{networkSlug:a(l)}}))},{default:p(()=>[P("A vulnerability has been discovered that affects a pool you are deposited in. Please withdraw your funds as soon as possible.")]),_:1})])):y("",!0)}}});export{ko as A,w as P,_o as _,fo as a};
//# sourceMappingURL=UserInvestedInAffectedPoolAlert.vue_vue_type_script_setup_true_lang-6482f209.js.map
