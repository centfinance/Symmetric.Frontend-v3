var Ne=Object.defineProperty;var je=(s,e,t)=>e in s?Ne(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var O=(s,e,t)=>(je(s,typeof e!="symbol"?e+"":e,t),t);import{_ as Oe}from"./BalLink-65772d8f.js";import{a$ as Qe,aJ as be,aq as U,av as H,aZ as z,a_ as ie,aO as Ue,b1 as re,au as N,aS as P,aU as x,bn as oe,b3 as le,aP as ue,aT as V,b2 as We,aw as He,ao as ze}from"./BalBtn-cca6788c.js";import{d as E,u as g,N as X,aj as q,b as v,c as A,z as i,r as ce,l as b,j as T,q as f,p as D,v as h,m as Ke,i as I,C as he,ap as Ye,F as we,k as ve,A as F}from"./runtime-core.esm-bundler-558f8953.js";import{_ as Ze}from"./BalBlankSlate.vue_vue_type_style_index_0_lang-8c053ed8.js";import{B as xe,_ as Je}from"./BalAsset-fcab7531.js";import{_ as Xe}from"./BalTooltip.vue_vue_type_style_index_0_lang-8bf6235c.js";import{Q as B,u as Re,T as te,o as K,Z as S,n as et,V as Q,U as $e,N as ee}from"./connector-16147cef.js";import{H as tt}from"./HeroClaim-acdf3c3b.js";import{_ as de}from"./BalTable.vue_vue_type_style_index_0_lang-26788def.js";import{_ as at}from"./BalAssetSet-0f096fdb.js";import{u as nt}from"./vue-router-461057a5.js";import{_ as pe}from"./TxActionBtn.vue_vue_type_script_setup_true_lang-663c84ee.js";import{l as st,j as it,g as ae,k as rt,c as Ae}from"./usePoolHelpers-eb955974.js";import{_ as ot}from"./TokenPills.vue_vue_type_script_setup_true_lang-7a301204.js";import{u as me}from"./useBreakpoints-ee2a85bc.js";import{_ as lt}from"./PoolWarningTooltip.vue_vue_type_script_setup_true_lang-ee6c5f9c.js";import{L as ut}from"./liquidity-gauge-c56bdf84.js";import{u as ct}from"./useGraphQuery-d0a03aea.js";import{i as Te}from"./useQueryHelpers-8fe10019.js";import{s as dt}from"./subgraph-fallback.service-7e7c32be.js";import{S as pt}from"./StablePhantomPool-f25cd4a4.js";import{c as mt}from"./urls-2a720267.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./useDarkMode-6a81be08.js";import"./browser-6c45db04.js";import"./_commonjsHelpers-87174ba5.js";import"./metamask.connector-0225016b.js";import"./Avatar.vue_vue_type_script_setup_true_lang-5ab9890e.js";import"./BalStack.vue_vue_type_script_lang-342e535e.js";import"./useTransactions-114fc9d7.js";import"./index-fe1d1633.js";import"./events-5f626723.js";import"./readable-browser-a0df197a.js";import"./immutable-2b056f5a.js";import"./index-1de0572e.js";import"./pools-18fd7fb0.js";const yt=E({name:"BalFlexGrid",props:{gap:{type:Number,default:4},flexWrap:{type:Boolean,default:!1}},setup(s,{slots:e}){const t=g(()=>(s.gap/2).toString()),a=g(()=>({"flex-wrap":s.flexWrap})),c=e.default()[0].children.map(u=>X("div",{class:`px-${t.value} mb-${t.value}`},[u]));return()=>X("div",{class:`px-${t.value}`},[X("div",{class:[`flex -mx-${s.gap}`,a.value]},c)])}}),ft=8;class gt{constructor(){O(this,"multicaller");const e=Qe();this.multicaller=new e}async decorate(e,t){this.callRewardTokens(e),this.callClaimableTokens(e,t);let a=await this.multicaller.execute();const n=e.filter(u=>!u.streamer);this.callClaimableRewards(n,t,a,!1);const c=e.filter(u=>!!u.streamer);return this.callClaimableRewards(c,t,a,!0),a=await this.multicaller.execute(a),e.map(u=>({...u,...this.format(a[u.id])}))}format(e){var t;return{...e,rewardTokens:this.formatRewardTokens(e.rewardTokens),claimableTokens:((t=e.claimableTokens)==null?void 0:t.toString())||"0",claimableRewards:this.formatClaimableRewards(e.claimableRewards)}}callRewardTokens(e){e.forEach(t=>{for(let a=0;a<ft;a++)this.multicaller.call({key:`${t.id}.rewardTokens[${a}]`,address:t.id,abi:["function reward_tokens(uint256) view returns (address)"],function:"reward_tokens",params:[a]})})}formatRewardTokens(e){return e.filter(t=>t!==be)}callClaimableTokens(e,t){e.forEach(a=>{this.multicaller.call({key:`${a.id}.claimableTokens`,address:a.id,function:"claimable_tokens",abi:["function claimable_tokens(address) view returns (uint256)"],params:[t]})})}callClaimableRewards(e,t,a,n){const c=n?"getPendingRewards":"claimable_reward";e.forEach(u=>{a[u.id].rewardTokens.forEach(p=>{if(p===be)return;const y=n?[u.id,t,p]:[t,p],r=n&&B.network.addresses.gaugeRewardsHelper?B.network.addresses.gaugeRewardsHelper:u.id,l=n?["function getPendingRewards(address,address,address) view returns (uint256)"]:["function claimable_reward(address,address) view returns (uint256)"];this.multicaller.call({key:`${u.id}.claimableRewards.${p}`,address:r,function:c,abi:l,params:y})})})}formatClaimableRewards(e){return e?(Object.keys(e).forEach(t=>{e[t]||(e[t]="0"),e[t]=e[t].toString()}),e):{}}}const bt=new gt;function ye(s,e={}){const{account:t,isWalletReady:a}=U(),{networkId:n}=Re(),{injectTokens:c}=H(),u=g(()=>{var l;return(s==null?void 0:s.value)&&((l=s.value)==null?void 0:l.length)>0&&a.value}),p=q(z.Gauges.All.Onchain(s,t,n)),y=async()=>{if(!s.value)return null;const l=await bt.decorate(s.value,t.value),d=l.map(m=>m.rewardTokens).flat();return await c(d),l},r=q({enabled:u,...e});return ie(p,y,r)}const ht={first:999},wt={id:!0,symbol:!0,poolId:!0,totalSupply:!0,isKilled:!0,factory:{id:!0},isPreferentialGauge:!0,streamer:!0},vt=(s={},e={},t=void 0)=>({__name:t,liquidityGauges:{__args:te.merge({},ht,s),...te.merge({},wt,e)}});class Tt{constructor(e,t=vt){this.service=e,this.query=t}async get(e={},t={}){const a="Gauges",n=this.query(e,t,a);return(await this.service.client.get(n)).liquidityGauges}}class _t{constructor(e=B.network.subgraphs.gauge){this.url=e}async get(e){try{if(!this.url)return{liquidityGauges:[]};const t=this.payloadFor(e),{data:{data:a}}=await Ue.post(this.url,t);return a}catch(t){throw console.error("GaugesSubgraphClient request failed",t),t}}payloadFor(e){return{query:st.jsonToGraphQLQuery({query:e})}}}const kt=new _t;class Ct{constructor(e=kt){O(this,"gauges");this.client=e,this.gauges=new Tt(this)}}const Bt=new Ct;function fe(s={}){const e=q(z.Gauges.All.Static()),t=async()=>{try{return await Bt.gauges.get()}catch(n){return console.error("Failed to fetch gauges",n),[]}},a=q({enabled:!0,...s});return ie(e,t,a)}const xt=[{inputs:[{internalType:"contract IBalancerTokenAdmin",name:"tokenAdmin",type:"address"},{internalType:"contract IGaugeController",name:"gaugeController",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"recipient",type:"address"},{indexed:!1,internalType:"address",name:"gauge",type:"address"},{indexed:!1,internalType:"uint256",name:"minted",type:"uint256"}],name:"Minted",type:"event"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"allowed_to_mint_for",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"approvedMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBalancerTokenAdmin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGaugeController",outputs:[{internalType:"contract IGaugeController",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"mintFor",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"gauges",type:"address[]"}],name:"mintMany",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"gauges",type:"address[]"},{internalType:"address",name:"user",type:"address"}],name:"mintManyFor",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"mint_for",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[8]",name:"gauges",type:"address[8]"}],name:"mint_many",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"gauge",type:"address"}],name:"minted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"bool",name:"approval",type:"bool"}],name:"setMinterApproval",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"toggle_approve_mint",outputs:[],stateMutability:"nonpayable",type:"function"}];class Rt{constructor(e=xt,t=B,a=re,n=t.network.addresses.balancerMinter){this.abi=e,this.config=t,this.walletService=a,this.address=n}async mint(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"mint",params:[e]})}async mintMany(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"mintMany",params:[e]})}}const _e=new Rt,ke=E({__name:"ClaimBalBtn",props:{gauges:{},label:{},amount:{}},setup(s){const e=s,{t}=N(),{fNum:a}=P(),{data:n}=fe(),c=ye(n),u=g(()=>e.gauges.map(y=>K(y.id)));async function p(){return e.gauges.length===1?await _e.mint(u.value[0]):await _e.mintMany(u.value)}return(y,r)=>(v(),A(pe,{label:y.label,color:"gradient",size:"sm",actionFn:p,onConfirmFn:i(c).refetch,action:"claim",summary:`${i(t)("claim")} ${i(a)(e.amount,i(x).token)} BAL`,confirmingLabel:y.$t("claiming")},null,8,["label","onConfirmFn","summary","confirmingLabel"]))}}),$t={class:"py-4 px-6"},At={class:"flex items-center py-4 px-6"},St={key:0,class:"text-left"},Mt={class:"py-4 px-6"},Dt={class:"flex justify-end"},Lt={class:"flex justify-end"},It=E({__name:"BalClaimsTable",props:{rewardsData:{},isLoading:{type:Boolean}},setup(s){const e=s,{t}=N(),{upToLargeBreakpoint:a}=me(),{fNum:n}=P(),c=nt(),{networkSlug:u}=Re(),p=ce([{name:t("pools"),id:"icons",accessor:"icons",Cell:"iconsColumnCell",width:50,noGrow:!0},{name:"",id:"pills",accessor:"pills",Cell:"pillsColumnCell",width:350},{name:t("amount"),id:"amount",align:"right",width:150,totalsCell:"totalAmountCell",accessor:({amount:m})=>`${n(m,x.token)} BAL`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:m})=>n(m,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"claimTotalCell",width:150}]),y=g(()=>e.rewardsData.map(m=>m.gauge)),r=g(()=>e.rewardsData.reduce((m,M)=>m.plus(M.amount),S("0")).toString()),l=g(()=>e.rewardsData.reduce((m,M)=>m.plus(M.value),S("0")).toString());function d({pool:m}){c.push({name:"pool",params:{id:m.id,networkSlug:u}})}return(m,M)=>{const C=at,R=de,j=oe;return v(),A(j,{shadow:"lg",square:i(a),noBorder:i(a),noPad:""},{default:b(()=>[T(R,{columns:i(p),data:m.rewardsData,noResultsLabel:m.$t("noResultsTable.noBalIncentives"),isLoading:m.isLoading,onRowClick:d,skeletonClass:"h-24",square:i(a)},{iconsColumnCell:b(({pool:$})=>[f("div",$t,[T(C,{addresses:i(it)($),width:100},null,8,["addresses"])])]),pillsColumnCell:b(({pool:$})=>[f("div",At,[i(ae)($.id)?(v(),D("div",St,h(i(ae)($.id).name),1)):(v(),A(ot,{key:1,tokens:i(rt)($,$.tokens),isStablePool:i(Ae)($.poolType)},null,8,["tokens","isStablePool"])),T(lt,{pool:$},null,8,["pool"])])]),claimColumnCell:b(({gauge:$,amount:Y})=>[f("div",Mt,[T(ke,{label:m.$t("claim"),gauges:[$],amount:Y},null,8,["label","gauges","amount"])])]),totalAmountCell:b(()=>[f("div",Dt,h(i(n)(i(r),i(x).token))+" BAL ",1)]),totalValueCell:b(()=>[f("div",Lt,h(i(n)(i(l),i(x).fiat)),1)]),claimTotalCell:b(()=>[T(ke,{label:m.$t("claimAll"),gauges:i(y),amount:i(r)},null,8,["label","gauges","amount"])]),_:1},8,["columns","data","noResultsLabel","isLoading","square"])]),_:1},8,["square","noBorder"])}}}),Et=[{inputs:[],name:"CLAIM_FREQUENCY",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"claimRewardsFromGauge",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge[]",name:"gauges",type:"address[]"},{internalType:"address",name:"user",type:"address"}],name:"claimRewardsFromGauges",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"getPendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"}];class Gt{constructor(e,t=ue.jsonProvider,a=Et,n=re){O(this,"instance");this.address=e,this.provider=t,this.abi=a,this.walletService=n,this.instance=new le(this.address,this.abi,this.provider)}async claimRewardsForGauge(e,t){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimRewardsFromGauge",params:[e,t]})}}const qt=E({__name:"ClaimRewardsBtn",props:{gauge:{},fiatValue:{}},setup(s){const e=s,{t}=N(),{fNum:a}=P(),{data:n}=fe(),{account:c}=U(),u=ye(n),p=K(e.gauge.id),y=new ut(p);function r(){return e.gauge.streamer?new Gt(B.network.addresses.gaugeRewardsHelper||"").claimRewardsForGauge(p,c.value):y.claimRewards()}return(l,d)=>(v(),A(pe,{label:i(t)("claimAll"),color:"gradient",size:"sm",actionFn:r,onConfirmFn:i(u).refetch,action:"claim",summary:`${i(t)("claim")} ${i(a)(e.fiatValue,i(x).fiat)}`,confirmingLabel:i(t)("claiming")},null,8,["label","onConfirmFn","summary","confirmingLabel"]))}}),Pt={class:"flex items-center py-4 px-6"},Ft={class:"ml-2"},Vt={class:"flex justify-end"},Nt={class:""},jt=E({__name:"GaugeRewardsTable",props:{gauge:{},isLoading:{type:Boolean}},setup(s){const e=s,{t}=N(),{upToLargeBreakpoint:a}=me(),{fNum:n,toFiat:c}=P(),{getToken:u}=H(),p=ce([{name:t("incentiveToken"),id:"token",accessor:"token",Cell:"tokenColumnCell",width:475,noGrow:!0},{name:t("amount"),id:"amount",align:"right",width:150,accessor:({amount:l,token:d})=>`${n(l,x.token)} ${d==null?void 0:d.symbol}`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:l})=>n(l,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"totalClaimCell",width:150}]),y=g(()=>e.gauge.rewardTokens.map(l=>{const d=u(l),m=V(e.gauge.claimableRewards[l],(d==null?void 0:d.decimals)||18);return S(m).isZero()||!(d!=null&&d.address)||!(d!=null&&d.symbol)||!(d!=null&&d.decimals)?null:{token:d,amount:m,value:d!=null&&d.address?c(m,d==null?void 0:d.address):"0"}}).filter(l=>l!==null)),r=g(()=>y.value.reduce((l,d)=>l.plus(d.value),S("0")).toString());return(l,d)=>{const m=xe,M=de,C=oe;return v(),A(C,{shadow:"lg",square:i(a),noBorder:i(a),noPad:""},{default:b(()=>[T(M,{columns:p.value,data:y.value,isLoading:l.isLoading,skeletonClass:"h-64",square:i(a)},{tokenColumnCell:b(({token:R})=>[f("div",Pt,[T(m,{iconURI:R==null?void 0:R.logoURI},null,8,["iconURI"]),f("span",Ft,h(R==null?void 0:R.name),1)])]),totalValueCell:b(()=>[f("div",Vt,h(i(n)(r.value,i(x).fiat)),1)]),totalClaimCell:b(()=>[f("div",Nt,[T(qt,{gauge:l.gauge,fiatValue:r.value},null,8,["gauge","fiatValue"])])]),_:1},8,["columns","data","isLoading","square"])]),_:1},8,["square","noBorder"])}}}),Ot=[{inputs:[{internalType:"contract IVotingEscrow",name:"votingEscrow",type:"address"},{internalType:"uint256",name:"startTime",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"lastCheckpointTimestamp",type:"uint256"}],name:"TokenCheckpointed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"contract IERC20",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"userTokenTimeCursor",type:"uint256"}],name:"TokensClaimed",type:"event"},{inputs:[],name:"checkpoint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"checkpointToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"checkpointTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"checkpointUser",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20",name:"token",type:"address"}],name:"claimToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"claimTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"depositToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],name:"depositTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenLastBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getTokensDistributedInWeek",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getTotalSupplyAtTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getUserBalanceAtTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20",name:"token",type:"address"}],name:"getUserTokenTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVotingEscrow",outputs:[{internalType:"contract IVotingEscrow",name:"",type:"address"}],stateMutability:"view",type:"function"}],Qt=[{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"claimTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"}];class W{constructor(e,t=Ot,a=Qt,n=B,c=re,u=ue.jsonProvider){O(this,"claimableTokens",["0x7B50775383d3D6f0215A8F290f2C9e2eEBBEceb2","0xA13a9247ea42D743238089903570127DdA72fE44","0xfeBb0bbf162E64fb9D0dfe186E517d84C395f016","0xba100000625a3754423978a60c9317c58a424e3D","0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"]);this.address=e,this.abi=t,this.staticAbi=a,this.config=n,this.walletService=c,this.provider=u}getInstance(){return new le(this.address,this.abi,this.provider)}getMulticaller(){const e=We();return new e(this.config.network.key,this.provider,this.abi)}async getClaimableBalances(e){const a=(await this.walletService.txBuilder.contract.callStatic({contractAddress:this.address,abi:this.staticAbi,action:"claimTokens",params:[e,this.claimableTokens]})).map(n=>n.toString());return te.zipObject(this.claimableTokens,a)}async claimBalances(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimTokens",params:[e,this.claimableTokens]})}async claimBalance(e,t){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimToken",params:[e,t]})}async getTokensDistributedInWeek(e,t,a){a||(a=this.getInstance());const n=await a.getTokensDistributedInWeek(e,t);return V(n,18)}async getTotalSupply(e,t){t||(t=this.getInstance());const a=await t.getTotalSupplyAtTimestamp(e);return V(a,18)}}const Ut=new W(B.network.addresses.feeDistributorDeprecated),Wt=new W(B.network.addresses.feeDistributor),ne=g(()=>B.network.addresses.feeDistributorDeprecated!=""||B.network.addresses.feeDistributor!="");function Se(s={}){const{account:e,isWalletReady:t}=U(),a=g(()=>t.value&&e.value!=null&&ne.value),n=q(z.Claims.Protocol(et,e)),c=async()=>{try{const[p,y]=await Promise.all([Ut.getClaimableBalances(e.value),Wt.getClaimableBalances(e.value)]);return{v1:p,v2:y}}catch(p){return console.error("Failed to fetch claimable protocol balances",p),{}}},u=q({enabled:a,...s});return ie(n,c,u)}const Ce=E({__name:"ClaimProtocolRewardsBtn",props:{tokenAddress:{},fiatValue:{},deprecated:{type:Boolean}},setup(s){const e=s,t=new W(B.network.addresses.feeDistributorDeprecated),a=new W(B.network.addresses.feeDistributor),{t:n}=N(),{fNum:c}=P(),{account:u}=U(),p=Se();function y(){const r=e.deprecated?t:a;return e.tokenAddress?r.claimBalance(u.value,e.tokenAddress):r.claimBalances(u.value)}return(r,l)=>(v(),A(pe,Ke({label:r.tokenAddress?r.$t("claim"):r.$t("claimAll"),color:"gradient",size:"sm",actionFn:y,onConfirmFn:i(p).refetch,action:"claim",summary:`${i(n)("claim")} ${i(c)(r.fiatValue,i(x).fiat)}`,confirmingLabel:r.$t("claiming")},r.$attrs),null,16,["label","onConfirmFn","summary","confirmingLabel"]))}}),Ht={key:0,class:"px-4 xl:px-0 mt-4 mb-2"},zt={class:"text-lg"},Kt={class:"mb-3"},Yt={class:"flex justify-center ml-4 xl:ml-0"},Zt={class:"flex py-4 px-6"},Jt={class:"flex justify-end"},Xt={class:"py-4 px-6"},Be=E({__name:"ProtocolRewardsTable",props:{rewardsData:{},isLoading:{type:Boolean},deprecated:{type:Boolean,default:!1}},setup(s){const e=s,{t}=N(),{upToLargeBreakpoint:a}=me(),{fNum:n}=P(),c=ce([{name:t("token"),id:"token",accessor:"token",Cell:"tokenColumnCell",align:"left",width:50,noGrow:!0},{name:"",id:"symbol",accessor:"symbol",Cell:"symbolColumnCell",width:350},{name:t("amount"),id:"amount",align:"right",width:150,accessor:({amount:r})=>`${n(r,x.token)}`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:r})=>n(r,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"claimTotalCell",width:150}]),u=g(()=>e.rewardsData.reduce((r,l)=>r.plus(l.amount),S("0")).toString()),p=g(()=>e.rewardsData.reduce((r,l)=>r.plus(l.value),S("0")).toString()),y=g(()=>e.isLoading?!0:S(u.value).gt(0));return(r,l)=>{const d=xe,m=de,M=oe;return v(),D("div",null,[r.deprecated&&y.value?(v(),D("div",Ht,[f("h6",zt,h(r.$t("pastEarnings.title")),1),f("p",Kt,h(r.$t("pastEarnings.description")),1)])):I("",!0),y.value||!r.deprecated?(v(),A(M,{key:1,shadow:"lg",square:i(a),noBorder:i(a),noPad:"",class:"mb-8"},{default:b(()=>[T(m,{columns:c.value,data:r.rewardsData,noResultsLabel:r.$t("noResultsTable.noProtocolRevenue"),isLoading:r.isLoading,skeletonClass:"h-24",square:i(a)},{tokenColumnCell:b(({token:C})=>[f("div",Yt,[T(d,{address:C.address},null,8,["address"])])]),symbolColumnCell:b(({token:C})=>[f("div",Zt,h(C.symbol),1)]),totalValueCell:b(()=>[f("div",Jt,h(i(n)(p.value,i(x).fiat)),1)]),claimColumnCell:b(({token:C,amount:R,value:j})=>[f("div",Xt,[T(Ce,{tokenAddress:C.address,fiatValue:j,disabled:i(S)(R).eq(0),deprecated:r.deprecated},null,8,["tokenAddress","fiatValue","disabled","deprecated"])])]),claimTotalCell:b(()=>[T(Ce,{fiatValue:p.value,disabled:!y.value,deprecated:r.deprecated},null,8,["fiatValue","disabled","deprecated"])]),_:1},8,["columns","data","noResultsLabel","isLoading","square"])]),_:1},8,["square","noBorder"])):I("",!0)])}}});function ea(){const s=Se(),e=g(()=>s.data.value||{}),t=fe(),a=ye(t.data),n=g(()=>a.data.value||[]),c=g(()=>n.value.map(l=>l.poolId).filter(l=>!!l)),u=g(()=>{var l;return(c==null?void 0:c.value)&&((l=c.value)==null?void 0:l.length)>0}),p=ct(dt.url.value,z.Claims.GaugePools(c),()=>({pools:{__args:{where:{id_in:c.value},first:1e3},id:!0,address:!0,poolType:!0,tokensList:!0,tokens:{address:!0,weight:!0}}}),q({enabled:u})),y=g(()=>{var l;return((l=p.data.value)==null?void 0:l.pools)||[]}),r=g(()=>y.value.length===0||Te(p)||ne.value&&Te(s));return{gauges:n,gaugePools:y,networkHasProtocolRewards:ne,protocolRewards:e,isLoading:r}}const se=K(Q.Addresses.BAL);function ta(s){return $e(s,se)}function aa(){const{getToken:s,wrappedNativeAsset:e,nativeAsset:t}=H(),a=g(()=>s(se));function n(c){return c.map(u=>$e(u,e.value.address)?t.address:u)}return{balAddress:se,balToken:a,isBalAddress:ta,replaceWethWithEth:n}}class na{constructor(e=pt,t=Q.Addresses.bbaUSDv2,a=ue.jsonProvider){this.abi=e,this.address=t,this.provider=a}getInstance(){if(!this.address)throw new Error("No bb-a-USD address");return new le(this.address,this.abi,this.provider)}async getRate(){const t=await this.getInstance().getRate();return V(t,18)}}const sa=new na,ia={class:"xl:container py-12 xl:px-4 xl:mx-auto"},ra={class:"px-4 xl:px-0 font-body text-2xl font-semibold"},oa={key:0,class:"mb-16"},la={class:"px-4 xl:px-0"},ua={class:"flex items-center mt-6 mb-2"},ca={class:"inline-block mr-1.5 text-xl"},da={key:1,class:"mb-16"},pa={class:"inline-block xl:px-0 pl-4 mt-8 mr-1.5 mb-3 text-xl"},ma={class:"inline-block px-4 xl:px-0 mt-8 mr-1.5 text-xl"},ya={class:"mb-16"},fa={class:"flex px-4 xl:px-0 mt-4"},ga={class:"mb-2 text-base"},ba={class:"px-4 xl:px-0 mb-16"},ha={class:"mt-8 font-body text-2xl font-semibold"},wa=["src","alt"],nn=E({__name:"index",setup(s){const{injectTokens:e,injectPrices:t,getToken:a}=H(),{balToken:n}=aa(),{toFiat:c,fNum:u}=P(),{isWalletReady:p}=U(),{gauges:y,gaugePools:r,networkHasProtocolRewards:l,protocolRewards:d,isLoading:m}=ea(),M=[{id:"ethereum",name:"Ethereum",key:ee.MAINNET},{id:"polygon",name:"Polygon",key:ee.POLYGON},{id:"arbitrum",name:"Arbitrum",key:ee.ARBITRUM}],C=g(()=>m.value&&p.value),R=g(()=>M.filter(o=>o.key.toString()!==B.network.key)),j=g(()=>p.value?y.value.reduce((o,w)=>{const _=V(w.claimableTokens,n.value.decimals),k=r.value.find(G=>G.id===w.poolId);return k&&S(_).gt(0)&&o.push({gauge:w,pool:k,amount:_,value:c(_,n.value.address)}),o},[]):[]),$=g(()=>ge(d.value.v2)),Y=g(()=>ge(d.value.v1)),Me=g(()=>y.value.filter(o=>o.rewardTokens.length>0)),Z=g(()=>Me.value.reduce((o,w)=>{const _=r.value.find(G=>G.id===w.poolId),k=Object.values(w.claimableRewards).reduce((G,J)=>G.plus(J),S(0));return _&&k.gt(0)&&o.push({gauge:w,pool:_}),o},[])),De=g(()=>!!B.network.addresses.balancerMinter);async function Le(o){const w=o.map(_=>_.rewardTokens).flat();return await e(w)}async function Ie(o){const w=o.map(_=>_.tokensList).flat();return await e(w)}function Ee(o){const w=ae(o.id);if(w!=null&&w.name)return w.name;const _=o.tokens.map(k=>({...k,...a(K(k.address))}));return Ae(o.poolType)?Object.values(_).map(k=>k.symbol).join(" / "):Object.values(_).map(k=>`${u(k.weight||"0",{style:"percent",maximumFractionDigits:0})} ${k.symbol}`).join(" / ")}function ge(o){return!p.value||!o?[]:Object.keys(o).map(w=>{const _=a(w),k=V(o[w],_.decimals);return{token:_,amount:k,value:c(k,w)}})}async function Ge(){if(Q.Addresses.bbaUSDv2){const o=S(await sa.getRate()).toNumber();t({[Q.Addresses.bbaUSD]:o,[Q.Addresses.bbaUSDv2]:o})}}return he(y,async o=>{o&&await Le(o)}),he(r,async o=>{o&&await Ie(o)}),Ye(async()=>{await Ge()}),(o,w)=>{const _=Xe,k=Je,G=Ze,J=He,qe=yt,Pe=ze,Fe=Oe;return v(),D("div",null,[T(tt,{title:o.$t("claimHero.title"),description:o.$t("claimHero.description")},null,8,["title","description"]),f("div",null,[f("div",ia,[f("h2",ra,h(i(B).network.chainName)+" "+h(o.$t("liquidityIncentives")),1),De.value?(v(),D("div",oa,[f("div",la,[f("div",ua,[f("h3",ca," BAL "+h(o.$t("incentives")),1),T(_,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(o.$t("claimPage.tips.BalIncentives")),1)]),_:1})])]),T(It,{rewardsData:j.value,isLoading:C.value},null,8,["rewardsData","isLoading"])])):I("",!0),i(l)?(v(),D("div",da,[f("h3",pa,h(o.$t("protocolIncentives")),1),T(_,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(o.$t("claimPage.tips.ProtocolAndVebal")),1)]),_:1}),T(Be,{rewardsData:$.value,isLoading:C.value},null,8,["rewardsData","isLoading"]),C.value?I("",!0):(v(),A(Be,{key:0,rewardsData:Y.value,isLoading:C.value,deprecated:""},null,8,["rewardsData","isLoading"]))])):I("",!0),f("div",null,[f("h3",ma,h(o.$t("otherTokenIncentives")),1),T(_,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(o.$t("claimPage.tips.OtherIncentives")),1)]),_:1})]),C.value?(v(),A(k,{key:2,class:"mt-6 mb-2 h-56"})):I("",!0),!i(m)&&Z.value.length>0?(v(!0),D(we,{key:3},ve(Z.value,({gauge:L,pool:Ve})=>(v(),D("div",{key:L.id},[f("div",ya,[f("div",fa,[f("h4",ga,h(Ee(Ve)),1)]),T(jt,{gauge:L,isLoading:i(m)},null,8,["gauge","isLoading"])])]))),128)):!i(m)&&Z.value.length===0||!i(p)?(v(),A(G,{key:4,class:"px-4 xl:px-0 mt-4 mb-16"},{default:b(()=>[F(h(o.$t("noClaimableIncentives")),1)]),_:1})):I("",!0),f("div",ba,[f("h2",ha,h(o.$t("pages.claim.titles.incentivesOnOtherNetworks")),1),T(qe,{class:"mt-4",flexWrap:""},{default:b(()=>[(v(!0),D(we,null,ve(R.value,L=>(v(),A(J,{key:L.id,tag:"a",href:`https://app.balancer.fi/#/${L.id}/claim`,color:"white"},{default:b(()=>[f("img",{src:i(mt)(L.id),alt:L.id,class:"mr-2 w-6 h-6 rounded-full shadow-sm"},null,8,wa),F(" "+h(o.$t("pages.claim.btns.claimOn"))+" "+h(L.name),1)]),_:2},1032,["href"]))),128))]),_:1}),i(p)?(v(),A(Fe,{key:0,tag:"router-link",to:"/ethereum/claim/legacy",class:"flex items-center"},{default:b(()=>[F(h(o.$t("legacyClaims"))+" ",1),T(Pe,{name:"arrow-right",size:"sm",class:"mx-1"})]),_:1})):I("",!0)])])])])}}});export{nn as default};
//# sourceMappingURL=index-bff397b4.js.map
