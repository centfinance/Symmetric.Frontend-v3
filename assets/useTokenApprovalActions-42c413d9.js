import{av as x,au as T,aq as I,bf as B,b6 as D,b5 as M}from"./BalBtn-cca6788c.js";import{a as V}from"./useTransactions-114fc9d7.js";import{T as j,Q as z,Z as E}from"./connector-16147cef.js";var i=(t=>(t[t.AddLiquidity=0]="AddLiquidity",t[t.Locking=1]="Locking",t[t.Staking=2]="Staking",t[t.Swapping=3]="Swapping",t[t.Unapprove=4]="Unapprove",t[t.Unwrapping=5]="Unwrapping",t))(i||{});function C(){const{refetchAllowances:t,approvalsRequired:v,approvalRequired:f,getToken:w,injectSpenders:k,allowanceFor:y}=x(),{t:r}=T(),{getSigner:U}=I(),{addTransaction:F}=V();function g(n,a){switch(n){case i.Locking:return r("transactionSummary.approveForLocking",[a]);case i.Staking:return r("transactionSummary.approveForStaking",[a]);case i.Swapping:return r("transactionSummary.approveForSwapping",[a]);case i.Unapprove:return r("transactionSummary.unapprove",[a]);case i.Unwrapping:return r("transactionSummary.approveForUnwrapping",[a]);default:return r("transactionSummary.approveForInvesting",[a])}}function L(n,a){switch(n){case i.Locking:return r("transactionSummary.tooltips.approveForLocking",[a]);case i.Staking:return r("transactionSummary.tooltips.approveForStaking",[a]);case i.Swapping:return r("transactionSummary.tooltips.approveForSwapping",[a]);case i.Unapprove:return r("transactionSummary.tooltips.unapprove",[a]);case i.Unwrapping:return r("transactionSummary.tooltips.approveForUnwrapping",[a]);default:return r("transactionSummary.tooltips.approveForInvesting",[a])}}async function p(n){await k([n]),await t()}async function q(n,a,e=!1){return e||await p(a),v(n,a)}async function R(n,a){return E(n.amount).eq(0)?!0:(await p(a),!f(n.address,n.amount,a))}async function m({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u=!0}){const c=u?B.toString():D(a,n.decimals).toString(),s=await new M(U()).contract.sendTransaction({contractAddress:n.address,abi:["function approve(address spender, uint256 amount) public returns (bool)"],action:"approve",params:[e,c]});return F({id:s.hash,type:"tx",action:"approve",summary:g(o,n.symbol),details:{contractAddress:n.address,spender:e}}),s}function b(n,a){var e;return!!((e=z.network.tokens.DoubleApprovalRequired)!=null&&e.includes(n.address)&&y(n.address,a).gt(0))}function S({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u=!0}){return{label:g(o,n.symbol),loadingLabel:r("investment.preview.loadingLabel.approval"),confirmingLabel:r("confirming"),stepTooltip:L(o,n.symbol),action:()=>m({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u}),postActionValidation:()=>R({address:n.address,amount:a},e),actionInvalidReason:{title:r("actionSteps.approve.invalidReason.title"),description:r("actionSteps.approve.invalidReason.description")}}}async function h({amountsToApprove:n,spender:a,actionType:e,forceMax:o=!0,skipAllowanceCheck:u=!1}){const c=await q(n,a,u);return j.flatten(c.map(d=>{const s=w(d.address),l=[];return b(s,a)&&l.push(S({token:s,normalizedAmount:"0",spender:a,actionType:i.Unapprove,forceMax:!1})),l.push(S({token:s,normalizedAmount:d.amount,spender:a,actionType:e,forceMax:o})),l}))}return{approveToken:m,getTokenApprovalActions:h,updateAllowancesFor:p}}export{i as A,C as u};
//# sourceMappingURL=useTokenApprovalActions-42c413d9.js.map
