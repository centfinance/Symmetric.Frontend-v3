import{B as Tt,_ as Ee}from"./BalAsset-fcab7531.js";import{f as ae,a6 as At,a7 as He,a8 as Ze,a9 as Bt,aa as Et,D as St,t as Pt,c as $t,ab as Ot,q as Se,n as Mt}from"./usePoolHelpers-eb955974.js";import{aS as ie,av as fe,cE as Je,aq as Pe,a_ as qe,aZ as De,aQ as Lt,aX as Vt,aW as Ct,aU as Y,au as _e,ao as Xe,aA as Rt,aw as et,bn as Wt,bl as Nt}from"./BalBtn-cca6788c.js";import{h as te,_ as Ft}from"./balancer-sdk-d0995fe4.js";import{_ as tt}from"./BalAlert-fdfde589.js";import{_ as Ut}from"./BalCheckbox-910bedd8.js";import{_ as at}from"./TokenInput.vue_vue_type_script_setup_true_lang-16ac0e09.js";import{a as Ht,c as qt}from"./validations-969b3a37.js";import{i as Dt,aa as Qe,ac as Qt,U as Ae,Z as D,a4 as jt,ae as Be,aw as Gt,B as zt,u as $e,Q as Kt}from"./connector-16147cef.js";import{a as Yt,R as Zt}from"./useRelayerApproval-b64164b6.js";import{u as Jt}from"./useTxState-3f0a759d.js";import{H as Xt,R as ea,d as je,T as Ge}from"./TokenAmounts-579fbde0.js";import{E as ta,a as G,b as Te}from"./exit-pool.service-1a7cfe3e.js";import{b as aa}from"./useGnosisSafeApp-bf4524fc.js";import{ak as oa,r as P,aj as me,u as t,ao as ge,C as Oe,ap as Me,o as ot,an as de,n as ze,d as Q,b as r,p as W,q as h,j as I,A as oe,v as E,z as e,i as Z,c as f,F as st,ah as ve,k as sa,l as L,x as na,e as la,T as ra}from"./runtime-core.esm-bundler-558f8953.js";import{_ as nt}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as lt}from"./BalTooltip.vue_vue_type_style_index_0_lang-8bf6235c.js";import{u as ia}from"./useVeBAL-5fa15e49.js";import{_ as ua}from"./BalCircle-324fa9cd.js";import{_ as ca,a as pa}from"./BalDataListRow.vue_vue_type_script_setup_true_lang-e378cd32.js";import{_ as da}from"./BalActionSteps.vue_vue_type_script_setup_true_lang-f37eca6e.js";import{_ as ma}from"./ConfirmationIndicator.vue_vue_type_script_setup_true_lang-35a245bf.js";import{a as va,i as Ke}from"./useTransactions-114fc9d7.js";import{r as Ye}from"./index-bccfb742.js";import{u as rt}from"./vue-router-461057a5.js";import{S as fa,_ as _a}from"./SwapSettingsPopover.vue_vue_type_style_index_0_lang-f08855d4.js";import{_ as ga}from"./BalTabs.vue_vue_type_style_index_0_lang-73eb95bf.js";import{u as ha}from"./pool.provider-20e73aa3.js";import{c as xa}from"./index.esm-d99d5267.js";import"./useDarkMode-6a81be08.js";import"./browser-6c45db04.js";import"./_commonjsHelpers-87174ba5.js";import"./Avatar.vue_vue_type_script_setup_true_lang-5ab9890e.js";import"./pools-18fd7fb0.js";import"./metamask.connector-0225016b.js";import"./BalTextInput-57c2e4cc.js";import"./helpers-7076a817.js";import"./tailwind.config-235e68cf.js";import"./SelectTokenModal-1ed87681.js";import"./anime.es-de4e5aa0.js";import"./numeral-77821a11.js";import"./index-18b6daea.js";import"./wallet-names-136aa5a2.js";import"./index-1de0572e.js";import"./meta.service-1c1722a9.js";import"./voting.provider-3f46e556.js";import"./index-155f0d25.js";import"./liquidity-gauge-c56bdf84.js";import"./useVotingPools-44058ee3.js";import"./useQueryHelpers-8fe10019.js";import"./BalStack.vue_vue_type_script_lang-342e535e.js";import"./wallet-logos-346092ca.js";import"./BalLink-65772d8f.js";import"./index-fe1d1633.js";import"./events-5f626723.js";import"./readable-browser-a0df197a.js";import"./immutable-2b056f5a.js";import"./BalPopover-a283b4e9.js";import"./BalBtnGroup-92655bd2.js";import"./options-322e8a89.js";import"./api-e32fdf3d.js";import"./subgraph-fallback.service-7e7c32be.js";import"./StablePhantomPool-f25cd4a4.js";import"./usePoolQuery-7e1952e9.js";import"./balancer-api.service-037872f8.js";import"./useAlerts-0e7ff1f0.js";const wa=(a,i=1e3,o=1e3)=>{const n=P(!1),s=P(!1),p=P(0),v=P(!0),x=P(!1),w=P("0"),_=P(!0),u=P(""),g=me({address:"",value:"",max:"",valid:!0}),V=P([]),N=P(!1),m=new ta(a),{toFiat:C}=ie(),{injectTokens:F,getTokens:U,balanceFor:k}=fe(),{txState:y,txInProgress:d}=Jt(),{transactionDeadline:$}=aa(),{slippageBsp:O}=Je(),{account:J,getSigner:H}=Pe(),{relayerSignature:c,relayerApprovalAction:A,relayerApprovalTx:z}=Yt(Zt.BATCH),X=je(kt,i),ee=je(bt,o,{leading:!0}),b=t(()=>n.value&&!d.value),M=t(()=>k(a.value.address)),q=qe(De.Pools.Exits.QueryExit(J,w,te,s,g,c),X,me({enabled:b,refetchOnWindowFocus:!1})),B=qe(De.Pools.Exits.SingleAssetMax(M,te,s,ge(g,"address")),ee,me({enabled:b,refetchOnWindowFocus:!1})),S=t(()=>!te.value||q.isFetching.value),ue=t(()=>{var l;return(l=q.error.value)==null?void 0:l.message}),he=t(()=>B.isFetching.value||!b.value||!te.value),ce=t(()=>{var l;return(l=B.error.value)==null?void 0:l.message}),R=t(()=>ae(a.value)),dt=t(()=>j.value===G.Generalised&&!(z.isUnlocked.value||c.value)),ne=t(()=>dt.value?[A.value]:[]),Ve=t(()=>ae(a.value)&&At(a.value.poolType)),xe=t(()=>s.value&&!Dt(a.value.tokensList,g.address)&&Ve.value),mt=t(()=>!s.value&&(ae(a.value)||He(a.value))),le=t(()=>!!Qe.ExitViaInternalBalance&&Qe.ExitViaInternalBalance.includes(a.value.id)),Ce=t(()=>Ze(a.value)||!R.value&&He(a.value)),j=t(()=>Ce.value?G.Recovery:xe.value?G.Swap:mt.value?G.Generalised:s.value?ke.value?G.ExactIn:G.ExactOut:G.ExactIn),we=t(()=>{let l=[];return l=ae(a.value)?Bt(a.value.tokens):a.value.tokensList,Qt(a.value.address,l)}),re=t(()=>U([...we.value,a.value.address,...K.value.map(l=>l.address)])),vt=t(()=>{let l=[];return l=ae(a.value)?Et(a.value):a.value.tokens,l.filter(T=>!Ae(T.address,a.value.address))}),K=t(()=>s.value?[g]:V.value),ke=t(()=>D(g.value).eq(g.max)),Re=t(()=>D(p.value).isGreaterThanOrEqualTo(Xt)),ft=t(()=>D(p.value).isGreaterThanOrEqualTo(ea)),_t=t(()=>Re.value?x.value:!0),be=t(()=>s.value&&!ke.value?Te.GivenOut:Te.GivenIn),ye=t(()=>s.value&&ke.value?M.value:w.value),We=t(()=>D(M.value).gt(0)),gt=t(()=>K.value.some(l=>D(l.value).gt(0))),ht=t(()=>D(w.value).gt(0)),Ne=t(()=>s.value?K.value.every(l=>l.valid&&D(l.value).gt(0)):_.value&&D(w.value).gt(0)),Fe=t(()=>Object.fromEntries(K.value.map(({address:l,value:T})=>[l,C(T,l)]))),xt=t(()=>jt(Object.values(Fe.value)).toString()),wt=t(()=>St(a.value,w.value));async function kt(){if(v.value=!1,!te.value||s.value&&!Ne.value||!s.value&&!ht.value)return null;m.setExitHandler(j.value),console.log("exitHandler:",j.value);try{await ze();const l=await m.queryExit({exitType:be.value,bptIn:ye.value,amountsOut:K.value,signer:H(),slippageBsp:O.value,tokenInfo:re.value,approvalActions:ne.value,bptInValid:_.value,relayerSignature:c.value,transactionDeadline:$.value,toInternalBalance:le.value});return p.value=l.priceImpact,V.value=Object.keys(l.amountsOut).map(T=>({address:T,value:l.amountsOut[T],max:"",valid:!0})),N.value=l.txReady,v.value=!0,l}catch(l){throw Ie(l,q),new Error("Failed to construct exit.",{cause:l})}}async function bt(){if(g.max="0",!te.value||!s.value||!We.value)return null;const l=xe.value?G.Swap:G.ExactIn;m.setExitHandler(l),console.log("exitHandler:",j.value);try{await ze();const T=await m.queryExit({exitType:Te.GivenIn,bptIn:M.value,amountsOut:[g],signer:H(),slippageBsp:O.value,tokenInfo:re.value,approvalActions:ne.value,bptInValid:_.value,relayerSignature:c.value,transactionDeadline:$.value,toInternalBalance:le.value}),pe=Be(T.amountsOut,g.address)||"0";return g.max=pe,pe}catch(T){throw Ie(T,B),new Error("Failed to calculate max.",{cause:T})}}async function yt(){try{return u.value="",m.setExitHandler(j.value),console.log("exitHandler:",j.value),m.exit({exitType:be.value,bptIn:ye.value,amountsOut:K.value,signer:H(),slippageBsp:O.value,tokenInfo:re.value,approvalActions:ne.value,bptInValid:_.value,relayerSignature:c.value,transactionDeadline:$.value,toInternalBalance:le.value})}catch(l){throw Ie(l),u.value=l.message,l}}function Ue(){const l=R.value?Pt(a.value.tokens):a.value.tokensList.filter(T=>!Ae(T,a.value.address));V.value=l.map(T=>({address:T,value:"0",max:"",valid:!0}))}function It(l){s.value=l}async function Ie(l,T){if(y.confirmed&&ue.value)return;const pe=await H().getAddress();Lt({error:l,action:"withdraw",query:T,context:{level:"fatal",extra:{exitHandler:j.value,params:JSON.stringify({exitType:be.value,bptIn:ye.value,amountsOut:K.value,signer:pe,slippageBsp:O.value,tokenInfo:re.value,approvalActions:ne.value,bptInValid:_.value,relayerSignature:c.value,transactionDeadline:$.value,toInternalBalance:le.value},null,2)}}})}return Oe(s,l=>{w.value="",m.setExitHandler(j.value),l||Ue()}),Me(()=>{F([...we.value,a.value.address]),m.setExitHandler(j.value),s.value||Ue()}),ot(()=>{n.value=!0}),{txState:y,singleAmountOut:g,highPriceImpactAccepted:x,bptIn:w,bptInValid:_,pool:a,isSingleAssetExit:de(s),propAmountsOut:de(V),priceImpact:de(p),priceImpactValid:de(v),exitPoolService:m,exitTokenAddresses:we,exitTokens:vt,isLoadingQuery:S,isLoadingMax:he,highPriceImpact:Re,rektPriceImpact:ft,hasAcceptedHighPriceImpact:_t,txInProgress:d,queryError:ue,maxError:ce,amountsOut:K,validAmounts:Ne,hasAmountsOut:gt,bptBalance:M,hasBpt:We,fiatTotalOut:xt,fiatValueIn:wt,fiatAmountsOut:Fe,exitTokenInfo:re,queryExitQuery:q,approvalActions:ne,transactionDeadline:$,shouldExitViaInternalBalance:le,isTxPayloadReady:N,relayerSignature:c,relayerApprovalTx:z,shouldUseSwapExit:xe,canSwapExit:Ve,shouldUseRecoveryExit:Ce,setIsSingleAssetExit:It,exit:yt}},it=Symbol(Vt.Providers.ExitPool);function ka(a){const i=wa(a);return oa(it,i),i}function se(){return Ct(it)}const ba={class:"flex justify-between items-center p-4"},ya={class:"flex items-center"},Ia={class:"flex flex-col leading-none"},Ta={class:"text-lg font-medium"},Aa={key:0},Ba={class:"flex text-sm text-gray-600 dark:text-gray-400 max-w-52"},Ea={class:"truncate"},Sa={class:"flex flex-col items-end pl-2 text-right grow font-numeric"},Pa={class:"text-xl font-medium break-words"},$a={class:"text-sm text-gray-600 dark:text-gray-400"},Oa=Q({__name:"ProportionalWithdrawalTokenInfo",props:{token:{},weight:{},address:{},fiatAmountOut:{},loading:{type:Boolean},pool:{},value:{}},setup(a){const i=a,{fNum:o}=ie(),n=t(()=>Gt(i.pool.tokens,i.address));return(s,p)=>{var w,_,u;const v=Tt,x=Ee;return r(),W("div",ba,[h("div",ya,[I(v,{address:s.address,class:"mr-2"},null,8,["address"]),h("div",Ia,[h("div",Ta,[oe(E(((w=i.token)==null?void 0:w.symbol)||((_=e(n))==null?void 0:_.symbol))+" ",1),!e($t)(s.pool.poolType)&&!e(ae)(s.pool)&&!e(Ot)(s.pool.poolType)?(r(),W("span",Aa,E(e(o)(s.weight,{style:"percent",maximumFractionDigits:0})),1)):Z("",!0)]),h("div",Ba,[h("span",Ea,E((u=i.token)==null?void 0:u.name),1)])])]),h("div",Sa,[s.loading?(r(),f(x,{key:0,class:"w-20 h-12"})):(r(),W(st,{key:1},[h("span",Pa,E(e(o)(s.value,e(Y).token)),1),h("span",$a,E(e(o)(s.fiatAmountOut||"0",e(Y).fiat)),1)],64))])])}}}),Ma={class:"label"},La={class:"label"},Va={class:"token-amounts"},Ca=Q({__name:"ProportionalWithdrawalInput",props:{pool:{}},setup(a){const i=a,o=me({val:1e3,max:1e3,min:0,interval:1}),{bptIn:n,bptInValid:s,bptBalance:p,hasBpt:v,isLoadingQuery:x,exitTokens:w,propAmountsOut:_,exitTokenInfo:u,fiatAmountsOut:g,fiatTotalOut:V}=se(),{t:N}=_e(),m=t(()=>({modelValue:o.val,max:o.max,interval:o.interval,min:o.min,tooltip:"none",disabled:!v.value}));function C(k){var d;const y=k/o.max*1e4;n.value=D(p.value).times(y).div(1e4).toFixed(((d=i.pool.onchain)==null?void 0:d.decimals)||18)}function F(k){const d=D(k).div(p.value).times(100).integerValue(zt.ROUND_CEIL).times(10).toNumber();d>o.max?o.val=o.max:d<o.min?o.val=o.min:o.val=d}function U(k){return w.value.find(y=>Ae(y.address,k))}return Me(()=>{n.value=p.value}),(k,y)=>(r(),W("div",null,[h("div",Ma,E(e(N)("youProvide")),1),I(at,{amount:e(n),"onUpdate:amount":[y[0]||(y[0]=d=>ve(n)?n.value=d:null),F],isValid:e(s),"onUpdate:isValid":y[1]||(y[1]=d=>ve(s)?s.value=d:null),address:k.pool.address,name:k.pool.address,class:"mb-4",fixedToken:"",slider:"",sliderProps:m.value,tokenValue:e(V),"onUpdate:slider":C},null,8,["amount","isValid","address","name","sliderProps","tokenValue"]),h("div",La,E(e(N)("youReceive")),1),h("div",Va,[(r(!0),W(st,null,sa(e(_),({address:d,value:$})=>{var O;return r(),f(Oa,{key:d,token:e(Be)(e(u),d),weight:((O=U(d))==null?void 0:O.weight)||"0",address:d,fiatAmountOut:e(Be)(e(g),d),loading:e(x),pool:k.pool,value:$,class:"last:mb-0"},null,8,["token","weight","address","fiatAmountOut","loading","pool","value"])}),128))])]))}});const Ra=nt(Ca,[["__scopeId","data-v-46fd109a"]]),Wa={class:"data-table"},Na={class:"p-2"},Fa={class:"data-table-number-col"},Ua={class:"flex items-center"},Ha={key:1},qa={key:2},Da=Q({__name:"WithdrawTotals",setup(a){const{fNum:i}=ie(),{priceImpact:o,priceImpactValid:n,highPriceImpact:s,isLoadingQuery:p}=se(),v=t(()=>({"bg-red-500 dark:bg-red-500 text-white divide-red-400 border-none":s.value}));return(x,w)=>{const _=Ee,u=Xe,g=lt;return r(),W("div",Wa,[h("div",{class:na(["data-table-row",e(v),"dark:bg-gray-800"])},[h("div",Na,E(x.$t("priceImpact")),1),h("div",Fa,[h("div",Ua,[e(p)?(r(),f(_,{key:0,class:"w-10 h-6"})):e(n)?(r(),W("span",qa,E(e(i)(e(o),e(Y).percent)),1)):(r(),W("span",Ha,"-")),I(g,{text:x.$t("withdraw.tooltips.priceImpact")},{activator:L(()=>[e(s)?(r(),f(u,{key:0,name:"alert-triangle",size:"xs",class:"-mb-px ml-1"})):(r(),f(u,{key:1,name:"info",size:"xs",class:"-mb-px ml-1 text-gray-400"}))]),_:1},8,["text"])])])],2)])}}});const Qa=nt(Da,[["__scopeId","data-v-b645fdaf"]]),ja=Q({__name:"WithdrawSummary",props:{pool:{},fiatTotal:{},priceImpact:{}},setup(a){const{fNum:i}=ie(),{currency:o}=Je();return(n,s)=>{const p=lt,v=ca,x=pa;return r(),f(x,{title:n.$t("summary")},{default:L(()=>[I(v,{label:n.$t("total")},{value:L(()=>[oe(E(e(i)(n.fiatTotal,e(Y).fiat))+" ",1),I(p,{text:n.$t("tooltips.withdraw.total",[e(o).toUpperCase()]),iconSize:"sm",class:"ml-2"},null,8,["text"])]),_:1},8,["label"]),I(v,{label:n.$t("priceImpact")},{value:L(()=>[oe(E(e(i)(n.priceImpact,e(Y).percent))+" ",1),I(p,{text:n.$t("tooltips.withdraw.priceImpact"),iconSize:"sm",width:"72",class:"ml-2"},null,8,["text"])]),_:1},8,["label"])]),_:1},8,["title"])}}}),Ga={key:1},za=Q({__name:"WithdrawActions",props:{pool:{}},emits:["success","error"],setup(a,{emit:i}){const o=a,{t:n}=_e(),{blockNumber:s,isMismatchedNetwork:p}=Pe(),{addTransaction:v}=va(),{poolWeightsLabel:x}=Se(ge(o,"pool")),{networkSlug:w}=$e(),{fNum:_}=ie(),{txState:u,txInProgress:g,exit:V,isLoadingQuery:N,queryExitQuery:m,fiatTotalOut:C,approvalActions:F,relayerApprovalTx:U,shouldExitViaInternalBalance:k,isTxPayloadReady:y,relayerSignature:d}=se(),$={label:n("withdraw.label"),loadingLabel:n("withdraw.preview.loadingLabel.withdraw"),confirmingLabel:n("confirming"),action:X,stepTooltip:n("withdraw.preview.tooltips.withdrawStep")},O=P([...F.value,$]),J=t(()=>k.value?n("manageVaultBalances"):n("returnToPool")),H=t(()=>k.value?n("transactionSummary.withdrawToBalance",[_(C.value,Y.fiat)]):n("transactionSummary.withdrawFromPool",[_(C.value,Y.fiat),x(o.pool)])),c=t(()=>!y.value&&(!!d.value||U.isUnlocked.value));async function A(b,M){u.confirmed=!0,u.confirming=!1,u.receipt=b,u.confirmedAt=M,i("success",b)}function z(){u.confirming=!1,i("error")}async function X(){try{const b=await V();return u.confirming=!0,v({id:b.hash,type:"tx",action:"withdraw",summary:H.value,details:{total:_(C.value,Y.fiat),pool:o.pool}}),b}catch(b){throw u.confirming=!1,new Error("Failed to submit withdrawal transaction.",{cause:b})}finally{u.init=!1}}function ee(){k.value?Ye.push({name:"balances",params:{networkSlug:w}}):Ye.push({name:"pool",params:{networkSlug:w,id:o.pool.id}})}return Oe(s,()=>{!N.value&&!g.value&&m.refetch()}),(b,M)=>{const q=da,B=et;return r(),f(Rt,null,{default:L(()=>[!e(u).confirmed||!e(u).receipt?(r(),f(q,{key:0,actions:O.value,primaryActionType:"withdraw",disabled:e(p),isLoading:e(c),loadingLabel:e(c)?b.$t("withdraw.preview.loadingLabel.building"):void 0,onSuccess:A,onFailed:z},null,8,["actions","disabled","isLoading","loadingLabel"])):(r(),W("div",Ga,[I(ma,{txReceipt:e(u).receipt},null,8,["txReceipt"]),I(B,{color:"gray",outline:"",block:"",class:"mt-2",onClick:ee},{default:L(()=>[oe(E(e(J)),1)]),_:1})]))]),_:1})}}}),Ka={class:"flex items-center"},Ya=Q({__name:"WithdrawPreviewModal",props:{pool:{}},emits:["close"],setup(a,{emit:i}){const o=a,n=P(!1),{t:s}=_e(),{getToken:p}=fe(),{networkSlug:v}=$e(),x=rt(),{bptIn:w,fiatValueIn:_,fiatTotalOut:u,amountsOut:g,priceImpact:V,fiatAmountsOut:N,isSingleAssetExit:m,shouldExitViaInternalBalance:C,hasBpt:F}=se(),U=t(()=>n.value?s("withdraw.preview.titles.confirmed"):s("withdraw.preview.titles.default")),k=t(()=>!m.value),y=t(()=>({[o.pool.address]:w.value})),d=t(()=>({[o.pool.address]:p(o.pool.address)})),$=t(()=>({[o.pool.address]:_.value})),O=t(()=>{const c={};return g.value.forEach(A=>{c[A.address]=p(A.address)}),c}),J=t(()=>{const c={};return g.value.forEach(A=>{c[A.address]=A.value}),c});function H(){F.value?i("close"):x.push({name:"pool",params:{networkSlug:v,id:o.pool.id}})}return(c,A)=>{const z=Xe,X=ua,ee=la("router-link"),b=tt,M=Ft;return r(),f(M,{show:"",fireworks:n.value,onClose:H},{header:L(()=>[h("div",Ka,[n.value?(r(),f(X,{key:0,size:"8",color:"green",class:"mr-2 text-white"},{default:L(()=>[I(z,{name:"check"})]),_:1})):Z("",!0),h("h4",null,E(U.value),1)])]),default:L(()=>[e(C)?(r(),f(b,{key:0,type:"warning",title:c.$t("alerts.withdrawToInternalBalance.title"),class:"mb-4"},{default:L(()=>[oe(E(c.$t("alerts.withdrawToInternalBalance.description"))+" ",1),I(ee,{class:"underline",to:{name:"balances",params:{networkSlug:e(v)}},target:"_blank"},{default:L(()=>[oe("Vault balances page")]),_:1},8,["to"])]),_:1},8,["title"])):Z("",!0),k.value?(r(),f(Ge,{key:1,title:c.$t("investment.preview.titles.tokenIn"),amountMap:y.value,tokenMap:d.value,fiatAmountMap:$.value,fiatTotal:e(_)},null,8,["title","amountMap","tokenMap","fiatAmountMap","fiatTotal"])):Z("",!0),I(Ge,{title:c.$t("investment.preview.titles.tokenOut"),class:"mt-4",amountMap:J.value,tokenMap:O.value,fiatAmountMap:e(N),fiatTotal:e(u)},null,8,["title","amountMap","tokenMap","fiatAmountMap","fiatTotal"]),I(ja,{pool:c.pool,fiatTotal:e(u),priceImpact:e(V)},null,8,["pool","fiatTotal","priceImpact"]),I(za,{pool:c.pool,class:"mt-4",onError:A[0]||(A[0]=q=>c.$emit("close")),onSuccess:A[1]||(A[1]=q=>n.value=!0)},null,8,["pool"])]),_:1},8,["fireworks"])}}}),Za={"data-testid":"withdraw-form"},Ja={key:2,class:"p-2 pb-2 mt-4 rounded-lg border dark:border-gray-700"},Xa={class:"mt-4"},eo=Q({__name:"WithdrawForm",props:{pool:{}},setup(a){const i=a,o=ge(i,"pool"),n=P(!1),{t:s}=_e(),{veBalTokenInfo:p}=ia(),{wrappedNativeAsset:v,nativeAsset:x}=fe(),w=rt(),{networkSlug:_}=$e(),{isWalletReady:u,startConnectWithInjectedProvider:g,isMismatchedNetwork:V}=Pe(),{isSingleAssetExit:N,singleAmountOut:m,isLoadingMax:C,queryError:F,maxError:U,isLoadingQuery:k,highPriceImpact:y,highPriceImpactAccepted:d,hasAcceptedHighPriceImpact:$,hasAmountsOut:O,validAmounts:J,hasBpt:H,shouldUseRecoveryExit:c,canSwapExit:A}=se(),{isWrappedNativeAssetPool:z}=Se(o),X=t(()=>[Ht(m.max,s("exceedsPoolBalance"))]),ee=t(()=>J.value&&$.value),b=t(()=>Mt(o.value)),M=t(()=>!c.value&&A.value?[]:z.value?[x.address,...b.value]:b.value),q=t(()=>{const B=[o.value.address];return p.value&&B.unshift(p.value.address),B});return Me(()=>{H.value||w.push({name:"pool",params:{networkSlug:_,id:i.pool.id}}),m.address=M.value.length===0?v.value.address:b.value[0]}),(B,S)=>{const ue=Ut,he=tt,ce=et;return r(),W("div",Za,[e(N)?(r(),f(at,{key:1,isValid:e(m).valid,"onUpdate:isValid":S[0]||(S[0]=R=>e(m).valid=R),address:e(m).address,"onUpdate:address":S[1]||(S[1]=R=>e(m).address=R),amount:e(m).value,"onUpdate:amount":S[2]||(S[2]=R=>e(m).value=R),name:e(m).address,rules:e(X),customBalance:e(m).max||"0",balanceLabel:B.$t("max"),balanceLoading:e(C),disableNativeAssetBuffer:"",excludedTokens:e(q),tokenSelectProps:{ignoreBalances:!0,subsetTokens:e(M)},ignoreWalletBalance:""},null,8,["isValid","address","amount","name","rules","customBalance","balanceLabel","balanceLoading","excludedTokens","tokenSelectProps"])):(r(),f(Ra,{key:0,pool:e(o)},null,8,["pool"])),I(Qa,{class:"mt-4"}),e(y)?(r(),W("div",Ja,[I(ue,{modelValue:e(d),"onUpdate:modelValue":S[3]||(S[3]=R=>ve(d)?d.value=R:null),rules:[e(qt)(B.$t("priceImpactCheckbox"))],name:"highPriceImpactAccepted",size:"sm",label:B.$t("priceImpactAccept",[B.$t("withdrawing")])},null,8,["modelValue","rules","label"])])):Z("",!0),e(F)||e(U)?(r(),f(he,{key:3,type:"error",title:B.$t("thereWasAnError"),description:e(F)||e(U),class:"mt-4",block:""},null,8,["title","description"])):Z("",!0),h("div",Xa,[e(u)?(r(),f(ce,{key:1,label:B.$t("preview"),color:"gradient",disabled:!e(O)||!e(ee)||e(V)||e(k)||e(C),block:"",onClick:S[4]||(S[4]=R=>n.value=!0)},null,8,["label","disabled"])):(r(),f(ce,{key:0,label:B.$t("connectWallet"),color:"gradient",block:"",onClick:e(g)},null,8,["label","onClick"]))]),(r(),f(ra,{to:"#modal"},[e(n)?(r(),f(Ya,{key:0,pool:e(o),onClose:S[5]||(S[5]=R=>n.value=!1)},null,8,["pool"])):Z("",!0)]))])}}});var ut=(a=>(a[a.PoolTokens=0]="PoolTokens",a[a.SingleToken=1]="SingleToken",a))(ut||{});const Le=[{value:0,label:Ke.global.t("withdraw.tabs.poolTokens")},{value:1,label:Ke.global.t("withdraw.tabs.singleToken")}],ct=P(Le[0].value);function to(){ct.value=Le[0].value}function pt(){return{activeTab:ct,resetTabs:to}}const ao=Q({__name:"WithdrawPageTabs",setup(a){const{activeTab:i}=pt(),{setIsSingleAssetExit:o}=se();return Oe(i,n=>{o(n===ut.SingleToken)}),(n,s)=>{const p=ga;return r(),f(p,{modelValue:e(i),"onUpdate:modelValue":s[0]||(s[0]=v=>ve(i)?i.value=v:null),tabs:e(Le),class:"p-0 m-0 -mb-px whitespace-nowrap",noPad:""},null,8,["modelValue","tabs"])}}}),oo={class:"w-full"},so={class:"text-xs leading-none text-secondary"},no={class:"flex justify-between items-center"},lo=Q({__name:"WithdrawPage",props:{pool:{}},setup(a){const o=ge(a,"pool");ka(o);const{network:n}=Kt,{resetTabs:s}=pt();return ot(()=>s()),(p,v)=>{const x=Wt;return r(),f(x,{shadow:"xl",exposeOverflow:"",noBorder:""},{header:L(()=>[h("div",oo,[h("div",so,E(e(n).chainName),1),h("div",no,[h("h4",null,E(p.$t("withdrawFromPool")),1),I(_a,{context:e(fa).invest},null,8,["context"])]),e(Ze)(e(o))?Z("",!0):(r(),f(ao,{key:0}))])]),default:L(()=>[I(eo,{pool:e(o)},null,8,["pool"])]),_:1})}}}),ro={class:"px-4 sm:px-0 mx-auto max-w-md"},ks=Q({__name:"withdraw",setup(a){const{pool:i,isLoadingPool:o,refetchOnchainPoolData:n}=ha(),{isDeepPool:s}=Se(i),{balanceQueryLoading:p}=fe();xa(n,Nt*20);const v=t(()=>s.value&&!te.value),x=t(()=>o.value||v.value||p.value);return(w,_)=>{const u=Ee;return r(),W("div",ro,[e(x)||!e(i)?(r(),f(u,{key:0,class:"h-96"})):(r(),f(lo,{key:1,pool:e(i)},null,8,["pool"]))])}}});export{ks as default};
//# sourceMappingURL=withdraw-2d848d85.js.map
