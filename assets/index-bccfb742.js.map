{"version":3,"file":"index-bccfb742.js","sources":["../../src/plugins/router/index.ts"],"sourcesContent":["import { createRouter, createWebHashHistory, RouteRecordRaw } from 'vue-router';\nimport { captureException } from '@sentry/browser';\n\nimport { isTestnet } from '@/composables/useNetwork';\nimport { applyNavGuards } from './nav-guards';\n\nconst ClaimPage = () => import('@/pages/claim/index.vue');\nconst LegacyClaimPage = () => import('@/pages/claim/legacy.vue');\nconst CookiesPolicyPage = () => import('@/pages/cookies-policy.vue');\nconst GetVeBalPage = () => import('@/pages/get-vebal.vue');\nconst HomePage = () => import('@/pages/index.vue');\nconst PoolPage = () =>\n  import(/* webpackPrefetch: true */ '@/pages/pool/_id.vue');\nconst CreatePoolPage = () => import('@/pages/pool/create.vue');\nconst PoolAddLiquidityPage = () => import('@/pages/pool/add-liquidity.vue');\nconst PoolWithdrawPage = () => import('@/pages/pool/withdraw.vue');\nconst PrivacyPolicyPage = () => import('@/pages/privacy-policy.vue');\nconst TermsOfUsePage = () => import('@/pages/terms-of-use.vue');\nconst RisksPage = () => import('@/pages/risks.vue');\nconst SwapPage = () => import('@/pages/swap.vue');\n\nexport const SwapPagePrefetchLinks = async () =>\n  import('@/pages/swap.vue').toString();\n\nconst UnlockVeBalPage = () => import('@/pages/unlock-vebal.vue');\nconst VeBalPage = () => import('@/pages/vebal.vue');\nconst VeBalVotingPage = () => import('@/pages/vebal-voting.vue');\nconst FaucetPage = () => import('@/pages/faucet.vue');\nconst BalancesPage = () => import('@/pages/balances.vue');\n\nconst PortfolioPage = () => import('@/pages/portfolio.vue');\nconst RecoveryExitPage = () =>\n  import('@/pages/recovery-exit/recovery-exit.vue');\n\ndeclare module 'vue-router' {\n  interface RouteMeta {\n    layout?: string;\n    bgColors?: {\n      dark: string;\n      light: string;\n    };\n  }\n}\n\nconst routes: RouteRecordRaw[] = [\n  {\n    path: '/',\n    name: 'home',\n    component: HomePage,\n  },\n  {\n    path: '/terms-of-use',\n    name: 'terms-of-use',\n    component: TermsOfUsePage,\n    meta: { layout: 'ContentLayout' },\n  },\n  {\n    path: '/privacy-policy',\n    name: 'privacy-policy',\n    component: PrivacyPolicyPage,\n    meta: { layout: 'ContentLayout' },\n  },\n  {\n    path: '/cookies-policy',\n    name: 'cookies-policy',\n    component: CookiesPolicyPage,\n    meta: { layout: 'ContentLayout' },\n  },\n  {\n    path: '/risks',\n    name: 'risks',\n    component: RisksPage,\n    meta: { layout: 'ContentLayout' },\n  },\n  {\n    path: '/:networkSlug/recovery-exit',\n    name: 'recovery-exit',\n    component: RecoveryExitPage,\n  },\n  {\n    path: '/:networkSlug/swap/:assetIn?/:assetOut?',\n    name: 'swap',\n    component: SwapPage,\n  },\n  {\n    path: '/:networkSlug/trade/:assetIn?/:assetOut?',\n    name: 'trade-redirect',\n    redirect: to => {\n      return `/${to.params.networkSlug}/swap${to.path.split('/trade')[1]}`;\n    },\n  },\n  {\n    path: '/:networkSlug/pool/create/:tx?',\n    name: 'create-pool',\n    component: CreatePoolPage,\n    meta: { layout: 'FocussedLayout' },\n  },\n  {\n    path: '/:networkSlug/pool/:id',\n    name: 'pool',\n    component: PoolPage,\n    meta: { layout: 'PoolLayout' },\n  },\n  {\n    path: '/:networkSlug/pool/:id/add-liquidity',\n    name: 'add-liquidity',\n    component: PoolAddLiquidityPage,\n    meta: { layout: 'PoolLayout' },\n  },\n  {\n    path: '/:networkSlug/pool/:id/invest',\n    name: 'invest-redirect',\n    redirect: to => {\n      return `/${to.params.networkSlug}/pool/${to.params.id}/add-liquidity`;\n    },\n  },\n  {\n    path: '/:networkSlug/pool/:id/withdraw',\n    name: 'withdraw',\n    component: PoolWithdrawPage,\n    meta: { layout: 'PoolLayout' },\n  },\n  {\n    path: '/:networkSlug/vebal',\n    name: 'vebal',\n    component: VeBalPage,\n  },\n  {\n    path: '/:networkSlug/vebal-voting',\n    name: 'vebal-voting',\n    component: VeBalVotingPage,\n    meta: { layout: 'FocussedLayout' },\n  },\n  {\n    path: '/:networkSlug/get-vebal',\n    name: 'get-vebal',\n    component: GetVeBalPage,\n    meta: { layout: 'FocussedLayout' },\n  },\n  {\n    path: '/:networkSlug/unlock',\n    name: 'unlock',\n    component: UnlockVeBalPage,\n    meta: { layout: 'FocussedLayout' },\n  },\n  {\n    path: '/:networkSlug/claim',\n    name: 'claim',\n    component: ClaimPage,\n  },\n  {\n    path: '/:networkSlug/claim/legacy',\n    name: 'legacy-claim',\n    component: LegacyClaimPage,\n  },\n  {\n    path: '/:networkSlug/portfolio',\n    name: 'portfolio',\n    component: PortfolioPage,\n  },\n  {\n    path: '/:networkSlug/balances',\n    name: 'balances',\n    component: BalancesPage,\n  },\n  {\n    path: '/:networkSlug?',\n    name: 'home',\n    component: HomePage,\n    beforeEnter: (to, from, next) => {\n      /*\n        - Correct urls:\n        These urls will contain a hash (like app.balancer.fi/# or app.balancer.fi/#/polygon).\n        The hash fragments are not included in window.location.pathname but in window.location.hash\n        so for those cases window.location.pathname === '/'\n\n        - Incorrect urls\n        These urls will not contain the hash (like app.balancer.fi/polygon/).\n        Received when the user does not add the hash symbol when manually typing the url in the browser\n        or when Vercel building a bad redirect without hash after a deployment).\n        In these cases, the window.location.pathname will contain the wrong fragment/s that we won't to discard.\n        Example: app.balancer.fi/polygon/ will have window.location.pathname === '/polygon'\n      */\n      if (window.location.pathname !== '/') {\n        // Remove wrong fragments without hash from pathname\n        window.location.pathname = '';\n      }\n      return next();\n    },\n  },\n  {\n    path: '/:pathMatch(.*)*',\n    name: 'not-found',\n    redirect: '/',\n  },\n];\n\n/**\n * TESTNET ONLY ROUTES\n */\nif (isTestnet.value) {\n  routes.push({\n    path: '/:networkSlug/faucet',\n    name: 'faucet',\n    component: FaucetPage,\n  });\n}\n\n/**\n * DEV/STAGING ONLY ROUTES\n */\n// if (\n//   ['development', 'staging'].includes(import.meta.env.VITE_ENV || 'development')\n// ) {\n//   routes.push();\n// }\n\nexport const router = createRouter({\n  history: createWebHashHistory(),\n  routes,\n  scrollBehavior(to, from, savedPosition) {\n    if (savedPosition) return savedPosition;\n    if (to.hash) {\n      // Delaying the scroll to enforce that the route transition has finished (for example, when clicking a risk hash from the pool risks section)\n      // https://router.vuejs.org/guide/advanced/scroll-behavior.html#delaying-the-scroll\n      return new Promise(resolve => {\n        setTimeout(() => {\n          if (fromPoolToRisks(from, to)) {\n            // Avoid default smooth scroll\n            return resolve({\n              el: to.hash,\n              behavior: 'instant',\n              // https://github.com/microsoft/TypeScript/issues/47441\n            } as unknown as ScrollToOptions);\n          }\n          return resolve({\n            el: to.hash,\n            behavior: 'smooth',\n          });\n        }, 300);\n      });\n    }\n    return { x: 0, top: 0 };\n  },\n});\n\nfunction fromPoolToRisks(from, to) {\n  return from.name === 'pool' && to.name === 'risks';\n}\n\nrouter.onError((error, to) => {\n  if (error.message.includes('Failed to fetch dynamically imported module')) {\n    captureException(\n      'Triggered automatic reload after failed to fetch dynamically imported module. ',\n      {\n        extra: error.message,\n      }\n    );\n    window.location.href = to.fullPath;\n  }\n});\n\nexport default applyNavGuards(router);\n"],"names":["ClaimPage","__vitePreload","LegacyClaimPage","CookiesPolicyPage","GetVeBalPage","HomePage","PoolPage","CreatePoolPage","PoolAddLiquidityPage","PoolWithdrawPage","PrivacyPolicyPage","TermsOfUsePage","RisksPage","SwapPage","UnlockVeBalPage","VeBalPage","VeBalVotingPage","FaucetPage","BalancesPage","PortfolioPage","RecoveryExitPage","routes","to","from","next","isTestnet","router","createRouter","createWebHashHistory","savedPosition","resolve","fromPoolToRisks","error","captureException","router$1","applyNavGuards"],"mappings":"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"}