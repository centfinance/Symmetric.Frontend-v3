var bm=Object.defineProperty;var wm=(n,e,r)=>e in n?bm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r;var Kl=(n,e,r)=>(wm(n,typeof e!="symbol"?e+"":e,r),r);import{f as Vl,_ as Em,u as Dm}from"./useDarkMode-6a81be08.js";import{e as lr}from"./events-5f626723.js";import{b as si,ai as Sm,aj as Im,Q as en,N as xm}from"./connector-16147cef.js";import{g as wt}from"./runtime-core.esm-bundler-558f8953.js";import{r as Cm}from"./index-ee18f997.js";import{t as zr}from"./tslib-31d961eb.js";import{c as Cr,g as Om}from"./_commonjsHelpers-87174ba5.js";import"./browser-6c45db04.js";import"./readable-browser-a0df197a.js";import"./index-fe1d1633.js";var Su={},Jo={},Le={},Ad={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,g){var w=f>>>16&65535,D=f&65535,O=g>>>16&65535,$=g&65535;return D*$+(w*$+D*O<<16>>>0)|0}n.mul=Math.imul||e;function r(f,g){return f+g|0}n.add=r;function s(f,g){return f-g|0}n.sub=s;function a(f,g){return f<<g|f>>>32-g}n.rotl=a;function h(f,g){return f<<32-g|f>>>g}n.rotr=h;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(Ad);Object.defineProperty(Le,"__esModule",{value:!0});var Nd=Ad;function Pm(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Le.readInt16BE=Pm;function Am(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Le.readUint16BE=Am;function Nm(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Le.readInt16LE=Nm;function Tm(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Le.readUint16LE=Tm;function Td(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>8,e[r+1]=n>>>0,e}Le.writeUint16BE=Td;Le.writeInt16BE=Td;function Rd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e}Le.writeUint16LE=Rd;Le.writeInt16LE=Rd;function au(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Le.readInt32BE=au;function cu(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Le.readUint32BE=cu;function uu(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Le.readInt32LE=uu;function hu(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Le.readUint32LE=hu;function Bo(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>24,e[r+1]=n>>>16,e[r+2]=n>>>8,e[r+3]=n>>>0,e}Le.writeUint32BE=Bo;Le.writeInt32BE=Bo;function Ho(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e[r+2]=n>>>16,e[r+3]=n>>>24,e}Le.writeUint32LE=Ho;Le.writeInt32LE=Ho;function Rm(n,e){e===void 0&&(e=0);var r=au(n,e),s=au(n,e+4);return r*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=Rm;function Fm(n,e){e===void 0&&(e=0);var r=cu(n,e),s=cu(n,e+4);return r*4294967296+s}Le.readUint64BE=Fm;function Um(n,e){e===void 0&&(e=0);var r=uu(n,e),s=uu(n,e+4);return s*4294967296+r-(r>>31)*4294967296}Le.readInt64LE=Um;function Lm(n,e){e===void 0&&(e=0);var r=hu(n,e),s=hu(n,e+4);return s*4294967296+r}Le.readUint64LE=Lm;function Fd(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Bo(n/4294967296>>>0,e,r),Bo(n>>>0,e,r+4),e}Le.writeUint64BE=Fd;Le.writeInt64BE=Fd;function Ud(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ho(n>>>0,e,r),Ho(n/4294967296>>>0,e,r+4),e}Le.writeUint64LE=Ud;Le.writeInt64LE=Ud;function $m(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,h=n/8+r-1;h>=r;h--)s+=e[h]*a,a*=256;return s}Le.readUintBE=$m;function Mm(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,h=r;h<r+n/8;h++)s+=e[h]*a,a*=256;return s}Le.readUintLE=Mm;function jm(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Nd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var a=1,h=n/8+s-1;h>=s;h--)r[h]=e/a&255,a*=256;return r}Le.writeUintBE=jm;function qm(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Nd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var a=1,h=s;h<s+n/8;h++)r[h]=e/a&255,a*=256;return r}Le.writeUintLE=qm;function zm(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e)}Le.readFloat32BE=zm;function Bm(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e,!0)}Le.readFloat32LE=Bm;function Hm(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e)}Le.readFloat64BE=Hm;function km(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e,!0)}Le.readFloat64LE=km;function Km(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n),e}Le.writeFloat32BE=Km;function Vm(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n,!0),e}Le.writeFloat32LE=Vm;function Wm(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n),e}Le.writeFloat64BE=Wm;function Gm(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n,!0),e}Le.writeFloat64LE=Gm;var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});function Ym(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Pr.wipe=Ym;Object.defineProperty(Jo,"__esModule",{value:!0});var Zt=Le,lu=Pr,Jm=20;function Qm(n,e,r){for(var s=1634760805,a=857760878,h=2036477234,p=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],g=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],D=r[15]<<24|r[14]<<16|r[13]<<8|r[12],O=r[19]<<24|r[18]<<16|r[17]<<8|r[16],$=r[23]<<24|r[22]<<16|r[21]<<8|r[20],A=r[27]<<24|r[26]<<16|r[25]<<8|r[24],M=r[31]<<24|r[30]<<16|r[29]<<8|r[28],H=e[3]<<24|e[2]<<16|e[1]<<8|e[0],k=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],P=e[15]<<24|e[14]<<16|e[13]<<8|e[12],U=s,S=a,x=h,m=p,c=f,_=g,K=w,W=D,oe=O,ce=$,ge=A,T=M,z=H,le=k,te=ie,G=P,ee=0;ee<Jm;ee+=2)U=U+c|0,z^=U,z=z>>>32-16|z<<16,oe=oe+z|0,c^=oe,c=c>>>32-12|c<<12,S=S+_|0,le^=S,le=le>>>32-16|le<<16,ce=ce+le|0,_^=ce,_=_>>>32-12|_<<12,x=x+K|0,te^=x,te=te>>>32-16|te<<16,ge=ge+te|0,K^=ge,K=K>>>32-12|K<<12,m=m+W|0,G^=m,G=G>>>32-16|G<<16,T=T+G|0,W^=T,W=W>>>32-12|W<<12,x=x+K|0,te^=x,te=te>>>32-8|te<<8,ge=ge+te|0,K^=ge,K=K>>>32-7|K<<7,m=m+W|0,G^=m,G=G>>>32-8|G<<8,T=T+G|0,W^=T,W=W>>>32-7|W<<7,S=S+_|0,le^=S,le=le>>>32-8|le<<8,ce=ce+le|0,_^=ce,_=_>>>32-7|_<<7,U=U+c|0,z^=U,z=z>>>32-8|z<<8,oe=oe+z|0,c^=oe,c=c>>>32-7|c<<7,U=U+_|0,G^=U,G=G>>>32-16|G<<16,ge=ge+G|0,_^=ge,_=_>>>32-12|_<<12,S=S+K|0,z^=S,z=z>>>32-16|z<<16,T=T+z|0,K^=T,K=K>>>32-12|K<<12,x=x+W|0,le^=x,le=le>>>32-16|le<<16,oe=oe+le|0,W^=oe,W=W>>>32-12|W<<12,m=m+c|0,te^=m,te=te>>>32-16|te<<16,ce=ce+te|0,c^=ce,c=c>>>32-12|c<<12,x=x+W|0,le^=x,le=le>>>32-8|le<<8,oe=oe+le|0,W^=oe,W=W>>>32-7|W<<7,m=m+c|0,te^=m,te=te>>>32-8|te<<8,ce=ce+te|0,c^=ce,c=c>>>32-7|c<<7,S=S+K|0,z^=S,z=z>>>32-8|z<<8,T=T+z|0,K^=T,K=K>>>32-7|K<<7,U=U+_|0,G^=U,G=G>>>32-8|G<<8,ge=ge+G|0,_^=ge,_=_>>>32-7|_<<7;Zt.writeUint32LE(U+s|0,n,0),Zt.writeUint32LE(S+a|0,n,4),Zt.writeUint32LE(x+h|0,n,8),Zt.writeUint32LE(m+p|0,n,12),Zt.writeUint32LE(c+f|0,n,16),Zt.writeUint32LE(_+g|0,n,20),Zt.writeUint32LE(K+w|0,n,24),Zt.writeUint32LE(W+D|0,n,28),Zt.writeUint32LE(oe+O|0,n,32),Zt.writeUint32LE(ce+$|0,n,36),Zt.writeUint32LE(ge+A|0,n,40),Zt.writeUint32LE(T+M|0,n,44),Zt.writeUint32LE(z+H|0,n,48),Zt.writeUint32LE(le+k|0,n,52),Zt.writeUint32LE(te+ie|0,n,56),Zt.writeUint32LE(G+P|0,n,60)}function Ld(n,e,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var h,p;if(a===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");h=new Uint8Array(16),p=h.length-e.length,h.set(e,p)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");h=e,p=a}for(var f=new Uint8Array(64),g=0;g<r.length;g+=64){Qm(f,h,n);for(var w=g;w<g+64&&w<r.length;w++)s[w]=r[w]^f[w-g];Zm(h,0,p)}return lu.wipe(f),a===0&&lu.wipe(h),s}Jo.streamXOR=Ld;function Xm(n,e,r,s){return s===void 0&&(s=0),lu.wipe(r),Ld(n,e,r,r,s)}Jo.stream=Xm;function Zm(n,e,r){for(var s=1;r--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var $d={},$i={};Object.defineProperty($i,"__esModule",{value:!0});function eb(n,e,r){return~(n-1)&e|n-1&r}$i.select=eb;function tb(n,e){return(n|0)-(e|0)-1>>>31&1}$i.lessOrEqual=tb;function Md(n,e){if(n.length!==e.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^e[s];return 1&r-1>>>8}$i.compare=Md;function rb(n,e){return n.length===0||e.length===0?!1:Md(n,e)!==0}$i.equal=rb;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=$i,r=Pr;n.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var w=f[2]|f[3]<<8;this._r[1]=(g>>>13|w<<3)&8191;var D=f[4]|f[5]<<8;this._r[2]=(w>>>10|D<<6)&7939;var O=f[6]|f[7]<<8;this._r[3]=(D>>>7|O<<9)&8191;var $=f[8]|f[9]<<8;this._r[4]=(O>>>4|$<<12)&255,this._r[5]=$>>>1&8190;var A=f[10]|f[11]<<8;this._r[6]=($>>>14|A<<2)&8191;var M=f[12]|f[13]<<8;this._r[7]=(A>>>11|M<<5)&8065;var H=f[14]|f[15]<<8;this._r[8]=(M>>>8|H<<8)&8191,this._r[9]=H>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,g,w){for(var D=this._fin?0:2048,O=this._h[0],$=this._h[1],A=this._h[2],M=this._h[3],H=this._h[4],k=this._h[5],ie=this._h[6],P=this._h[7],U=this._h[8],S=this._h[9],x=this._r[0],m=this._r[1],c=this._r[2],_=this._r[3],K=this._r[4],W=this._r[5],oe=this._r[6],ce=this._r[7],ge=this._r[8],T=this._r[9];w>=16;){var z=f[g+0]|f[g+1]<<8;O+=z&8191;var le=f[g+2]|f[g+3]<<8;$+=(z>>>13|le<<3)&8191;var te=f[g+4]|f[g+5]<<8;A+=(le>>>10|te<<6)&8191;var G=f[g+6]|f[g+7]<<8;M+=(te>>>7|G<<9)&8191;var ee=f[g+8]|f[g+9]<<8;H+=(G>>>4|ee<<12)&8191,k+=ee>>>1&8191;var Y=f[g+10]|f[g+11]<<8;ie+=(ee>>>14|Y<<2)&8191;var re=f[g+12]|f[g+13]<<8;P+=(Y>>>11|re<<5)&8191;var xe=f[g+14]|f[g+15]<<8;U+=(re>>>8|xe<<8)&8191,S+=xe>>>5|D;var ne=0,be=ne;be+=O*x,be+=$*(5*T),be+=A*(5*ge),be+=M*(5*ce),be+=H*(5*oe),ne=be>>>13,be&=8191,be+=k*(5*W),be+=ie*(5*K),be+=P*(5*_),be+=U*(5*c),be+=S*(5*m),ne+=be>>>13,be&=8191;var he=ne;he+=O*m,he+=$*x,he+=A*(5*T),he+=M*(5*ge),he+=H*(5*ce),ne=he>>>13,he&=8191,he+=k*(5*oe),he+=ie*(5*W),he+=P*(5*K),he+=U*(5*_),he+=S*(5*c),ne+=he>>>13,he&=8191;var _e=ne;_e+=O*c,_e+=$*m,_e+=A*x,_e+=M*(5*T),_e+=H*(5*ge),ne=_e>>>13,_e&=8191,_e+=k*(5*ce),_e+=ie*(5*oe),_e+=P*(5*W),_e+=U*(5*K),_e+=S*(5*_),ne+=_e>>>13,_e&=8191;var q=ne;q+=O*_,q+=$*c,q+=A*m,q+=M*x,q+=H*(5*T),ne=q>>>13,q&=8191,q+=k*(5*ge),q+=ie*(5*ce),q+=P*(5*oe),q+=U*(5*W),q+=S*(5*K),ne+=q>>>13,q&=8191;var j=ne;j+=O*K,j+=$*_,j+=A*c,j+=M*m,j+=H*x,ne=j>>>13,j&=8191,j+=k*(5*T),j+=ie*(5*ge),j+=P*(5*ce),j+=U*(5*oe),j+=S*(5*W),ne+=j>>>13,j&=8191;var N=ne;N+=O*W,N+=$*K,N+=A*_,N+=M*c,N+=H*m,ne=N>>>13,N&=8191,N+=k*x,N+=ie*(5*T),N+=P*(5*ge),N+=U*(5*ce),N+=S*(5*oe),ne+=N>>>13,N&=8191;var l=ne;l+=O*oe,l+=$*W,l+=A*K,l+=M*_,l+=H*c,ne=l>>>13,l&=8191,l+=k*m,l+=ie*x,l+=P*(5*T),l+=U*(5*ge),l+=S*(5*ce),ne+=l>>>13,l&=8191;var I=ne;I+=O*ce,I+=$*oe,I+=A*W,I+=M*K,I+=H*_,ne=I>>>13,I&=8191,I+=k*c,I+=ie*m,I+=P*x,I+=U*(5*T),I+=S*(5*ge),ne+=I>>>13,I&=8191;var se=ne;se+=O*ge,se+=$*ce,se+=A*oe,se+=M*W,se+=H*K,ne=se>>>13,se&=8191,se+=k*_,se+=ie*c,se+=P*m,se+=U*x,se+=S*(5*T),ne+=se>>>13,se&=8191;var fe=ne;fe+=O*T,fe+=$*ge,fe+=A*ce,fe+=M*oe,fe+=H*W,ne=fe>>>13,fe&=8191,fe+=k*K,fe+=ie*_,fe+=P*c,fe+=U*m,fe+=S*x,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+be|0,be=ne&8191,ne=ne>>>13,he+=ne,O=be,$=he,A=_e,M=q,H=j,k=N,ie=l,P=I,U=se,S=fe,g+=16,w-=16}this._h[0]=O,this._h[1]=$,this._h[2]=A,this._h[3]=M,this._h[4]=H,this._h[5]=k,this._h[6]=ie,this._h[7]=P,this._h[8]=U,this._h[9]=S},p.prototype.finish=function(f,g){g===void 0&&(g=0);var w=new Uint16Array(10),D,O,$,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(D=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=D,D=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=D*5,D=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=D,D=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=D,w[0]=this._h[0]+5,D=w[0]>>>13,w[0]&=8191,A=1;A<10;A++)w[A]=this._h[A]+D,D=w[A]>>>13,w[A]&=8191;for(w[9]-=1<<13,O=(D^1)-1,A=0;A<10;A++)w[A]&=O;for(O=~O,A=0;A<10;A++)this._h[A]=this._h[A]&O|w[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,$=this._h[0]+this._pad[0],this._h[0]=$&65535,A=1;A<8;A++)$=(this._h[A]+this._pad[A]|0)+($>>>16)|0,this._h[A]=$&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var g=0,w=f.length,D;if(this._leftover){D=16-this._leftover,D>w&&(D=w);for(var O=0;O<D;O++)this._buffer[this._leftover+O]=f[g+O];if(w-=D,g+=D,this._leftover+=D,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(D=w-w%16,this._blocks(f,g,D),g+=D,w-=D),w){for(var O=0;O<w;O++)this._buffer[this._leftover+O]=f[g+O];this._leftover+=w}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,f){var g=new s(p);g.update(f);var w=g.digest();return g.clean(),w}n.oneTimeAuth=a;function h(p,f){return p.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(p,f)}n.equal=h})($d);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Jo,r=$d,s=Pr,a=Le,h=$i;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function g(w){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,w.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return g.prototype.seal=function(w,D,O,$){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(w,A.length-w.length);var M=new Uint8Array(32);e.stream(this._key,A,M,4);var H=D.length+this.tagLength,k;if($){if($.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");k=$}else k=new Uint8Array(H);return e.streamXOR(this._key,A,D,k,4),this._authenticate(k.subarray(k.length-this.tagLength,k.length),M,k.subarray(0,k.length-this.tagLength),O),s.wipe(A),k},g.prototype.open=function(w,D,O,$){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(D.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(w,A.length-w.length);var M=new Uint8Array(32);e.stream(this._key,A,M,4);var H=new Uint8Array(this.tagLength);if(this._authenticate(H,M,D.subarray(0,D.length-this.tagLength),O),!h.equal(H,D.subarray(D.length-this.tagLength,D.length)))return null;var k=D.length-this.tagLength,ie;if($){if($.length!==k)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=$}else ie=new Uint8Array(k);return e.streamXOR(this._key,A,D.subarray(0,D.length-this.tagLength),ie,4),s.wipe(A),ie},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(w,D,O,$){var A=new r.Poly1305(D);$&&(A.update($),$.length%16>0&&A.update(p.subarray($.length%16))),A.update(O),O.length%16>0&&A.update(p.subarray(O.length%16));var M=new Uint8Array(8);$&&a.writeUint64LE($.length,M),A.update(M),a.writeUint64LE(O.length,M),A.update(M);for(var H=A.digest(),k=0;k<H.length;k++)w[k]=H[k];A.clean(),s.wipe(H),s.wipe(M)},g}();n.ChaCha20Poly1305=f})(Su);var jd={},Ds={},Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});function ib(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Iu.isSerializableHash=ib;Object.defineProperty(Ds,"__esModule",{value:!0});var ri=Iu,nb=$i,sb=Pr,qd=function(){function n(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),ri.isSerializableHash(this._inner)&&ri.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),sb.wipe(s)}return n.prototype.reset=function(){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){ri.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ri.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();Ds.HMAC=qd;function ob(n,e,r){var s=new qd(n,e);s.update(r);var a=s.digest();return s.clean(),a}Ds.hmac=ob;Ds.equal=nb.equal;Object.defineProperty(jd,"__esModule",{value:!0});var Wl=Ds,Gl=Pr,ab=function(){function n(e,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=a;var h=Wl.hmac(this._hash,s,r);this._hmac=new Wl.HMAC(e,h),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var r=new Uint8Array(e),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Gl.wipe(this._buffer),Gl.wipe(this._counter),this._bufpos=0},n}(),cb=jd.HKDF=ab,Ln={},Qo={},Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});Xo.BrowserRandomSource=void 0;const Yl=65536;class ub{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let s=0;s<r.length;s+=Yl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Yl)));return r}}Xo.BrowserRandomSource=ub;function hb(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});Zo.NodeRandomSource=void 0;const lb=Pr;class fb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof hb<"u"){const e=Cm();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,lb.wipe)(r),s}}Zo.NodeRandomSource=fb;Object.defineProperty(Qo,"__esModule",{value:!0});Qo.SystemRandomSource=void 0;const db=Xo,pb=Zo;class gb{constructor(){if(this.isAvailable=!1,this.name="",this._source=new db.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new pb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Qo.SystemRandomSource=gb;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Qo,r=Le,s=Pr;n.defaultRandomSource=new e.SystemRandomSource;function a(w,D=n.defaultRandomSource){return D.randomBytes(w)}n.randomBytes=a;function h(w=n.defaultRandomSource){const D=a(4,w),O=(0,r.readUint32LE)(D);return(0,s.wipe)(D),O}n.randomUint32=h;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(w,D=p,O=n.defaultRandomSource){if(D.length<2)throw new Error("randomString charset is too short");if(D.length>256)throw new Error("randomString charset is too long");let $="";const A=D.length,M=256-256%A;for(;w>0;){const H=a(Math.ceil(w*256/M),O);for(let k=0;k<H.length&&w>0;k++){const ie=H[k];ie<M&&($+=D.charAt(ie%A),w--)}(0,s.wipe)(H)}return $}n.randomString=f;function g(w,D=p,O=n.defaultRandomSource){const $=Math.ceil(w/(Math.log(D.length)/Math.LN2));return f($,D,O)}n.randomStringForEntropy=g})(Ln);var ea={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Le,r=Pr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var D=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=g[D++],w--;this._bufferLength===this.blockSize&&(h(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(D=h(this._temp,this._state,g,D,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[D++],w--;return this},f.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,D=this._bufferLength,O=w/536870912|0,$=w<<3,A=w%64<56?64:128;this._buffer[D]=128;for(var M=D+1;M<A-8;M++)this._buffer[M]=0;e.writeUint32BE(O,this._buffer,A-8),e.writeUint32BE($,this._buffer,A-4),h(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)e.writeUint32BE(this._state[M],g,M*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.state),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function h(f,g,w,D,O){for(;O>=64;){for(var $=g[0],A=g[1],M=g[2],H=g[3],k=g[4],ie=g[5],P=g[6],U=g[7],S=0;S<16;S++){var x=D+S*4;f[S]=e.readUint32BE(w,x)}for(var S=16;S<64;S++){var m=f[S-2],c=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=f[S-15];var _=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;f[S]=(c+f[S-7]|0)+(_+f[S-16]|0)}for(var S=0;S<64;S++){var c=(((k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7))+(k&ie^~k&P)|0)+(U+(a[S]+f[S]|0)|0)|0,_=(($>>>2|$<<32-2)^($>>>13|$<<32-13)^($>>>22|$<<32-22))+($&A^$&M^A&M)|0;U=P,P=ie,ie=k,k=H+c|0,H=M,M=A,A=$,$=c+_|0}g[0]+=$,g[1]+=A,g[2]+=M,g[3]+=H,g[4]+=k,g[5]+=ie,g[6]+=P,g[7]+=U,D+=64,O-=64}return D}function p(f){var g=new s;g.update(f);var w=g.digest();return g.clean(),w}n.hash=p})(ea);var xu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=Ln,r=Pr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(S){const x=new Float64Array(16);if(S)for(let m=0;m<S.length;m++)x[m]=S[m];return x}const a=new Uint8Array(32);a[0]=9;const h=s([56129,1]);function p(S){let x=1;for(let m=0;m<16;m++){let c=S[m]+x+65535;x=Math.floor(c/65536),S[m]=c-x*65536}S[0]+=x-1+37*(x-1)}function f(S,x,m){const c=~(m-1);for(let _=0;_<16;_++){const K=c&(S[_]^x[_]);S[_]^=K,x[_]^=K}}function g(S,x){const m=s(),c=s();for(let _=0;_<16;_++)c[_]=x[_];p(c),p(c),p(c);for(let _=0;_<2;_++){m[0]=c[0]-65517;for(let W=1;W<15;W++)m[W]=c[W]-65535-(m[W-1]>>16&1),m[W-1]&=65535;m[15]=c[15]-32767-(m[14]>>16&1);const K=m[15]>>16&1;m[14]&=65535,f(c,m,1-K)}for(let _=0;_<16;_++)S[2*_]=c[_]&255,S[2*_+1]=c[_]>>8}function w(S,x){for(let m=0;m<16;m++)S[m]=x[2*m]+(x[2*m+1]<<8);S[15]&=32767}function D(S,x,m){for(let c=0;c<16;c++)S[c]=x[c]+m[c]}function O(S,x,m){for(let c=0;c<16;c++)S[c]=x[c]-m[c]}function $(S,x,m){let c,_,K=0,W=0,oe=0,ce=0,ge=0,T=0,z=0,le=0,te=0,G=0,ee=0,Y=0,re=0,xe=0,ne=0,be=0,he=0,_e=0,q=0,j=0,N=0,l=0,I=0,se=0,fe=0,Se=0,Be=0,Ke=0,$e=0,pt=0,gt=0,je=m[0],Ie=m[1],Re=m[2],Fe=m[3],qe=m[4],Oe=m[5],Ue=m[6],De=m[7],Pe=m[8],He=m[9],Ce=m[10],Ve=m[11],Ge=m[12],et=m[13],tt=m[14],Je=m[15];c=x[0],K+=c*je,W+=c*Ie,oe+=c*Re,ce+=c*Fe,ge+=c*qe,T+=c*Oe,z+=c*Ue,le+=c*De,te+=c*Pe,G+=c*He,ee+=c*Ce,Y+=c*Ve,re+=c*Ge,xe+=c*et,ne+=c*tt,be+=c*Je,c=x[1],W+=c*je,oe+=c*Ie,ce+=c*Re,ge+=c*Fe,T+=c*qe,z+=c*Oe,le+=c*Ue,te+=c*De,G+=c*Pe,ee+=c*He,Y+=c*Ce,re+=c*Ve,xe+=c*Ge,ne+=c*et,be+=c*tt,he+=c*Je,c=x[2],oe+=c*je,ce+=c*Ie,ge+=c*Re,T+=c*Fe,z+=c*qe,le+=c*Oe,te+=c*Ue,G+=c*De,ee+=c*Pe,Y+=c*He,re+=c*Ce,xe+=c*Ve,ne+=c*Ge,be+=c*et,he+=c*tt,_e+=c*Je,c=x[3],ce+=c*je,ge+=c*Ie,T+=c*Re,z+=c*Fe,le+=c*qe,te+=c*Oe,G+=c*Ue,ee+=c*De,Y+=c*Pe,re+=c*He,xe+=c*Ce,ne+=c*Ve,be+=c*Ge,he+=c*et,_e+=c*tt,q+=c*Je,c=x[4],ge+=c*je,T+=c*Ie,z+=c*Re,le+=c*Fe,te+=c*qe,G+=c*Oe,ee+=c*Ue,Y+=c*De,re+=c*Pe,xe+=c*He,ne+=c*Ce,be+=c*Ve,he+=c*Ge,_e+=c*et,q+=c*tt,j+=c*Je,c=x[5],T+=c*je,z+=c*Ie,le+=c*Re,te+=c*Fe,G+=c*qe,ee+=c*Oe,Y+=c*Ue,re+=c*De,xe+=c*Pe,ne+=c*He,be+=c*Ce,he+=c*Ve,_e+=c*Ge,q+=c*et,j+=c*tt,N+=c*Je,c=x[6],z+=c*je,le+=c*Ie,te+=c*Re,G+=c*Fe,ee+=c*qe,Y+=c*Oe,re+=c*Ue,xe+=c*De,ne+=c*Pe,be+=c*He,he+=c*Ce,_e+=c*Ve,q+=c*Ge,j+=c*et,N+=c*tt,l+=c*Je,c=x[7],le+=c*je,te+=c*Ie,G+=c*Re,ee+=c*Fe,Y+=c*qe,re+=c*Oe,xe+=c*Ue,ne+=c*De,be+=c*Pe,he+=c*He,_e+=c*Ce,q+=c*Ve,j+=c*Ge,N+=c*et,l+=c*tt,I+=c*Je,c=x[8],te+=c*je,G+=c*Ie,ee+=c*Re,Y+=c*Fe,re+=c*qe,xe+=c*Oe,ne+=c*Ue,be+=c*De,he+=c*Pe,_e+=c*He,q+=c*Ce,j+=c*Ve,N+=c*Ge,l+=c*et,I+=c*tt,se+=c*Je,c=x[9],G+=c*je,ee+=c*Ie,Y+=c*Re,re+=c*Fe,xe+=c*qe,ne+=c*Oe,be+=c*Ue,he+=c*De,_e+=c*Pe,q+=c*He,j+=c*Ce,N+=c*Ve,l+=c*Ge,I+=c*et,se+=c*tt,fe+=c*Je,c=x[10],ee+=c*je,Y+=c*Ie,re+=c*Re,xe+=c*Fe,ne+=c*qe,be+=c*Oe,he+=c*Ue,_e+=c*De,q+=c*Pe,j+=c*He,N+=c*Ce,l+=c*Ve,I+=c*Ge,se+=c*et,fe+=c*tt,Se+=c*Je,c=x[11],Y+=c*je,re+=c*Ie,xe+=c*Re,ne+=c*Fe,be+=c*qe,he+=c*Oe,_e+=c*Ue,q+=c*De,j+=c*Pe,N+=c*He,l+=c*Ce,I+=c*Ve,se+=c*Ge,fe+=c*et,Se+=c*tt,Be+=c*Je,c=x[12],re+=c*je,xe+=c*Ie,ne+=c*Re,be+=c*Fe,he+=c*qe,_e+=c*Oe,q+=c*Ue,j+=c*De,N+=c*Pe,l+=c*He,I+=c*Ce,se+=c*Ve,fe+=c*Ge,Se+=c*et,Be+=c*tt,Ke+=c*Je,c=x[13],xe+=c*je,ne+=c*Ie,be+=c*Re,he+=c*Fe,_e+=c*qe,q+=c*Oe,j+=c*Ue,N+=c*De,l+=c*Pe,I+=c*He,se+=c*Ce,fe+=c*Ve,Se+=c*Ge,Be+=c*et,Ke+=c*tt,$e+=c*Je,c=x[14],ne+=c*je,be+=c*Ie,he+=c*Re,_e+=c*Fe,q+=c*qe,j+=c*Oe,N+=c*Ue,l+=c*De,I+=c*Pe,se+=c*He,fe+=c*Ce,Se+=c*Ve,Be+=c*Ge,Ke+=c*et,$e+=c*tt,pt+=c*Je,c=x[15],be+=c*je,he+=c*Ie,_e+=c*Re,q+=c*Fe,j+=c*qe,N+=c*Oe,l+=c*Ue,I+=c*De,se+=c*Pe,fe+=c*He,Se+=c*Ce,Be+=c*Ve,Ke+=c*Ge,$e+=c*et,pt+=c*tt,gt+=c*Je,K+=38*he,W+=38*_e,oe+=38*q,ce+=38*j,ge+=38*N,T+=38*l,z+=38*I,le+=38*se,te+=38*fe,G+=38*Se,ee+=38*Be,Y+=38*Ke,re+=38*$e,xe+=38*pt,ne+=38*gt,_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=T+_+65535,_=Math.floor(c/65536),T=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=Y+_+65535,_=Math.floor(c/65536),Y=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,K+=_-1+37*(_-1),_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=T+_+65535,_=Math.floor(c/65536),T=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=Y+_+65535,_=Math.floor(c/65536),Y=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,K+=_-1+37*(_-1),S[0]=K,S[1]=W,S[2]=oe,S[3]=ce,S[4]=ge,S[5]=T,S[6]=z,S[7]=le,S[8]=te,S[9]=G,S[10]=ee,S[11]=Y,S[12]=re,S[13]=xe,S[14]=ne,S[15]=be}function A(S,x){$(S,x,x)}function M(S,x){const m=s();for(let c=0;c<16;c++)m[c]=x[c];for(let c=253;c>=0;c--)A(m,m),c!==2&&c!==4&&$(m,m,x);for(let c=0;c<16;c++)S[c]=m[c]}function H(S,x){const m=new Uint8Array(32),c=new Float64Array(80),_=s(),K=s(),W=s(),oe=s(),ce=s(),ge=s();for(let te=0;te<31;te++)m[te]=S[te];m[31]=S[31]&127|64,m[0]&=248,w(c,x);for(let te=0;te<16;te++)K[te]=c[te];_[0]=oe[0]=1;for(let te=254;te>=0;--te){const G=m[te>>>3]>>>(te&7)&1;f(_,K,G),f(W,oe,G),D(ce,_,W),O(_,_,W),D(W,K,oe),O(K,K,oe),A(oe,ce),A(ge,_),$(_,W,_),$(W,K,ce),D(ce,_,W),O(_,_,W),A(K,_),O(W,oe,ge),$(_,W,h),D(_,_,oe),$(W,W,_),$(_,oe,ge),$(oe,K,c),A(K,ce),f(_,K,G),f(W,oe,G)}for(let te=0;te<16;te++)c[te+16]=_[te],c[te+32]=W[te],c[te+48]=K[te],c[te+64]=oe[te];const T=c.subarray(32),z=c.subarray(16);M(T,T),$(z,z,T);const le=new Uint8Array(32);return g(le,z),le}n.scalarMult=H;function k(S){return H(S,a)}n.scalarMultBase=k;function ie(S){if(S.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(S);return{publicKey:k(x),secretKey:x}}n.generateKeyPairFromSeed=ie;function P(S){const x=(0,e.randomBytes)(32,S),m=ie(x);return(0,r.wipe)(x),m}n.generateKeyPair=P;function U(S,x,m=!1){if(S.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=H(S,x);if(m){let _=0;for(let K=0;K<c.length;K++)_|=c[K];if(_===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=U})(xu);function Cu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function zd(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Cu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function fu(n,e){e||(e=n.reduce((a,h)=>a+h.length,0));const r=zd(e);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Cu(r)}function vb(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var h=n.charAt(a),p=h.charCodeAt(0);if(r[p]!==255)throw new TypeError(h+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),w=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function O(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var H=0,k=0,ie=0,P=M.length;ie!==P&&M[ie]===0;)ie++,H++;for(var U=(P-ie)*D+1>>>0,S=new Uint8Array(U);ie!==P;){for(var x=M[ie],m=0,c=U-1;(x!==0||m<k)&&c!==-1;c--,m++)x+=256*S[c]>>>0,S[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");k=m,ie++}for(var _=U-k;_!==U&&S[_]===0;)_++;for(var K=g.repeat(H);_<U;++_)K+=n.charAt(S[_]);return K}function $(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var H=0;if(M[H]!==" "){for(var k=0,ie=0;M[H]===g;)k++,H++;for(var P=(M.length-H)*w+1>>>0,U=new Uint8Array(P);M[H];){var S=r[M.charCodeAt(H)];if(S===255)return;for(var x=0,m=P-1;(S!==0||x<ie)&&m!==-1;m--,x++)S+=f*U[m]>>>0,U[m]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");ie=x,H++}if(M[H]!==" "){for(var c=P-ie;c!==P&&U[c]===0;)c++;for(var _=new Uint8Array(k+(P-c)),K=k;c!==P;)_[K++]=U[c++];return _}}}function A(M){var H=$(M);if(H)return H;throw new Error(`Non-${e} character`)}return{encode:O,decodeUnsafe:$,decode:A}}var yb=vb,_b=yb;const mb=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},bb=n=>new TextEncoder().encode(n),wb=n=>new TextDecoder().decode(n);class Eb{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Db{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bd(this,e)}}class Sb{constructor(e){this.decoders=e}or(e){return Bd(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Bd=(n,e)=>new Sb({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class Ib{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new Eb(e,r,s),this.decoder=new Db(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ta=({name:n,prefix:e,encode:r,decode:s})=>new Ib(n,e,r,s),Ss=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:a}=_b(r,e);return ta({prefix:n,name:e,encode:s,decode:h=>mb(a(h))})},xb=(n,e,r,s)=>{const a={};for(let D=0;D<e.length;++D)a[e[D]]=D;let h=n.length;for(;n[h-1]==="=";)--h;const p=new Uint8Array(h*r/8|0);let f=0,g=0,w=0;for(let D=0;D<h;++D){const O=a[n[D]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|O,f+=r,f>=8&&(f-=8,p[w++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},Cb=(n,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let h="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,h+=e[a&f>>p];if(p&&(h+=e[a&f<<r-p]),s)for(;h.length*r&7;)h+="=";return h},Yt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>ta({prefix:e,name:n,encode(a){return Cb(a,s,r)},decode(a){return xb(a,s,r,n)}}),Ob=ta({prefix:"\0",name:"identity",encode:n=>wb(n),decode:n=>bb(n)}),Pb=Object.freeze(Object.defineProperty({__proto__:null,identity:Ob},Symbol.toStringTag,{value:"Module"})),Ab=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Nb=Object.freeze(Object.defineProperty({__proto__:null,base2:Ab},Symbol.toStringTag,{value:"Module"})),Tb=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Rb=Object.freeze(Object.defineProperty({__proto__:null,base8:Tb},Symbol.toStringTag,{value:"Module"})),Fb=Ss({prefix:"9",name:"base10",alphabet:"0123456789"}),Ub=Object.freeze(Object.defineProperty({__proto__:null,base10:Fb},Symbol.toStringTag,{value:"Module"})),Lb=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$b=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Mb=Object.freeze(Object.defineProperty({__proto__:null,base16:Lb,base16upper:$b},Symbol.toStringTag,{value:"Module"})),jb=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qb=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),zb=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bb=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Hb=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kb=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Kb=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vb=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Wb=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Gb=Object.freeze(Object.defineProperty({__proto__:null,base32:jb,base32hex:Hb,base32hexpad:Kb,base32hexpadupper:Vb,base32hexupper:kb,base32pad:zb,base32padupper:Bb,base32upper:qb,base32z:Wb},Symbol.toStringTag,{value:"Module"})),Yb=Ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Jb=Ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Qb=Object.freeze(Object.defineProperty({__proto__:null,base36:Yb,base36upper:Jb},Symbol.toStringTag,{value:"Module"})),Xb=Ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Zb=Ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ew=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Xb,base58flickr:Zb},Symbol.toStringTag,{value:"Module"})),tw=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rw=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),iw=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nw=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),sw=Object.freeze(Object.defineProperty({__proto__:null,base64:tw,base64pad:rw,base64url:iw,base64urlpad:nw},Symbol.toStringTag,{value:"Module"})),Hd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ow=Hd.reduce((n,e,r)=>(n[r]=e,n),[]),aw=Hd.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function cw(n){return n.reduce((e,r)=>(e+=ow[r],e),"")}function uw(n){const e=[];for(const r of n){const s=aw[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const hw=ta({prefix:"🚀",name:"base256emoji",encode:cw,decode:uw}),lw=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:hw},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Jl={...Pb,...Nb,...Rb,...Ub,...Mb,...Gb,...Qb,...ew,...sw,...lw};function kd(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const Ql=kd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Tc=kd("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=zd(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),Kd={utf8:Ql,"utf-8":Ql,hex:Jl.base16,latin1:Tc,ascii:Tc,binary:Tc,...Jl};function br(n,e="utf8"){const r=Kd[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function hr(n,e="utf8"){const r=Kd[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Xl=globalThis&&globalThis.__spreadArray||function(n,e,r){if(r||arguments.length===2)for(var s=0,a=e.length,h;s<a;s++)(h||!(s in e))&&(h||(h=Array.prototype.slice.call(e,0,s)),h[s]=e[s]);return n.concat(h||Array.prototype.slice.call(e))},fw=function(){function n(e,r,s){this.name=e,this.version=r,this.os=s,this.type="browser"}return n}(),dw=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=si.platform}return n}(),pw=function(){function n(e,r,s,a){this.name=e,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),gw=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),vw=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),yw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,_w=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zl=3,mw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",yw]],ef=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function bw(n){return n?tf(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new vw:typeof navigator<"u"?tf(navigator.userAgent):Dw()}function ww(n){return n!==""&&mw.reduce(function(e,r){var s=r[0],a=r[1];if(e)return e;var h=a.exec(n);return!!h&&[s,h]},!1)}function tf(n){var e=ww(n);if(!e)return null;var r=e[0],s=e[1];if(r==="searchbot")return new gw;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<Zl&&(a=Xl(Xl([],a,!0),Sw(Zl-a.length),!0)):a=[];var h=a.join("."),p=Ew(n),f=_w.exec(n);return f&&f[1]?new pw(r,h,p,f[1]):new fw(r,h,p)}function Ew(n){for(var e=0,r=ef.length;e<r;e++){var s=ef[e],a=s[0],h=s[1],p=h.exec(n);if(p)return a}return null}function Dw(){var n=typeof si<"u"&&si.version;return n?new dw(si.version.slice(1)):null}function Sw(n){for(var e=[],r=0;r<n;r++)e.push("0");return e}var ye={},Rc={},ss={},rf;function Iw(){if(rf)return ss;rf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.delay=void 0;function n(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return ss.delay=n,ss}var tn={},Fc={},rn={},nf;function xw(){return nf||(nf=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var Uc={},sf;function Cw(){return sf||(sf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Uc)),Uc}var of;function Vd(){return of||(of=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(xw(),n),e.__exportStar(Cw(),n)}(Fc)),Fc}var af;function Ow(){if(af)return tn;af=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const n=Vd();function e(s){return s*n.ONE_THOUSAND}tn.toMiliseconds=e;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return tn.fromMiliseconds=r,tn}var cf;function Pw(){return cf||(cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(Iw(),n),e.__exportStar(Ow(),n)}(Rc)),Rc}var Nn={},uf;function Aw(){if(uf)return Nn;uf=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Nn.Watch=n,Nn.default=n,Nn}var Lc={},os={},hf;function Nw(){if(hf)return os;hf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IWatch=void 0;class n{}return os.IWatch=n,os}var lf;function Tw(){return lf||(lf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),zr.__exportStar(Nw(),n)}(Lc)),Lc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(Pw(),n),e.__exportStar(Aw(),n),e.__exportStar(Tw(),n),e.__exportStar(Vd(),n)})(ye);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Gd=lt.getLocation=lt.getLocationOrThrow=Ou=lt.getNavigator=lt.getNavigatorOrThrow=Wd=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function an(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}lt.getFromWindow=an;function $n(n){const e=an(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}lt.getFromWindowOrThrow=$n;function Rw(){return $n("document")}lt.getDocumentOrThrow=Rw;function Fw(){return an("document")}var Wd=lt.getDocument=Fw;function Uw(){return $n("navigator")}lt.getNavigatorOrThrow=Uw;function Lw(){return an("navigator")}var Ou=lt.getNavigator=Lw;function $w(){return $n("location")}lt.getLocationOrThrow=$w;function Mw(){return an("location")}var Gd=lt.getLocation=Mw;function jw(){return $n("crypto")}lt.getCryptoOrThrow=jw;function qw(){return an("crypto")}lt.getCrypto=qw;function zw(){return $n("localStorage")}lt.getLocalStorageOrThrow=zw;function Bw(){return an("localStorage")}lt.getLocalStorage=Bw;var Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});var Yd=Pu.getWindowMetadata=void 0;const ff=lt;function Hw(){let n,e;try{n=ff.getDocumentOrThrow(),e=ff.getLocationOrThrow()}catch{return null}function r(){const O=n.getElementsByTagName("link"),$=[];for(let A=0;A<O.length;A++){const M=O[A],H=M.getAttribute("rel");if(H&&H.toLowerCase().indexOf("icon")>-1){const k=M.getAttribute("href");if(k)if(k.toLowerCase().indexOf("https:")===-1&&k.toLowerCase().indexOf("http:")===-1&&k.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(k.indexOf("/")===0)ie+=k;else{const P=e.pathname.split("/");P.pop();const U=P.join("/");ie+=U+"/"+k}$.push(ie)}else if(k.indexOf("//")===0){const ie=e.protocol+k;$.push(ie)}else $.push(k)}}return $}function s(...O){const $=n.getElementsByTagName("meta");for(let A=0;A<$.length;A++){const M=$[A],H=["itemprop","property","name"].map(k=>M.getAttribute(k)).filter(k=>k?O.includes(k):!1);if(H.length&&H){const k=M.getAttribute("content");if(k)return k}}return""}function a(){let O=s("name","og:site_name","og:title","twitter:title");return O||(O=n.title),O}function h(){return s("description","og:description","twitter:description","keywords")}const p=a(),f=h(),g=e.origin,w=r();return{description:f,url:g,icons:w,name:p}}Yd=Pu.getWindowMetadata=Hw;var ms={},kw=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Jd="%[a-f0-9]{2}",df=new RegExp("("+Jd+")|([^%]+?)","gi"),pf=new RegExp("("+Jd+")+","gi");function du(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var r=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],du(r),du(s))}function Kw(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(df)||[],r=1;r<e.length;r++)n=du(e,r).join(""),e=n.match(df)||[];return n}}function Vw(n){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=pf.exec(n);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var s=Kw(r[0]);s!==r[0]&&(e[r[0]]=s)}r=pf.exec(n)}e["%C2"]="�";for(var a=Object.keys(e),h=0;h<a.length;h++){var p=a[h];n=n.replace(new RegExp(p,"g"),e[p])}return n}var Ww=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Vw(n)}},Gw=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const r=n.indexOf(e);return r===-1?[n]:[n.slice(0,r),n.slice(r+e.length)]},Yw=function(n,e){for(var r={},s=Object.keys(n),a=Array.isArray(e),h=0;h<s.length;h++){var p=s[h],f=n[p];(a?e.indexOf(p)!==-1:e(p,f,n))&&(r[p]=f)}return r};(function(n){const e=kw,r=Ww,s=Gw,a=Yw,h=P=>P==null,p=Symbol("encodeFragmentIdentifier");function f(P){switch(P.arrayFormat){case"index":return U=>(S,x)=>{const m=S.length;return x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?S:x===null?[...S,[D(U,P),"[",m,"]"].join("")]:[...S,[D(U,P),"[",D(m,P),"]=",D(x,P)].join("")]};case"bracket":return U=>(S,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?S:x===null?[...S,[D(U,P),"[]"].join("")]:[...S,[D(U,P),"[]=",D(x,P)].join("")];case"colon-list-separator":return U=>(S,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?S:x===null?[...S,[D(U,P),":list="].join("")]:[...S,[D(U,P),":list=",D(x,P)].join("")];case"comma":case"separator":case"bracket-separator":{const U=P.arrayFormat==="bracket-separator"?"[]=":"=";return S=>(x,m)=>m===void 0||P.skipNull&&m===null||P.skipEmptyString&&m===""?x:(m=m===null?"":m,x.length===0?[[D(S,P),U,D(m,P)].join("")]:[[x,D(m,P)].join(P.arrayFormatSeparator)])}default:return U=>(S,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?S:x===null?[...S,D(U,P)]:[...S,[D(U,P),"=",D(x,P)].join("")]}}function g(P){let U;switch(P.arrayFormat){case"index":return(S,x,m)=>{if(U=/\[(\d*)\]$/.exec(S),S=S.replace(/\[\d*\]$/,""),!U){m[S]=x;return}m[S]===void 0&&(m[S]={}),m[S][U[1]]=x};case"bracket":return(S,x,m)=>{if(U=/(\[\])$/.exec(S),S=S.replace(/\[\]$/,""),!U){m[S]=x;return}if(m[S]===void 0){m[S]=[x];return}m[S]=[].concat(m[S],x)};case"colon-list-separator":return(S,x,m)=>{if(U=/(:list)$/.exec(S),S=S.replace(/:list$/,""),!U){m[S]=x;return}if(m[S]===void 0){m[S]=[x];return}m[S]=[].concat(m[S],x)};case"comma":case"separator":return(S,x,m)=>{const c=typeof x=="string"&&x.includes(P.arrayFormatSeparator),_=typeof x=="string"&&!c&&O(x,P).includes(P.arrayFormatSeparator);x=_?O(x,P):x;const K=c||_?x.split(P.arrayFormatSeparator).map(W=>O(W,P)):x===null?x:O(x,P);m[S]=K};case"bracket-separator":return(S,x,m)=>{const c=/(\[\])$/.test(S);if(S=S.replace(/\[\]$/,""),!c){m[S]=x&&O(x,P);return}const _=x===null?[]:x.split(P.arrayFormatSeparator).map(K=>O(K,P));if(m[S]===void 0){m[S]=_;return}m[S]=[].concat(m[S],_)};default:return(S,x,m)=>{if(m[S]===void 0){m[S]=x;return}m[S]=[].concat(m[S],x)}}}function w(P){if(typeof P!="string"||P.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function D(P,U){return U.encode?U.strict?e(P):encodeURIComponent(P):P}function O(P,U){return U.decode?r(P):P}function $(P){return Array.isArray(P)?P.sort():typeof P=="object"?$(Object.keys(P)).sort((U,S)=>Number(U)-Number(S)).map(U=>P[U]):P}function A(P){const U=P.indexOf("#");return U!==-1&&(P=P.slice(0,U)),P}function M(P){let U="";const S=P.indexOf("#");return S!==-1&&(U=P.slice(S)),U}function H(P){P=A(P);const U=P.indexOf("?");return U===-1?"":P.slice(U+1)}function k(P,U){return U.parseNumbers&&!Number.isNaN(Number(P))&&typeof P=="string"&&P.trim()!==""?P=Number(P):U.parseBooleans&&P!==null&&(P.toLowerCase()==="true"||P.toLowerCase()==="false")&&(P=P.toLowerCase()==="true"),P}function ie(P,U){U=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},U),w(U.arrayFormatSeparator);const S=g(U),x=Object.create(null);if(typeof P!="string"||(P=P.trim().replace(/^[?#&]/,""),!P))return x;for(const m of P.split("&")){if(m==="")continue;let[c,_]=s(U.decode?m.replace(/\+/g," "):m,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(U.arrayFormat)?_:O(_,U),S(O(c,U),_,x)}for(const m of Object.keys(x)){const c=x[m];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=k(c[_],U);else x[m]=k(c,U)}return U.sort===!1?x:(U.sort===!0?Object.keys(x).sort():Object.keys(x).sort(U.sort)).reduce((m,c)=>{const _=x[c];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?m[c]=$(_):m[c]=_,m},Object.create(null))}n.extract=H,n.parse=ie,n.stringify=(P,U)=>{if(!P)return"";U=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},U),w(U.arrayFormatSeparator);const S=_=>U.skipNull&&h(P[_])||U.skipEmptyString&&P[_]==="",x=f(U),m={};for(const _ of Object.keys(P))S(_)||(m[_]=P[_]);const c=Object.keys(m);return U.sort!==!1&&c.sort(U.sort),c.map(_=>{const K=P[_];return K===void 0?"":K===null?D(_,U):Array.isArray(K)?K.length===0&&U.arrayFormat==="bracket-separator"?D(_,U)+"[]":K.reduce(x(_),[]).join("&"):D(_,U)+"="+D(K,U)}).filter(_=>_.length>0).join("&")},n.parseUrl=(P,U)=>{U=Object.assign({decode:!0},U);const[S,x]=s(P,"#");return Object.assign({url:S.split("?")[0]||"",query:ie(H(P),U)},U&&U.parseFragmentIdentifier&&x?{fragmentIdentifier:O(x,U)}:{})},n.stringifyUrl=(P,U)=>{U=Object.assign({encode:!0,strict:!0,[p]:!0},U);const S=A(P.url).split("?")[0]||"",x=n.extract(P.url),m=n.parse(x,{sort:!1}),c=Object.assign(m,P.query);let _=n.stringify(c,U);_&&(_=`?${_}`);let K=M(P.url);return P.fragmentIdentifier&&(K=`#${U[p]?D(P.fragmentIdentifier,U):P.fragmentIdentifier}`),`${S}${_}${K}`},n.pick=(P,U,S)=>{S=Object.assign({parseFragmentIdentifier:!0,[p]:!1},S);const{url:x,query:m,fragmentIdentifier:c}=n.parseUrl(P,S);return n.stringifyUrl({url:x,query:a(m,U),fragmentIdentifier:c},S)},n.exclude=(P,U,S)=>{const x=Array.isArray(U)?m=>!U.includes(m):(m,c)=>!U(m,c);return n.pick(P,x,S)}})(ms);const Jw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Qw(n,e=[]){const r=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Qd(n,e){return n.includes(":")?[n]:e.chains||[]}const Xd="base10",ur="base16",pu="base64pad",Au="utf8",Zd=0,cn=1,Xw=0,gf=1,gu=12,Nu=32;function Zw(){const n=xu.generateKeyPair();return{privateKey:hr(n.secretKey,ur),publicKey:hr(n.publicKey,ur)}}function vu(){const n=Ln.randomBytes(Nu);return hr(n,ur)}function eE(n,e){const r=xu.sharedKey(br(n,ur),br(e,ur)),s=new cb(ea.SHA256,r).expand(Nu);return hr(s,ur)}function tE(n){const e=ea.hash(br(n,ur));return hr(e,ur)}function Fn(n){const e=ea.hash(br(n,Au));return hr(e,ur)}function rE(n){return br(`${n}`,Xd)}function Is(n){return Number(hr(n,Xd))}function iE(n){const e=rE(typeof n.type<"u"?n.type:Zd);if(Is(e)===cn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?br(n.senderPublicKey,ur):void 0,s=typeof n.iv<"u"?br(n.iv,ur):Ln.randomBytes(gu),a=new Su.ChaCha20Poly1305(br(n.symKey,ur)).seal(s,br(n.message,Au));return sE({type:e,sealed:a,iv:s,senderPublicKey:r})}function nE(n){const e=new Su.ChaCha20Poly1305(br(n.symKey,ur)),{sealed:r,iv:s}=ko(n.encoded),a=e.open(s,r);if(a===null)throw new Error("Failed to decrypt");return hr(a,Au)}function sE(n){if(Is(n.type)===cn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(fu([n.type,n.senderPublicKey,n.iv,n.sealed]),pu)}return hr(fu([n.type,n.iv,n.sealed]),pu)}function ko(n){const e=br(n,pu),r=e.slice(Xw,gf),s=gf;if(Is(r)===cn){const f=s+Nu,g=f+gu,w=e.slice(s,f),D=e.slice(f,g),O=e.slice(g);return{type:r,sealed:O,iv:D,senderPublicKey:w}}const a=s+gu,h=e.slice(s,a),p=e.slice(a);return{type:r,sealed:p,iv:h}}function oE(n,e){const r=ko(n);return ep({type:Is(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?hr(r.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ep(n){const e=(n==null?void 0:n.type)||Zd;if(e===cn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function vf(n){return n.type===cn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var aE=Object.defineProperty,yf=Object.getOwnPropertySymbols,cE=Object.prototype.hasOwnProperty,uE=Object.prototype.propertyIsEnumerable,_f=(n,e,r)=>e in n?aE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,mf=(n,e)=>{for(var r in e||(e={}))cE.call(e,r)&&_f(n,r,e[r]);if(yf)for(var r of yf(e))uE.call(e,r)&&_f(n,r,e[r]);return n};const hE="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},lE="js";function Tu(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}function ra(){return!Wd()&&!!Ou()&&navigator.product===hE}function xs(){return!Tu()&&!!Ou()}function Cs(){return ra()?Or.reactNative:Tu()?Or.node:xs()?Or.browser:Or.unknown}function fE(n,e){let r=ms.parse(n);return r=mf(mf({},r),e),n=ms.stringify(r),n}function dE(){return Yd()||{name:"",description:"",url:"",icons:[""]}}function pE(){if(Cs()===Or.reactNative&&typeof wt<"u"&&typeof(wt==null?void 0:wt.Platform)<"u"){const{OS:r,Version:s}=wt.Platform;return[r,s].join("-")}const n=bw();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function gE(){var n;const e=Cs();return e===Or.browser?[e,((n=Gd())==null?void 0:n.host)||"unknown"].join(":"):e}function vE(n,e,r){const s=pE(),a=gE();return[[n,e].join("-"),[lE,r].join("-"),s,a].join("/")}function yE({protocol:n,version:e,relayUrl:r,sdkVersion:s,auth:a,projectId:h,useOnCloseEvent:p}){const f=r.split("?"),g=vE(n,e,s),w={auth:a,ua:g,projectId:h,useOnCloseEvent:p||void 0},D=fE(f[1]||"",w);return f[0]+"?"+D}function on(n,e){return n.filter(r=>e.includes(r)).length===n.length}function tp(n){return Object.fromEntries(n.entries())}function rp(n){return new Map(Object.entries(n))}function Tn(n=ye.FIVE_MINUTES,e){const r=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,a,h;return{resolve:p=>{h&&s&&(clearTimeout(h),s(p))},reject:p=>{h&&a&&(clearTimeout(h),a(p))},done:()=>new Promise((p,f)=>{h=setTimeout(()=>{f(new Error(e))},r),s=p,a=f})}}function bs(n,e,r){return new Promise(async(s,a)=>{const h=setTimeout(()=>a(new Error(r)),e);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(h)})}function ip(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function _E(n){return ip("topic",n)}function mE(n){return ip("id",n)}function np(n){const[e,r]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")s.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return s}function Gr(n,e){return ye.fromMiliseconds((e||Date.now())+ye.toMiliseconds(n))}function Ui(n){return Date.now()>=ye.toMiliseconds(n)}function Bt(n,e){return`${n}${e?`:${e}`:""}`}function $c(n=[],e=[]){return[...new Set([...n,...e])]}async function bE({id:n,topic:e,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${n}&sessionTopic=${e}`,p=Cs();p===Or.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):p===Or.reactNative&&typeof(wt==null?void 0:wt.Linking)<"u"&&await wt.Linking.openURL(h)}catch(s){console.error(s)}}const wE="irn";function yu(n){return(n==null?void 0:n.relay)||{protocol:wE}}function jo(n){const e=Jw[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var EE=Object.defineProperty,bf=Object.getOwnPropertySymbols,DE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable,wf=(n,e,r)=>e in n?EE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,IE=(n,e)=>{for(var r in e||(e={}))DE.call(e,r)&&wf(n,r,e[r]);if(bf)for(var r of bf(e))SE.call(e,r)&&wf(n,r,e[r]);return n};function xE(n,e="-"){const r={},s="relay"+e;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const h=a.replace(s,""),p=n[a];r[h]=p}}),r}function CE(n){const e=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),a=n.substring(e+1,r).split("@"),h=typeof r<"u"?n.substring(r):"",p=ms.parse(h);return{protocol:s,topic:OE(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:xE(p)}}function OE(n){return n.startsWith("//")?n.substring(2):n}function PE(n,e="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const h=r+e+a;n[a]&&(s[h]=n[a])}),s}function AE(n){return`${n.protocol}:${n.topic}@${n.version}?`+ms.stringify(IE({symKey:n.symKey},PE(n.relay)))}function Mn(n){const e=[];return n.forEach(r=>{const[s,a]=r.split(":");e.push(`${s}:${a}`)}),e}function NE(n){const e=[];return Object.values(n).forEach(r=>{e.push(...Mn(r.accounts))}),e}function TE(n,e){const r=[];return Object.values(n).forEach(s=>{Mn(s.accounts).includes(e)&&r.push(...s.methods)}),r}function RE(n,e){const r=[];return Object.values(n).forEach(s=>{Mn(s.accounts).includes(e)&&r.push(...s.events)}),r}function FE(n,e){const r=qo(n,e);if(r)throw new Error(r.message);const s={};for(const[a,h]of Object.entries(n))s[a]={methods:h.methods,events:h.events,chains:h.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function Ru(n){return n.includes(":")}function vs(n){return Ru(n)?n.split(":")[0]:n}const UE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},LE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(n,e){const{message:r,code:s}=LE[n];return{message:e?`${r} ${e}`:r,code:s}}function Rt(n,e){const{message:r,code:s}=UE[n];return{message:e?`${r} ${e}`:r,code:s}}function oi(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Un(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function cr(n){return typeof n>"u"}function Wt(n,e){return e&&cr(n)?!0:typeof n=="string"&&!!n.trim().length}function Fu(n,e){return e&&cr(n)?!0:typeof n=="number"&&!isNaN(n)}function $E(n,e){const{requiredNamespaces:r}=e,s=Object.keys(n.namespaces),a=Object.keys(r);let h=!0;return on(a,s)?(s.forEach(p=>{const{accounts:f,methods:g,events:w}=n.namespaces[p],D=Mn(f),O=r[p];(!on(Qd(p,O),D)||!on(O.methods,g)||!on(O.events,w))&&(h=!1)}),h):!1}function Ko(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function ME(n){if(Wt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Ko(r)}}return!1}function jE(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function qE(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function zE(n){return n==null?void 0:n.topic}function BE(n,e){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ef(n){let e=!0;return oi(n)?n.length&&(e=n.every(r=>Wt(r,!1))):e=!1,e}function HE(n,e,r){let s=null;return oi(e)&&e.length?e.forEach(a=>{s||Ko(a)||(s=Rt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Ko(n)||(s=Rt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function kE(n,e,r){let s=null;return Object.entries(n).forEach(([a,h])=>{if(s)return;const p=HE(a,Qd(a,h),`${e} ${r}`);p&&(s=p)}),s}function KE(n,e){let r=null;return oi(n)?n.forEach(s=>{r||ME(s)||(r=Rt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Rt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function VE(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=KE(s==null?void 0:s.accounts,`${e} namespace`);a&&(r=a)}),r}function WE(n,e){let r=null;return Ef(n==null?void 0:n.methods)?Ef(n==null?void 0:n.events)||(r=Rt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Rt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function sp(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=WE(s,`${e}, namespace`);a&&(r=a)}),r}function GE(n,e,r){let s=null;if(n&&Un(n)){const a=sp(n,e);a&&(s=a);const h=kE(n,e,r);h&&(s=h)}else s=ue("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return s}function qo(n,e){let r=null;if(n&&Un(n)){const s=sp(n,e);s&&(r=s);const a=VE(n,e);a&&(r=a)}else r=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function op(n){return Wt(n.protocol,!0)}function YE(n,e){let r=!1;return e&&!n?r=!0:n&&oi(n)&&n.length&&n.forEach(s=>{r=op(s)}),r}function JE(n){return typeof n=="number"}function mr(n){return typeof n<"u"&&typeof n!==null}function QE(n){return!(!n||typeof n!="object"||!n.code||!Fu(n.code,!1)||!n.message||!Wt(n.message,!1))}function XE(n){return!(cr(n)||!Wt(n.method,!1))}function ZE(n){return!(cr(n)||cr(n.result)&&cr(n.error)||!Fu(n.id,!1)||!Wt(n.jsonrpc,!1))}function e3(n){return!(cr(n)||!Wt(n.name,!1))}function Df(n,e){return!(!Ko(e)||!NE(n).includes(e))}function t3(n,e,r){return Wt(r,!1)?TE(n,e).includes(r):!1}function r3(n,e,r){return Wt(r,!1)?RE(n,e).includes(r):!1}function Sf(n,e,r){let s=null;const a=i3(n),h=n3(e),p=Object.keys(a),f=Object.keys(h),g=If(Object.keys(n)),w=If(Object.keys(e)),D=g.filter(O=>!w.includes(O));return D.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${D.toString()}
      Received: ${Object.keys(e).toString()}`)),on(p,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(O=>{if(!O.includes(":")||s)return;const $=Mn(e[O].accounts);$.includes(O)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${O}
        Required: ${O}
        Approved: ${$.toString()}`))}),p.forEach(O=>{s||(on(a[O].methods,h[O].methods)?on(a[O].events,h[O].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${O}`)):s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${O}`))}),s}function i3(n){const e={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?e[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{e[a]={methods:n[r].methods,events:n[r].events}})}),e}function If(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function n3(n){const e={};return Object.keys(n).forEach(r=>{if(r.includes(":"))e[r]=n[r];else{const s=Mn(n[r].accounts);s==null||s.forEach(a=>{e[a]={accounts:n[r].accounts.filter(h=>h.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),e}function s3(n,e){return Fu(n,!1)&&n<=e.max&&n>=e.min}function xf(){const n=Cs();return new Promise(e=>{switch(n){case Or.browser:e(o3());break;case Or.reactNative:e(a3());break;case Or.node:e(c3());break;default:e(!0)}})}function o3(){return xs()&&(navigator==null?void 0:navigator.onLine)}async function a3(){if(ra()&&typeof wt<"u"&&wt!=null&&wt.NetInfo){const n=await(wt==null?void 0:wt.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function c3(){return!0}function u3(n){switch(Cs()){case Or.browser:h3(n);break;case Or.reactNative:l3(n);break}}function h3(n){xs()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function l3(n){var e;ra()&&typeof wt<"u"&&wt!=null&&wt.NetInfo&&((e=wt)==null||e.NetInfo.addEventListener(r=>n(r==null?void 0:r.isConnected)))}const Mc={};let Uo=class{static get(e){return Mc[e]}static set(e,r){Mc[e]=r}static delete(e){delete Mc[e]}};var ia={},Os={};Object.defineProperty(Os,"__esModule",{value:!0});function f3(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}Os.safeJsonParse=f3;function d3(n){return typeof n=="string"?n:JSON.stringify(n,(e,r)=>typeof r>"u"?null:r)}Os.safeJsonStringify=d3;var Vo={},jc={get exports(){return Vo},set exports(n){Vo=n}},Cf;function p3(){return Cf||(Cf=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Cr<"u"&&Cr.localStorage?jc.exports=Cr.localStorage:typeof window<"u"&&window.localStorage?jc.exports=window.localStorage:jc.exports=new e}()),Vo}var qc={},as={},Of;function g3(){if(Of)return as;Of=1,Object.defineProperty(as,"__esModule",{value:!0}),as.IKeyValueStorage=void 0;class n{}return as.IKeyValueStorage=n,as}var cs={},Pf;function v3(){if(Pf)return cs;Pf=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.parseEntry=void 0;const n=Os;function e(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return cs.parseEntry=e,cs}var Af;function y3(){return Af||(Af=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(g3(),n),e.__exportStar(v3(),n)}(qc)),qc}Object.defineProperty(ia,"__esModule",{value:!0});ia.KeyValueStorage=void 0;const Rn=zr,Nf=Os,_3=Rn.__importDefault(p3()),m3=y3();class ap{constructor(){this.localStorage=_3.default}getKeys(){return Rn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Rn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(m3.parseEntry)})}getItem(e){return Rn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Nf.safeJsonParse(r)})}setItem(e,r){return Rn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Nf.safeJsonStringify(r))})}removeItem(e){return Rn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}ia.KeyValueStorage=ap;var b3=ia.default=ap,jn={},us={},zc={},hs={};let un=class{};const w3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:un},Symbol.toStringTag,{value:"Module"})),E3=Om(w3);var Tf;function D3(){if(Tf)return hs;Tf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.IHeartBeat=void 0;const n=E3;class e extends n.IEvents{constructor(s){super()}}return hs.IHeartBeat=e,hs}var Rf;function cp(){return Rf||(Rf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),zr.__exportStar(D3(),n)}(zc)),zc}var Bc={},nn={},Ff;function S3(){if(Ff)return nn;Ff=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HEARTBEAT_EVENTS=nn.HEARTBEAT_INTERVAL=void 0;const n=ye;return nn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,nn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nn}var Uf;function up(){return Uf||(Uf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),zr.__exportStar(S3(),n)}(Bc)),Bc}var Lf;function I3(){if(Lf)return us;Lf=1,Object.defineProperty(us,"__esModule",{value:!0}),us.HeartBeat=void 0;const n=zr,e=lr,r=ye,s=cp(),a=up();class h extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const g=new h(f);return yield g.init(),g})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return us.HeartBeat=h,us}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(I3(),n),e.__exportStar(cp(),n),e.__exportStar(up(),n)})(jn);var Ze={},Hc,$f;function x3(){if($f)return Hc;$f=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Hc=e;function e(r,s,a){var h=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var f=s.length+p;if(f===1)return r;var g=new Array(f);g[0]=h(r);for(var w=1;w<f;w++)g[w]=h(s[w]);return g.join(" ")}if(typeof r!="string")return r;var D=s.length;if(D===0)return r;for(var O="",$=1-p,A=-1,M=r&&r.length||0,H=0;H<M;){if(r.charCodeAt(H)===37&&H+1<M){switch(A=A>-1?A:0,r.charCodeAt(H+1)){case 100:case 102:if($>=D||s[$]==null)break;A<H&&(O+=r.slice(A,H)),O+=Number(s[$]),A=H+2,H++;break;case 105:if($>=D||s[$]==null)break;A<H&&(O+=r.slice(A,H)),O+=Math.floor(Number(s[$])),A=H+2,H++;break;case 79:case 111:case 106:if($>=D||s[$]===void 0)break;A<H&&(O+=r.slice(A,H));var k=typeof s[$];if(k==="string"){O+="'"+s[$]+"'",A=H+2,H++;break}if(k==="function"){O+=s[$].name||"<anonymous>",A=H+2,H++;break}O+=h(s[$]),A=H+2,H++;break;case 115:if($>=D)break;A<H&&(O+=r.slice(A,H)),O+=String(s[$]),A=H+2,H++;break;case 37:A<H&&(O+=r.slice(A,H)),O+="%",A=H+2,H++,$--;break}++$}++H}return A===-1?r:(A<M&&(O+=r.slice(A)),O)}return Hc}var kc,Mf;function C3(){if(Mf)return kc;Mf=1;const n=x3();kc=a;const e=x().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:H,wrapResponseSerializer:H,wrapErrorSerializer:H,req:M,res:M,err:$};function s(m,c){return Array.isArray(m)?m.filter(function(K){return K!=="!stdSerializers.err"}):m===!0?Object.keys(c):!1}function a(m){m=m||{},m.browser=m.browser||{};const c=m.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=m.browser.write||e;m.browser.write&&(m.browser.asObject=!0);const K=m.serializers||{},W=s(m.browser.serialize,K);let oe=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(oe=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),m.enabled===!1&&(m.level="silent");const ge=m.level||"info",T=Object.create(_);T.log||(T.log=k),Object.defineProperty(T,"levelVal",{get:le}),Object.defineProperty(T,"level",{get:te,set:G});const z={transmit:c,serialize:W,asObject:m.browser.asObject,levels:ce,timestamp:A(m)};T.levels=a.levels,T.level=ge,T.setMaxListeners=T.getMaxListeners=T.emit=T.addListener=T.on=T.prependListener=T.once=T.prependOnceListener=T.removeListener=T.removeAllListeners=T.listeners=T.listenerCount=T.eventNames=T.write=T.flush=k,T.serializers=K,T._serialize=W,T._stdErrSerialize=oe,T.child=ee,c&&(T._logEvent=O());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function G(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,h(z,T,"error","log"),h(z,T,"fatal","error"),h(z,T,"warn","error"),h(z,T,"info","log"),h(z,T,"debug","log"),h(z,T,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},W&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(W&&xe){var ne=Object.assign({},K,xe),be=m.browser.serialize===!0?Object.keys(ne):W;delete Y.serializers,g([Y],be,ne,this._stdErrSerialize)}function he(_e){this._childLevel=(_e._childLevel|0)+1,this.error=w(_e,Y,"error"),this.fatal=w(_e,Y,"fatal"),this.warn=w(_e,Y,"warn"),this.info=w(_e,Y,"info"),this.debug=w(_e,Y,"debug"),this.trace=w(_e,Y,"trace"),ne&&(this.serializers=ne,this._serialize=be),c&&(this._logEvent=O([].concat(_e._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return T}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:P,unixTime:U,isoTime:S});function h(m,c,_,K){const W=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?k:W[_]?W[_]:e[_]||e[K]||k,p(m,c,_)}function p(m,c,_){!m.transmit&&c[_]===k||(c[_]=function(K){return function(){const oe=m.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var T=0;T<ce.length;T++)ce[T]=arguments[T];if(m.serialize&&!m.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?K.call(ge,f(this,_,ce,oe)):K.apply(ge,ce),m.transmit){const z=m.transmit.level||c.level,le=a.levels.values[z],te=a.levels.values[_];if(te<le)return;D(this,{ts:oe,methodLevel:_,methodValue:te,transmitLevel:z,transmitValue:a.levels.values[m.transmit.level||c.level],send:m.transmit.send,val:c.levelVal},ce)}}}(c[_]))}function f(m,c,_,K){m._serialize&&g(_,m._serialize,m.serializers,m._stdErrSerialize);const W=_.slice();let oe=W[0];const ce={};K&&(ce.time=K),ce.level=a.levels.values[c];let ge=(m._childLevel|0)+1;if(ge<1&&(ge=1),oe!==null&&typeof oe=="object"){for(;ge--&&typeof W[0]=="object";)Object.assign(ce,W.shift());oe=W.length?n(W.shift(),W):void 0}else typeof oe=="string"&&(oe=n(W.shift(),W));return oe!==void 0&&(ce.msg=oe),ce}function g(m,c,_,K){for(const W in m)if(K&&m[W]instanceof Error)m[W]=a.stdSerializers.err(m[W]);else if(typeof m[W]=="object"&&!Array.isArray(m[W]))for(const oe in m[W])c&&c.indexOf(oe)>-1&&oe in _&&(m[W][oe]=_[oe](m[W][oe]))}function w(m,c,_){return function(){const K=new Array(1+arguments.length);K[0]=c;for(var W=1;W<K.length;W++)K[W]=arguments[W-1];return m[_].apply(this,K)}}function D(m,c,_){const K=c.send,W=c.ts,oe=c.methodLevel,ce=c.methodValue,ge=c.val,T=m._logEvent.bindings;g(_,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=W,m._logEvent.messages=_.filter(function(z){return T.indexOf(z)===-1}),m._logEvent.level.label=oe,m._logEvent.level.value=ce,K(oe,m._logEvent,ge),m._logEvent=O(T)}function O(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function $(m){const c={type:m.constructor.name,msg:m.message,stack:m.stack};for(const _ in m)c[_]===void 0&&(c[_]=m[_]);return c}function A(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?ie:P}function M(){return{}}function H(m){return m}function k(){}function ie(){return!1}function P(){return Date.now()}function U(){return Math.round(Date.now()/1e3)}function S(){return new Date(Date.now()).toISOString()}function x(){function m(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return kc}var sn={},jf;function hp(){return jf||(jf=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.PINO_CUSTOM_CONTEXT_KEY=sn.PINO_LOGGER_DEFAULTS=void 0,sn.PINO_LOGGER_DEFAULTS={level:"info"},sn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sn}var ar={},qf;function O3(){if(qf)return ar;qf=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=hp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function r(f,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}ar.getBrowserLoggerContext=r;function s(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){return f[w]=g,f}ar.setBrowserLoggerContext=s;function a(f,g=n.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof f.bindings>"u"?w=r(f,g):w=f.bindings().context||"",w}ar.getLoggerContext=a;function h(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const D=a(f,w);return D.trim()?`${D}/${g}`:g}ar.formatChildLoggerContext=h;function p(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const D=h(f,g,w),O=f.child({context:D});return s(O,D,w)}return ar.generateChildLogger=p,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=zr,r=e.__importDefault(C3());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(hp(),n),e.__exportStar(O3(),n)})(Ze);class P3 extends un{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class A3 extends un{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class N3{constructor(e,r){this.logger=e,this.core=r}}let T3=class extends un{constructor(e,r){super(),this.relayer=e,this.logger=r}},R3=class extends un{constructor(e){super()}},F3=class{constructor(e,r,s,a){this.core=e,this.logger=r,this.name=s}};class U3 extends un{constructor(e,r){super(),this.relayer=e,this.logger=r}}let L3=class extends un{constructor(e,r){super(),this.core=e,this.logger=r}},$3=class{constructor(e,r){this.projectId=e,this.logger=r}},M3=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},j3=class{constructor(e){this.client=e}};const q3=n=>JSON.stringify(n,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),z3=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function Uu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return z3(n)}catch{return n}}function ws(n){return typeof n=="string"?n:q3(n)||""}var Lu={},lp={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Le,r=Pr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var D=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=g[D++],w--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(D=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,D,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[D++],w--;return this},f.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,D=this._bufferLength,O=w/536870912|0,$=w<<3,A=w%128<112?128:256;this._buffer[D]=128;for(var M=D+1;M<A-8;M++)this._buffer[M]=0;e.writeUint32BE(O,this._buffer,A-8),e.writeUint32BE($,this._buffer,A-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)e.writeUint32BE(this._stateHi[M],g,M*8),e.writeUint32BE(this._stateLo[M],g,M*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.stateHi),r.wipe(g.stateLo),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(f,g,w,D,O,$,A){for(var M=w[0],H=w[1],k=w[2],ie=w[3],P=w[4],U=w[5],S=w[6],x=w[7],m=D[0],c=D[1],_=D[2],K=D[3],W=D[4],oe=D[5],ce=D[6],ge=D[7],T,z,le,te,G,ee,Y,re;A>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+$;f[xe]=e.readUint32BE(O,ne),g[xe]=e.readUint32BE(O,ne+4)}for(var xe=0;xe<80;xe++){var be=M,he=H,_e=k,q=ie,j=P,N=U,l=S,I=x,se=m,fe=c,Se=_,Be=K,Ke=W,$e=oe,pt=ce,gt=ge;if(T=x,z=ge,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=(P>>>14|W<<32-14)^(P>>>18|W<<32-18)^(W>>>41-32|P<<32-(41-32)),z=(W>>>14|P<<32-14)^(W>>>18|P<<32-18)^(P>>>41-32|W<<32-(41-32)),G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,T=P&U^~P&S,z=W&oe^~W&ce,G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,T=a[xe*2],z=a[xe*2+1],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,T=f[xe%16],z=g[xe%16],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=G&65535|ee<<16,T=le,z=te,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=(M>>>28|m<<32-28)^(m>>>34-32|M<<32-(34-32))^(m>>>39-32|M<<32-(39-32)),z=(m>>>28|M<<32-28)^(M>>>34-32|m<<32-(34-32))^(M>>>39-32|m<<32-(39-32)),G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,T=M&H^M&k^H&k,z=m&c^m&_^c&_,G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,I=Y&65535|re<<16,gt=G&65535|ee<<16,T=q,z=Be,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=le,z=te,G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,q=Y&65535|re<<16,Be=G&65535|ee<<16,H=be,k=he,ie=_e,P=q,U=j,S=N,x=l,M=I,c=se,_=fe,K=Se,W=Be,oe=Ke,ce=$e,ge=pt,m=gt,xe%16===15)for(var ne=0;ne<16;ne++)T=f[ne],z=g[ne],G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=f[(ne+9)%16],z=g[(ne+9)%16],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,le=f[(ne+1)%16],te=g[(ne+1)%16],T=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,z=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,le=f[(ne+14)%16],te=g[(ne+14)%16],T=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,z=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,f[ne]=Y&65535|re<<16,g[ne]=G&65535|ee<<16}T=M,z=m,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[0],z=D[0],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[0]=M=Y&65535|re<<16,D[0]=m=G&65535|ee<<16,T=H,z=c,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[1],z=D[1],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[1]=H=Y&65535|re<<16,D[1]=c=G&65535|ee<<16,T=k,z=_,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[2],z=D[2],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[2]=k=Y&65535|re<<16,D[2]=_=G&65535|ee<<16,T=ie,z=K,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[3],z=D[3],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[3]=ie=Y&65535|re<<16,D[3]=K=G&65535|ee<<16,T=P,z=W,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[4],z=D[4],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[4]=P=Y&65535|re<<16,D[4]=W=G&65535|ee<<16,T=U,z=oe,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[5],z=D[5],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[5]=U=Y&65535|re<<16,D[5]=oe=G&65535|ee<<16,T=S,z=ce,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[6],z=D[6],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[6]=S=Y&65535|re<<16,D[6]=ce=G&65535|ee<<16,T=x,z=ge,G=z&65535,ee=z>>>16,Y=T&65535,re=T>>>16,T=w[7],z=D[7],G+=z&65535,ee+=z>>>16,Y+=T&65535,re+=T>>>16,ee+=G>>>16,Y+=ee>>>16,re+=Y>>>16,w[7]=x=Y&65535|re<<16,D[7]=ge=G&65535|ee<<16,$+=128,A-=128}return $}function p(f){var g=new s;g.update(f);var w=g.digest();return g.clean(),w}n.hash=p})(lp);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=Ln,r=lp,s=Pr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const j=new Float64Array(16);if(q)for(let N=0;N<q.length;N++)j[N]=q[N];return j}const h=new Uint8Array(32);h[0]=9;const p=a(),f=a([1]),g=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),D=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(q,j){for(let N=0;N<16;N++)q[N]=j[N]|0}function M(q){let j=1;for(let N=0;N<16;N++){let l=q[N]+j+65535;j=Math.floor(l/65536),q[N]=l-j*65536}q[0]+=j-1+37*(j-1)}function H(q,j,N){const l=~(N-1);for(let I=0;I<16;I++){const se=l&(q[I]^j[I]);q[I]^=se,j[I]^=se}}function k(q,j){const N=a(),l=a();for(let I=0;I<16;I++)l[I]=j[I];M(l),M(l),M(l);for(let I=0;I<2;I++){N[0]=l[0]-65517;for(let fe=1;fe<15;fe++)N[fe]=l[fe]-65535-(N[fe-1]>>16&1),N[fe-1]&=65535;N[15]=l[15]-32767-(N[14]>>16&1);const se=N[15]>>16&1;N[14]&=65535,H(l,N,1-se)}for(let I=0;I<16;I++)q[2*I]=l[I]&255,q[2*I+1]=l[I]>>8}function ie(q,j){let N=0;for(let l=0;l<32;l++)N|=q[l]^j[l];return(1&N-1>>>8)-1}function P(q,j){const N=new Uint8Array(32),l=new Uint8Array(32);return k(N,q),k(l,j),ie(N,l)}function U(q){const j=new Uint8Array(32);return k(j,q),j[0]&1}function S(q,j){for(let N=0;N<16;N++)q[N]=j[2*N]+(j[2*N+1]<<8);q[15]&=32767}function x(q,j,N){for(let l=0;l<16;l++)q[l]=j[l]+N[l]}function m(q,j,N){for(let l=0;l<16;l++)q[l]=j[l]-N[l]}function c(q,j,N){let l,I,se=0,fe=0,Se=0,Be=0,Ke=0,$e=0,pt=0,gt=0,je=0,Ie=0,Re=0,Fe=0,qe=0,Oe=0,Ue=0,De=0,Pe=0,He=0,Ce=0,Ve=0,Ge=0,et=0,tt=0,Je=0,tr=0,fr=0,Jr=0,rr=0,ai=0,Si=0,qi=0,Et=N[0],vt=N[1],Dt=N[2],St=N[3],mt=N[4],yt=N[5],Ut=N[6],Lt=N[7],It=N[8],$t=N[9],xt=N[10],Pt=N[11],Ct=N[12],ht=N[13],Mt=N[14],jt=N[15];l=j[0],se+=l*Et,fe+=l*vt,Se+=l*Dt,Be+=l*St,Ke+=l*mt,$e+=l*yt,pt+=l*Ut,gt+=l*Lt,je+=l*It,Ie+=l*$t,Re+=l*xt,Fe+=l*Pt,qe+=l*Ct,Oe+=l*ht,Ue+=l*Mt,De+=l*jt,l=j[1],fe+=l*Et,Se+=l*vt,Be+=l*Dt,Ke+=l*St,$e+=l*mt,pt+=l*yt,gt+=l*Ut,je+=l*Lt,Ie+=l*It,Re+=l*$t,Fe+=l*xt,qe+=l*Pt,Oe+=l*Ct,Ue+=l*ht,De+=l*Mt,Pe+=l*jt,l=j[2],Se+=l*Et,Be+=l*vt,Ke+=l*Dt,$e+=l*St,pt+=l*mt,gt+=l*yt,je+=l*Ut,Ie+=l*Lt,Re+=l*It,Fe+=l*$t,qe+=l*xt,Oe+=l*Pt,Ue+=l*Ct,De+=l*ht,Pe+=l*Mt,He+=l*jt,l=j[3],Be+=l*Et,Ke+=l*vt,$e+=l*Dt,pt+=l*St,gt+=l*mt,je+=l*yt,Ie+=l*Ut,Re+=l*Lt,Fe+=l*It,qe+=l*$t,Oe+=l*xt,Ue+=l*Pt,De+=l*Ct,Pe+=l*ht,He+=l*Mt,Ce+=l*jt,l=j[4],Ke+=l*Et,$e+=l*vt,pt+=l*Dt,gt+=l*St,je+=l*mt,Ie+=l*yt,Re+=l*Ut,Fe+=l*Lt,qe+=l*It,Oe+=l*$t,Ue+=l*xt,De+=l*Pt,Pe+=l*Ct,He+=l*ht,Ce+=l*Mt,Ve+=l*jt,l=j[5],$e+=l*Et,pt+=l*vt,gt+=l*Dt,je+=l*St,Ie+=l*mt,Re+=l*yt,Fe+=l*Ut,qe+=l*Lt,Oe+=l*It,Ue+=l*$t,De+=l*xt,Pe+=l*Pt,He+=l*Ct,Ce+=l*ht,Ve+=l*Mt,Ge+=l*jt,l=j[6],pt+=l*Et,gt+=l*vt,je+=l*Dt,Ie+=l*St,Re+=l*mt,Fe+=l*yt,qe+=l*Ut,Oe+=l*Lt,Ue+=l*It,De+=l*$t,Pe+=l*xt,He+=l*Pt,Ce+=l*Ct,Ve+=l*ht,Ge+=l*Mt,et+=l*jt,l=j[7],gt+=l*Et,je+=l*vt,Ie+=l*Dt,Re+=l*St,Fe+=l*mt,qe+=l*yt,Oe+=l*Ut,Ue+=l*Lt,De+=l*It,Pe+=l*$t,He+=l*xt,Ce+=l*Pt,Ve+=l*Ct,Ge+=l*ht,et+=l*Mt,tt+=l*jt,l=j[8],je+=l*Et,Ie+=l*vt,Re+=l*Dt,Fe+=l*St,qe+=l*mt,Oe+=l*yt,Ue+=l*Ut,De+=l*Lt,Pe+=l*It,He+=l*$t,Ce+=l*xt,Ve+=l*Pt,Ge+=l*Ct,et+=l*ht,tt+=l*Mt,Je+=l*jt,l=j[9],Ie+=l*Et,Re+=l*vt,Fe+=l*Dt,qe+=l*St,Oe+=l*mt,Ue+=l*yt,De+=l*Ut,Pe+=l*Lt,He+=l*It,Ce+=l*$t,Ve+=l*xt,Ge+=l*Pt,et+=l*Ct,tt+=l*ht,Je+=l*Mt,tr+=l*jt,l=j[10],Re+=l*Et,Fe+=l*vt,qe+=l*Dt,Oe+=l*St,Ue+=l*mt,De+=l*yt,Pe+=l*Ut,He+=l*Lt,Ce+=l*It,Ve+=l*$t,Ge+=l*xt,et+=l*Pt,tt+=l*Ct,Je+=l*ht,tr+=l*Mt,fr+=l*jt,l=j[11],Fe+=l*Et,qe+=l*vt,Oe+=l*Dt,Ue+=l*St,De+=l*mt,Pe+=l*yt,He+=l*Ut,Ce+=l*Lt,Ve+=l*It,Ge+=l*$t,et+=l*xt,tt+=l*Pt,Je+=l*Ct,tr+=l*ht,fr+=l*Mt,Jr+=l*jt,l=j[12],qe+=l*Et,Oe+=l*vt,Ue+=l*Dt,De+=l*St,Pe+=l*mt,He+=l*yt,Ce+=l*Ut,Ve+=l*Lt,Ge+=l*It,et+=l*$t,tt+=l*xt,Je+=l*Pt,tr+=l*Ct,fr+=l*ht,Jr+=l*Mt,rr+=l*jt,l=j[13],Oe+=l*Et,Ue+=l*vt,De+=l*Dt,Pe+=l*St,He+=l*mt,Ce+=l*yt,Ve+=l*Ut,Ge+=l*Lt,et+=l*It,tt+=l*$t,Je+=l*xt,tr+=l*Pt,fr+=l*Ct,Jr+=l*ht,rr+=l*Mt,ai+=l*jt,l=j[14],Ue+=l*Et,De+=l*vt,Pe+=l*Dt,He+=l*St,Ce+=l*mt,Ve+=l*yt,Ge+=l*Ut,et+=l*Lt,tt+=l*It,Je+=l*$t,tr+=l*xt,fr+=l*Pt,Jr+=l*Ct,rr+=l*ht,ai+=l*Mt,Si+=l*jt,l=j[15],De+=l*Et,Pe+=l*vt,He+=l*Dt,Ce+=l*St,Ve+=l*mt,Ge+=l*yt,et+=l*Ut,tt+=l*Lt,Je+=l*It,tr+=l*$t,fr+=l*xt,Jr+=l*Pt,rr+=l*Ct,ai+=l*ht,Si+=l*Mt,qi+=l*jt,se+=38*Pe,fe+=38*He,Se+=38*Ce,Be+=38*Ve,Ke+=38*Ge,$e+=38*et,pt+=38*tt,gt+=38*Je,je+=38*tr,Ie+=38*fr,Re+=38*Jr,Fe+=38*rr,qe+=38*ai,Oe+=38*Si,Ue+=38*qi,I=1,l=se+I+65535,I=Math.floor(l/65536),se=l-I*65536,l=fe+I+65535,I=Math.floor(l/65536),fe=l-I*65536,l=Se+I+65535,I=Math.floor(l/65536),Se=l-I*65536,l=Be+I+65535,I=Math.floor(l/65536),Be=l-I*65536,l=Ke+I+65535,I=Math.floor(l/65536),Ke=l-I*65536,l=$e+I+65535,I=Math.floor(l/65536),$e=l-I*65536,l=pt+I+65535,I=Math.floor(l/65536),pt=l-I*65536,l=gt+I+65535,I=Math.floor(l/65536),gt=l-I*65536,l=je+I+65535,I=Math.floor(l/65536),je=l-I*65536,l=Ie+I+65535,I=Math.floor(l/65536),Ie=l-I*65536,l=Re+I+65535,I=Math.floor(l/65536),Re=l-I*65536,l=Fe+I+65535,I=Math.floor(l/65536),Fe=l-I*65536,l=qe+I+65535,I=Math.floor(l/65536),qe=l-I*65536,l=Oe+I+65535,I=Math.floor(l/65536),Oe=l-I*65536,l=Ue+I+65535,I=Math.floor(l/65536),Ue=l-I*65536,l=De+I+65535,I=Math.floor(l/65536),De=l-I*65536,se+=I-1+37*(I-1),I=1,l=se+I+65535,I=Math.floor(l/65536),se=l-I*65536,l=fe+I+65535,I=Math.floor(l/65536),fe=l-I*65536,l=Se+I+65535,I=Math.floor(l/65536),Se=l-I*65536,l=Be+I+65535,I=Math.floor(l/65536),Be=l-I*65536,l=Ke+I+65535,I=Math.floor(l/65536),Ke=l-I*65536,l=$e+I+65535,I=Math.floor(l/65536),$e=l-I*65536,l=pt+I+65535,I=Math.floor(l/65536),pt=l-I*65536,l=gt+I+65535,I=Math.floor(l/65536),gt=l-I*65536,l=je+I+65535,I=Math.floor(l/65536),je=l-I*65536,l=Ie+I+65535,I=Math.floor(l/65536),Ie=l-I*65536,l=Re+I+65535,I=Math.floor(l/65536),Re=l-I*65536,l=Fe+I+65535,I=Math.floor(l/65536),Fe=l-I*65536,l=qe+I+65535,I=Math.floor(l/65536),qe=l-I*65536,l=Oe+I+65535,I=Math.floor(l/65536),Oe=l-I*65536,l=Ue+I+65535,I=Math.floor(l/65536),Ue=l-I*65536,l=De+I+65535,I=Math.floor(l/65536),De=l-I*65536,se+=I-1+37*(I-1),q[0]=se,q[1]=fe,q[2]=Se,q[3]=Be,q[4]=Ke,q[5]=$e,q[6]=pt,q[7]=gt,q[8]=je,q[9]=Ie,q[10]=Re,q[11]=Fe,q[12]=qe,q[13]=Oe,q[14]=Ue,q[15]=De}function _(q,j){c(q,j,j)}function K(q,j){const N=a();let l;for(l=0;l<16;l++)N[l]=j[l];for(l=253;l>=0;l--)_(N,N),l!==2&&l!==4&&c(N,N,j);for(l=0;l<16;l++)q[l]=N[l]}function W(q,j){const N=a();let l;for(l=0;l<16;l++)N[l]=j[l];for(l=250;l>=0;l--)_(N,N),l!==1&&c(N,N,j);for(l=0;l<16;l++)q[l]=N[l]}function oe(q,j){const N=a(),l=a(),I=a(),se=a(),fe=a(),Se=a(),Be=a(),Ke=a(),$e=a();m(N,q[1],q[0]),m($e,j[1],j[0]),c(N,N,$e),x(l,q[0],q[1]),x($e,j[0],j[1]),c(l,l,$e),c(I,q[3],j[3]),c(I,I,w),c(se,q[2],j[2]),x(se,se,se),m(fe,l,N),m(Se,se,I),x(Be,se,I),x(Ke,l,N),c(q[0],fe,Se),c(q[1],Ke,Be),c(q[2],Be,Se),c(q[3],fe,Ke)}function ce(q,j,N){for(let l=0;l<4;l++)H(q[l],j[l],N)}function ge(q,j){const N=a(),l=a(),I=a();K(I,j[2]),c(N,j[0],I),c(l,j[1],I),k(q,l),q[31]^=U(N)<<7}function T(q,j,N){A(q[0],p),A(q[1],f),A(q[2],f),A(q[3],p);for(let l=255;l>=0;--l){const I=N[l/8|0]>>(l&7)&1;ce(q,j,I),oe(j,q),oe(q,q),ce(q,j,I)}}function z(q,j){const N=[a(),a(),a(),a()];A(N[0],D),A(N[1],O),A(N[2],f),c(N[3],D,O),T(q,N,j)}function le(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const j=(0,r.hash)(q);j[0]&=248,j[31]&=127,j[31]|=64;const N=new Uint8Array(32),l=[a(),a(),a(),a()];z(l,j),ge(N,l);const I=new Uint8Array(64);return I.set(q),I.set(N,32),{publicKey:N,secretKey:I}}n.generateKeyPairFromSeed=le;function te(q){const j=(0,e.randomBytes)(32,q),N=le(j);return(0,s.wipe)(j),N}n.generateKeyPair=te;function G(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=G;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(q,j){let N,l,I,se;for(l=63;l>=32;--l){for(N=0,I=l-32,se=l-12;I<se;++I)j[I]+=N-16*j[l]*ee[I-(l-32)],N=Math.floor((j[I]+128)/256),j[I]-=N*256;j[I]+=N,j[l]=0}for(N=0,I=0;I<32;I++)j[I]+=N-(j[31]>>4)*ee[I],N=j[I]>>8,j[I]&=255;for(I=0;I<32;I++)j[I]-=N*ee[I];for(l=0;l<32;l++)j[l+1]+=j[l]>>8,q[l]=j[l]&255}function re(q){const j=new Float64Array(64);for(let N=0;N<64;N++)j[N]=q[N];for(let N=0;N<64;N++)q[N]=0;Y(q,j)}function xe(q,j){const N=new Float64Array(64),l=[a(),a(),a(),a()],I=(0,r.hash)(q.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const se=new Uint8Array(64);se.set(I.subarray(32),32);const fe=new r.SHA512;fe.update(se.subarray(32)),fe.update(j);const Se=fe.digest();fe.clean(),re(Se),z(l,Se),ge(se,l),fe.reset(),fe.update(se.subarray(0,32)),fe.update(q.subarray(32)),fe.update(j);const Be=fe.digest();re(Be);for(let Ke=0;Ke<32;Ke++)N[Ke]=Se[Ke];for(let Ke=0;Ke<32;Ke++)for(let $e=0;$e<32;$e++)N[Ke+$e]+=Be[Ke]*I[$e];return Y(se.subarray(32),N),se}n.sign=xe;function ne(q,j){const N=a(),l=a(),I=a(),se=a(),fe=a(),Se=a(),Be=a();return A(q[2],f),S(q[1],j),_(I,q[1]),c(se,I,g),m(I,I,q[2]),x(se,q[2],se),_(fe,se),_(Se,fe),c(Be,Se,fe),c(N,Be,I),c(N,N,se),W(N,N),c(N,N,I),c(N,N,se),c(N,N,se),c(q[0],N,se),_(l,q[0]),c(l,l,se),P(l,I)&&c(q[0],q[0],$),_(l,q[0]),c(l,l,se),P(l,I)?-1:(U(q[0])===j[31]>>7&&m(q[0],p,q[0]),c(q[3],q[0],q[1]),0)}function be(q,j,N){const l=new Uint8Array(32),I=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if(N.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ne(se,q))return!1;const fe=new r.SHA512;fe.update(N.subarray(0,32)),fe.update(q),fe.update(j);const Se=fe.digest();return re(Se),T(I,se,Se),z(se,N.subarray(32)),oe(I,se),ge(l,I),!ie(N,l)}n.verify=be;function he(q){let j=[a(),a(),a(),a()];if(ne(j,q))throw new Error("Ed25519: invalid public key");let N=a(),l=a(),I=j[1];x(N,f,I),m(l,f,I),K(l,l),c(N,N,l);let se=new Uint8Array(32);return k(se,N),se}n.convertPublicKeyToX25519=he;function _e(q){const j=(0,r.hash)(q.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const N=new Uint8Array(j.subarray(0,32));return(0,s.wipe)(j),N}n.convertSecretKeyToX25519=_e})(Lu);const B3="EdDSA",H3="JWT",fp=".",dp="base64url",k3="utf8",K3="utf8",V3=":",W3="did",G3="key",zf="base58btc",Y3="z",J3="K36",Q3=32;function Wo(n){return hr(br(ws(n),k3),dp)}function pp(n){const e=br(J3,zf),r=Y3+hr(fu([e,n]),zf);return[W3,G3,r].join(V3)}function X3(n){return hr(n,dp)}function Z3(n){return br([Wo(n.header),Wo(n.payload)].join(fp),K3)}function e6(n){return[Wo(n.header),Wo(n.payload),X3(n.signature)].join(fp)}function Bf(n=Ln.randomBytes(Q3)){return Lu.generateKeyPairFromSeed(n)}async function t6(n,e,r,s,a=ye.fromMiliseconds(Date.now())){const h={alg:B3,typ:H3},p=pp(s.publicKey),f=a+r,g={iss:p,sub:n,aud:e,iat:a,exp:f},w=Z3({header:h,payload:g}),D=Lu.sign(s.secretKey,w);return e6({header:h,payload:g,signature:D})}const r6="PARSE_ERROR",i6="INVALID_REQUEST",n6="METHOD_NOT_FOUND",s6="INVALID_PARAMS",gp="INTERNAL_ERROR",$u="SERVER_ERROR",o6=[-32700,-32600,-32601,-32602,-32603],_s={[r6]:{code:-32700,message:"Parse error"},[i6]:{code:-32600,message:"Invalid Request"},[n6]:{code:-32601,message:"Method not found"},[s6]:{code:-32602,message:"Invalid params"},[gp]:{code:-32603,message:"Internal error"},[$u]:{code:-32e3,message:"Server error"}},vp=$u;function a6(n){return o6.includes(n)}function Hf(n){return Object.keys(_s).includes(n)?_s[n]:_s[vp]}function c6(n){const e=Object.values(_s).find(r=>r.code===n);return e||_s[vp]}function yp(n,e,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):n}var _p={},mi={},kf;function u6(){if(kf)return mi;kf=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowserCryptoAvailable=mi.getSubtleCrypto=mi.getBrowerCrypto=void 0;function n(){return(Cr===null||Cr===void 0?void 0:Cr.crypto)||(Cr===null||Cr===void 0?void 0:Cr.msCrypto)||{}}mi.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}mi.getSubtleCrypto=e;function r(){return!!n()&&!!e()}return mi.isBrowserCryptoAvailable=r,mi}var bi={},Kf;function h6(){if(Kf)return bi;Kf=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.isBrowser=bi.isNode=bi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}bi.isReactNative=n;function e(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}bi.isNode=e;function r(){return!n()&&!e()}return bi.isBrowser=r,bi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=zr;e.__exportStar(u6(),n),e.__exportStar(h6(),n)})(_p);function Mu(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function mp(n=6){return BigInt(Mu(n))}function Es(n,e,r){return{id:r||Mu(),jsonrpc:"2.0",method:n,params:e}}function ju(n,e){return{id:n,jsonrpc:"2.0",result:e}}function na(n,e,r){return{id:n,jsonrpc:"2.0",error:l6(e,r)}}function l6(n,e){return typeof n>"u"?Hf(gp):(typeof n=="string"&&(n=Object.assign(Object.assign({},Hf($u)),{message:n})),typeof e<"u"&&(n.data=e),a6(n.code)&&(n=c6(n.code)),n)}class f6{}class d6 extends f6{constructor(){super()}}class p6 extends d6{constructor(e){super()}}const g6="^https?:",v6="^wss?:";function y6(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function bp(n,e){const r=y6(n);return typeof r>"u"?!1:new RegExp(e).test(r)}function Vf(n){return bp(n,g6)}function Wf(n){return bp(n,v6)}function _6(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function wp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function qu(n){return wp(n)&&"method"in n}function sa(n){return wp(n)&&(Di(n)||Yr(n))}function Di(n){return"result"in n}function Yr(n){return"error"in n}class Mi extends p6{constructor(e){super(e),this.events=new lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Es(e.method,e.params||[],e.id||mp().toString()),r)}async requestStrict(e,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${e.id}`,h=>{Yr(h)?a(h.error):s(h.result)});try{await this.connection.send(e,r)}catch(h){a(h)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),sa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const m6=()=>typeof WebSocket<"u"?WebSocket:typeof wt<"u"&&typeof wt.WebSocket<"u"?wt.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),b6=()=>typeof WebSocket<"u"||typeof wt<"u"&&typeof wt.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Gf=n=>n.split("?")[0],Yf=10,w6=m6();class E6{constructor(e){if(this.url=e,this.events=new lr.EventEmitter,this.registering=!1,!Wf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ws(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Wf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,s)=>{const a=_p.isReactNative()?void 0:{rejectUnauthorized:!_6(e)},h=new w6(e,[],a);b6()?h.onerror=p=>{const f=p;s(this.emitError(f.error))}:h.on("error",p=>{s(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Uu(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),h=na(e,a);this.events.emit("payload",h)}parseError(e,r=this.url){return yp(e,Gf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Yf&&this.events.setMaxListeners(Yf)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Gf(this.url)}`));return this.events.emit("register_error",r),r}}var Go={},D6={get exports(){return Go},set exports(n){Go=n}};(function(n,e){var r=200,s="__lodash_hash_undefined__",a=1,h=2,p=9007199254740991,f="[object Arguments]",g="[object Array]",w="[object AsyncFunction]",D="[object Boolean]",O="[object Date]",$="[object Error]",A="[object Function]",M="[object GeneratorFunction]",H="[object Map]",k="[object Number]",ie="[object Null]",P="[object Object]",U="[object Promise]",S="[object Proxy]",x="[object RegExp]",m="[object Set]",c="[object String]",_="[object Symbol]",K="[object Undefined]",W="[object WeakMap]",oe="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",T="[object Float64Array]",z="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",G="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[T]=he[z]=he[le]=he[te]=he[G]=he[ee]=he[Y]=he[re]=!0,he[f]=he[g]=he[oe]=he[D]=he[ce]=he[O]=he[$]=he[A]=he[H]=he[k]=he[P]=he[x]=he[m]=he[c]=he[W]=!1;var _e=typeof Cr=="object"&&Cr&&Cr.Object===Object&&Cr,q=typeof self=="object"&&self&&self.Object===Object&&self,j=_e||q||Function("return this")(),N=e&&!e.nodeType&&e,l=N&&!0&&n&&!n.nodeType&&n,I=l&&l.exports===N,se=I&&_e.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Se=fe&&fe.isTypedArray;function Be(b,R){for(var X=-1,de=b==null?0:b.length,at=0,Ne=[];++X<de;){var ft=b[X];R(ft,X,b)&&(Ne[at++]=ft)}return Ne}function Ke(b,R){for(var X=-1,de=R.length,at=b.length;++X<de;)b[at+X]=R[X];return b}function $e(b,R){for(var X=-1,de=b==null?0:b.length;++X<de;)if(R(b[X],X,b))return!0;return!1}function pt(b,R){for(var X=-1,de=Array(b);++X<b;)de[X]=R(X);return de}function gt(b){return function(R){return b(R)}}function je(b,R){return b.has(R)}function Ie(b,R){return b==null?void 0:b[R]}function Re(b){var R=-1,X=Array(b.size);return b.forEach(function(de,at){X[++R]=[at,de]}),X}function Fe(b,R){return function(X){return b(R(X))}}function qe(b){var R=-1,X=Array(b.size);return b.forEach(function(de){X[++R]=de}),X}var Oe=Array.prototype,Ue=Function.prototype,De=Object.prototype,Pe=j["__core-js_shared__"],He=Ue.toString,Ce=De.hasOwnProperty,Ve=function(){var b=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),Ge=De.toString,et=RegExp("^"+He.call(Ce).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=I?j.Buffer:void 0,Je=j.Symbol,tr=j.Uint8Array,fr=De.propertyIsEnumerable,Jr=Oe.splice,rr=Je?Je.toStringTag:void 0,ai=Object.getOwnPropertySymbols,Si=tt?tt.isBuffer:void 0,qi=Fe(Object.keys,Object),Et=wr(j,"DataView"),vt=wr(j,"Map"),Dt=wr(j,"Promise"),St=wr(j,"Set"),mt=wr(j,"WeakMap"),yt=wr(Object,"create"),Ut=ui(Et),Lt=ui(vt),It=ui(Dt),$t=ui(St),xt=ui(mt),Pt=Je?Je.prototype:void 0,Ct=Pt?Pt.valueOf:void 0;function ht(b){var R=-1,X=b==null?0:b.length;for(this.clear();++R<X;){var de=b[R];this.set(de[0],de[1])}}function Mt(){this.__data__=yt?yt(null):{},this.size=0}function jt(b){var R=this.has(b)&&delete this.__data__[b];return this.size-=R?1:0,R}function ca(b){var R=this.__data__;if(yt){var X=R[b];return X===s?void 0:X}return Ce.call(R,b)?R[b]:void 0}function ua(b){var R=this.__data__;return yt?R[b]!==void 0:Ce.call(R,b)}function ha(b,R){var X=this.__data__;return this.size+=this.has(b)?0:1,X[b]=yt&&R===void 0?s:R,this}ht.prototype.clear=Mt,ht.prototype.delete=jt,ht.prototype.get=ca,ht.prototype.has=ua,ht.prototype.set=ha;function Ar(b){var R=-1,X=b==null?0:b.length;for(this.clear();++R<X;){var de=b[R];this.set(de[0],de[1])}}function la(){this.__data__=[],this.size=0}function fa(b){var R=this.__data__,X=zi(R,b);if(X<0)return!1;var de=R.length-1;return X==de?R.pop():Jr.call(R,X,1),--this.size,!0}function da(b){var R=this.__data__,X=zi(R,b);return X<0?void 0:R[X][1]}function pa(b){return zi(this.__data__,b)>-1}function ga(b,R){var X=this.__data__,de=zi(X,b);return de<0?(++this.size,X.push([b,R])):X[de][1]=R,this}Ar.prototype.clear=la,Ar.prototype.delete=fa,Ar.prototype.get=da,Ar.prototype.has=pa,Ar.prototype.set=ga;function ci(b){var R=-1,X=b==null?0:b.length;for(this.clear();++R<X;){var de=b[R];this.set(de[0],de[1])}}function ln(){this.size=0,this.__data__={hash:new ht,map:new(vt||Ar),string:new ht}}function va(b){var R=Ii(this,b).delete(b);return this.size-=R?1:0,R}function fn(b){return Ii(this,b).get(b)}function ya(b){return Ii(this,b).has(b)}function _a(b,R){var X=Ii(this,b),de=X.size;return X.set(b,R),this.size+=X.size==de?0:1,this}ci.prototype.clear=ln,ci.prototype.delete=va,ci.prototype.get=fn,ci.prototype.has=ya,ci.prototype.set=_a;function dn(b){var R=-1,X=b==null?0:b.length;for(this.__data__=new ci;++R<X;)this.add(b[R])}function As(b){return this.__data__.set(b,s),this}function Ns(b){return this.__data__.has(b)}dn.prototype.add=dn.prototype.push=As,dn.prototype.has=Ns;function Br(b){var R=this.__data__=new Ar(b);this.size=R.size}function ma(){this.__data__=new Ar,this.size=0}function ba(b){var R=this.__data__,X=R.delete(b);return this.size=R.size,X}function wa(b){return this.__data__.get(b)}function Ea(b){return this.__data__.has(b)}function Ts(b,R){var X=this.__data__;if(X instanceof Ar){var de=X.__data__;if(!vt||de.length<r-1)return de.push([b,R]),this.size=++X.size,this;X=this.__data__=new ci(de)}return X.set(b,R),this.size=X.size,this}Br.prototype.clear=ma,Br.prototype.delete=ba,Br.prototype.get=wa,Br.prototype.has=Ea,Br.prototype.set=Ts;function Rs(b,R){var X=vn(b),de=!X&&Ks(b),at=!X&&!de&&Bn(b),Ne=!X&&!de&&!at&&Gs(b),ft=X||de||at||Ne,qt=ft?pt(b.length,String):[],Qe=qt.length;for(var ct in b)(R||Ce.call(b,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||qs(ct,Qe)))&&qt.push(ct);return qt}function zi(b,R){for(var X=b.length;X--;)if(ks(b[X][0],R))return X;return-1}function qn(b,R,X){var de=R(b);return vn(b)?de:Ke(de,X(b))}function Bi(b){return b==null?b===void 0?K:ie:rr&&rr in Object(b)?Ms(b):Ia(b)}function zn(b){return ki(b)&&Bi(b)==f}function Hi(b,R,X,de,at){return b===R?!0:b==null||R==null||!ki(b)&&!ki(R)?b!==b&&R!==R:Fs(b,R,X,de,Hi,at)}function Fs(b,R,X,de,at,Ne){var ft=vn(b),qt=vn(R),Qe=ft?g:Qr(b),ct=qt?g:Qr(R);Qe=Qe==f?P:Qe,ct=ct==f?P:ct;var At=Qe==P,dr=ct==P,zt=Qe==ct;if(zt&&Bn(b)){if(!Bn(R))return!1;ft=!0,At=!1}if(zt&&!At)return Ne||(Ne=new Br),ft||Gs(b)?pn(b,R,X,de,at,Ne):Sa(b,R,Qe,X,de,at,Ne);if(!(X&a)){var dt=At&&Ce.call(b,"__wrapped__"),ir=dr&&Ce.call(R,"__wrapped__");if(dt||ir){var Hr=dt?b.value():b,Nr=ir?R.value():R;return Ne||(Ne=new Br),at(Hr,Nr,X,de,Ne)}}return zt?(Ne||(Ne=new Br),$s(b,R,X,de,at,Ne)):!1}function Da(b){if(!Ws(b)||Bs(b))return!1;var R=yn(b)?et:ne;return R.test(ui(b))}function Us(b){return ki(b)&&Vs(b.length)&&!!he[Bi(b)]}function Ls(b){if(!Hs(b))return qi(b);var R=[];for(var X in Object(b))Ce.call(b,X)&&X!="constructor"&&R.push(X);return R}function pn(b,R,X,de,at,Ne){var ft=X&a,qt=b.length,Qe=R.length;if(qt!=Qe&&!(ft&&Qe>qt))return!1;var ct=Ne.get(b);if(ct&&Ne.get(R))return ct==R;var At=-1,dr=!0,zt=X&h?new dn:void 0;for(Ne.set(b,R),Ne.set(R,b);++At<qt;){var dt=b[At],ir=R[At];if(de)var Hr=ft?de(ir,dt,At,R,b,Ne):de(dt,ir,At,b,R,Ne);if(Hr!==void 0){if(Hr)continue;dr=!1;break}if(zt){if(!$e(R,function(Nr,Xr){if(!je(zt,Xr)&&(dt===Nr||at(dt,Nr,X,de,Ne)))return zt.push(Xr)})){dr=!1;break}}else if(!(dt===ir||at(dt,ir,X,de,Ne))){dr=!1;break}}return Ne.delete(b),Ne.delete(R),dr}function Sa(b,R,X,de,at,Ne,ft){switch(X){case ce:if(b.byteLength!=R.byteLength||b.byteOffset!=R.byteOffset)return!1;b=b.buffer,R=R.buffer;case oe:return!(b.byteLength!=R.byteLength||!Ne(new tr(b),new tr(R)));case D:case O:case k:return ks(+b,+R);case $:return b.name==R.name&&b.message==R.message;case x:case c:return b==R+"";case H:var qt=Re;case m:var Qe=de&a;if(qt||(qt=qe),b.size!=R.size&&!Qe)return!1;var ct=ft.get(b);if(ct)return ct==R;de|=h,ft.set(b,R);var At=pn(qt(b),qt(R),de,at,Ne,ft);return ft.delete(b),At;case _:if(Ct)return Ct.call(b)==Ct.call(R)}return!1}function $s(b,R,X,de,at,Ne){var ft=X&a,qt=gn(b),Qe=qt.length,ct=gn(R),At=ct.length;if(Qe!=At&&!ft)return!1;for(var dr=Qe;dr--;){var zt=qt[dr];if(!(ft?zt in R:Ce.call(R,zt)))return!1}var dt=Ne.get(b);if(dt&&Ne.get(R))return dt==R;var ir=!0;Ne.set(b,R),Ne.set(R,b);for(var Hr=ft;++dr<Qe;){zt=qt[dr];var Nr=b[zt],Xr=R[zt];if(de)var Hn=ft?de(Xr,Nr,zt,R,b,Ne):de(Nr,Xr,zt,b,R,Ne);if(!(Hn===void 0?Nr===Xr||at(Nr,Xr,X,de,Ne):Hn)){ir=!1;break}Hr||(Hr=zt=="constructor")}if(ir&&!Hr){var Ki=b.constructor,Kt=R.constructor;Ki!=Kt&&"constructor"in b&&"constructor"in R&&!(typeof Ki=="function"&&Ki instanceof Ki&&typeof Kt=="function"&&Kt instanceof Kt)&&(ir=!1)}return Ne.delete(b),Ne.delete(R),ir}function gn(b){return qn(b,Oa,js)}function Ii(b,R){var X=b.__data__;return zs(R)?X[typeof R=="string"?"string":"hash"]:X.map}function wr(b,R){var X=Ie(b,R);return Da(X)?X:void 0}function Ms(b){var R=Ce.call(b,rr),X=b[rr];try{b[rr]=void 0;var de=!0}catch{}var at=Ge.call(b);return de&&(R?b[rr]=X:delete b[rr]),at}var js=ai?function(b){return b==null?[]:(b=Object(b),Be(ai(b),function(R){return fr.call(b,R)}))}:ot,Qr=Bi;(Et&&Qr(new Et(new ArrayBuffer(1)))!=ce||vt&&Qr(new vt)!=H||Dt&&Qr(Dt.resolve())!=U||St&&Qr(new St)!=m||mt&&Qr(new mt)!=W)&&(Qr=function(b){var R=Bi(b),X=R==P?b.constructor:void 0,de=X?ui(X):"";if(de)switch(de){case Ut:return ce;case Lt:return H;case It:return U;case $t:return m;case xt:return W}return R});function qs(b,R){return R=R??p,!!R&&(typeof b=="number"||be.test(b))&&b>-1&&b%1==0&&b<R}function zs(b){var R=typeof b;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?b!=="__proto__":b===null}function Bs(b){return!!Ve&&Ve in b}function Hs(b){var R=b&&b.constructor,X=typeof R=="function"&&R.prototype||De;return b===X}function Ia(b){return Ge.call(b)}function ui(b){if(b!=null){try{return He.call(b)}catch{}try{return b+""}catch{}}return""}function ks(b,R){return b===R||b!==b&&R!==R}var Ks=zn(function(){return arguments}())?zn:function(b){return ki(b)&&Ce.call(b,"callee")&&!fr.call(b,"callee")},vn=Array.isArray;function xa(b){return b!=null&&Vs(b.length)&&!yn(b)}var Bn=Si||st;function Ca(b,R){return Hi(b,R)}function yn(b){if(!Ws(b))return!1;var R=Bi(b);return R==A||R==M||R==w||R==S}function Vs(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=p}function Ws(b){var R=typeof b;return b!=null&&(R=="object"||R=="function")}function ki(b){return b!=null&&typeof b=="object"}var Gs=Se?gt(Se):Us;function Oa(b){return xa(b)?Rs(b):Ls(b)}function ot(){return[]}function st(){return!1}n.exports=Ca})(D6,Go);function S6(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var h=n.charAt(a),p=h.charCodeAt(0);if(r[p]!==255)throw new TypeError(h+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),w=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function O(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var H=0,k=0,ie=0,P=M.length;ie!==P&&M[ie]===0;)ie++,H++;for(var U=(P-ie)*D+1>>>0,S=new Uint8Array(U);ie!==P;){for(var x=M[ie],m=0,c=U-1;(x!==0||m<k)&&c!==-1;c--,m++)x+=256*S[c]>>>0,S[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");k=m,ie++}for(var _=U-k;_!==U&&S[_]===0;)_++;for(var K=g.repeat(H);_<U;++_)K+=n.charAt(S[_]);return K}function $(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var H=0;if(M[H]!==" "){for(var k=0,ie=0;M[H]===g;)k++,H++;for(var P=(M.length-H)*w+1>>>0,U=new Uint8Array(P);M[H];){var S=r[M.charCodeAt(H)];if(S===255)return;for(var x=0,m=P-1;(S!==0||x<ie)&&m!==-1;m--,x++)S+=f*U[m]>>>0,U[m]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");ie=x,H++}if(M[H]!==" "){for(var c=P-ie;c!==P&&U[c]===0;)c++;for(var _=new Uint8Array(k+(P-c)),K=k;c!==P;)_[K++]=U[c++];return _}}}function A(M){var H=$(M);if(H)return H;throw new Error(`Non-${e} character`)}return{encode:O,decodeUnsafe:$,decode:A}}var I6=S6,x6=I6;const Ep=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},C6=n=>new TextEncoder().encode(n),O6=n=>new TextDecoder().decode(n);class P6{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A6{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Dp(this,e)}}class N6{constructor(e){this.decoders=e}or(e){return Dp(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Dp=(n,e)=>new N6({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class T6{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new P6(e,r,s),this.decoder=new A6(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oa=({name:n,prefix:e,encode:r,decode:s})=>new T6(n,e,r,s),Ps=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:a}=x6(r,e);return oa({prefix:n,name:e,encode:s,decode:h=>Ep(a(h))})},R6=(n,e,r,s)=>{const a={};for(let D=0;D<e.length;++D)a[e[D]]=D;let h=n.length;for(;n[h-1]==="=";)--h;const p=new Uint8Array(h*r/8|0);let f=0,g=0,w=0;for(let D=0;D<h;++D){const O=a[n[D]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|O,f+=r,f>=8&&(f-=8,p[w++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},F6=(n,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let h="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,h+=e[a&f>>p];if(p&&(h+=e[a&f<<r-p]),s)for(;h.length*r&7;)h+="=";return h},Jt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>oa({prefix:e,name:n,encode(a){return F6(a,s,r)},decode(a){return R6(a,s,r,n)}}),U6=oa({prefix:"\0",name:"identity",encode:n=>O6(n),decode:n=>C6(n)});var L6=Object.freeze({__proto__:null,identity:U6});const $6=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var M6=Object.freeze({__proto__:null,base2:$6});const j6=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var q6=Object.freeze({__proto__:null,base8:j6});const z6=Ps({prefix:"9",name:"base10",alphabet:"0123456789"});var B6=Object.freeze({__proto__:null,base10:z6});const H6=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),k6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var K6=Object.freeze({__proto__:null,base16:H6,base16upper:k6});const V6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),W6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),G6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Y6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Q6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),X6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Z6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eD=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tD=Object.freeze({__proto__:null,base32:V6,base32upper:W6,base32pad:G6,base32padupper:Y6,base32hex:J6,base32hexupper:Q6,base32hexpad:X6,base32hexpadupper:Z6,base32z:eD});const rD=Ps({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iD=Ps({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var nD=Object.freeze({__proto__:null,base36:rD,base36upper:iD});const sD=Ps({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),oD=Ps({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var aD=Object.freeze({__proto__:null,base58btc:sD,base58flickr:oD});const cD=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uD=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hD=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lD=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fD=Object.freeze({__proto__:null,base64:cD,base64pad:uD,base64url:hD,base64urlpad:lD});const Sp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),dD=Sp.reduce((n,e,r)=>(n[r]=e,n),[]),pD=Sp.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function gD(n){return n.reduce((e,r)=>(e+=dD[r],e),"")}function vD(n){const e=[];for(const r of n){const s=pD[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const yD=oa({prefix:"🚀",name:"base256emoji",encode:gD,decode:vD});var _D=Object.freeze({__proto__:null,base256emoji:yD}),mD=Ip,Jf=128,bD=127,wD=~bD,ED=Math.pow(2,31);function Ip(n,e,r){e=e||[],r=r||0;for(var s=r;n>=ED;)e[r++]=n&255|Jf,n/=128;for(;n&wD;)e[r++]=n&255|Jf,n>>>=7;return e[r]=n|0,Ip.bytes=r-s+1,e}var DD=_u,SD=128,Qf=127;function _u(n,s){var r=0,s=s||0,a=0,h=s,p,f=n.length;do{if(h>=f)throw _u.bytes=0,new RangeError("Could not decode varint");p=n[h++],r+=a<28?(p&Qf)<<a:(p&Qf)*Math.pow(2,a),a+=7}while(p>=SD);return _u.bytes=h-s,r}var ID=Math.pow(2,7),xD=Math.pow(2,14),CD=Math.pow(2,21),OD=Math.pow(2,28),PD=Math.pow(2,35),AD=Math.pow(2,42),ND=Math.pow(2,49),TD=Math.pow(2,56),RD=Math.pow(2,63),FD=function(n){return n<ID?1:n<xD?2:n<CD?3:n<OD?4:n<PD?5:n<AD?6:n<ND?7:n<TD?8:n<RD?9:10},UD={encode:mD,decode:DD,encodingLength:FD},xp=UD;const Xf=(n,e,r=0)=>(xp.encode(n,e,r),e),Zf=n=>xp.encodingLength(n),mu=(n,e)=>{const r=e.byteLength,s=Zf(n),a=s+Zf(r),h=new Uint8Array(a+r);return Xf(n,h,0),Xf(r,h,s),h.set(e,a),new LD(n,r,e,h)};class LD{constructor(e,r,s,a){this.code=e,this.size=r,this.digest=s,this.bytes=a}}const Cp=({name:n,code:e,encode:r})=>new $D(n,e,r);class $D{constructor(e,r,s){this.name=e,this.code=r,this.encode=s}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?mu(this.code,r):r.then(s=>mu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Op=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),MD=Cp({name:"sha2-256",code:18,encode:Op("SHA-256")}),jD=Cp({name:"sha2-512",code:19,encode:Op("SHA-512")});var qD=Object.freeze({__proto__:null,sha256:MD,sha512:jD});const Pp=0,zD="identity",Ap=Ep,BD=n=>mu(Pp,Ap(n)),HD={code:Pp,name:zD,encode:Ap,digest:BD};var kD=Object.freeze({__proto__:null,identity:HD});new TextEncoder,new TextDecoder;const ed={...L6,...M6,...q6,...B6,...K6,...tD,...nD,...aD,...fD,..._D};({...qD,...kD});function Np(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function KD(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Np(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Tp(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const td=Tp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Kc=Tp("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=KD(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),VD={utf8:td,"utf-8":td,hex:ed.base16,latin1:Kc,ascii:Kc,binary:Kc,...ed};function WD(n,e="utf8"){const r=VD[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Np(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Rp="wc",GD=2,zu="core",Li=`${Rp}@2:${zu}:`,YD={name:zu,logger:"error"},JD={database:":memory:"},QD="crypto",rd="client_ed25519_seed",XD=ye.ONE_DAY,ZD="keychain",e2="0.3",t2="messages",r2="0.3",i2=ye.SIX_HOURS,n2="publisher",Fp="irn",s2="error",Up="wss://relay.walletconnect.com",id="wss://relay.walletconnect.org",o2="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},a2="_subscription",wi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},c2=ye.ONE_SECOND,u2="2.10.0",h2=1e4,l2="0.3",f2="WALLETCONNECT_CLIENT_ID",ni={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},d2="subscription",p2="0.3",g2=ye.FIVE_SECONDS*1e3,v2="pairing",y2="0.3",ls={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},ii={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},_2="history",m2="0.3",b2="expirer",jr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},w2="0.3",Vc="verify-api",zo="https://verify.walletconnect.com",nd="https://verify.walletconnect.org";class E2{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=ZD,this.version=e2,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:h}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,tp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?rp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class D2{constructor(e,r,s){this.core=e,this.logger=r,this.name=QD,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=Bf(a);return pp(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Zw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),p=Bf(h),f=vu();return await t6(f,a,XD,p)},this.generateSharedKey=(a,h,p)=>{this.isInitialized();const f=this.getPrivateKey(a),g=eE(f,h);return this.setSymKey(g,p)},this.setSymKey=async(a,h)=>{this.isInitialized();const p=h||tE(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,p)=>{this.isInitialized();const f=ep(p),g=ws(h);if(vf(f)){const $=f.senderPublicKey,A=f.receiverPublicKey;a=await this.generateSharedKey($,A)}const w=this.getSymKey(a),{type:D,senderPublicKey:O}=f;return iE({type:D,symKey:w,message:g,senderPublicKey:O})},this.decode=async(a,h,p)=>{this.isInitialized();const f=oE(h,p);if(vf(f)){const g=f.receiverPublicKey,w=f.senderPublicKey;a=await this.generateSharedKey(g,w)}try{const g=this.getSymKey(a),w=nE({symKey:g,encoded:h});return Uu(w)}catch(g){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=a=>{const h=ko(a);return Is(h.type)},this.getPayloadSenderPublicKey=a=>{const h=ko(a);return h.senderPublicKey?hr(h.senderPublicKey,ur):void 0},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new E2(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(rd)}catch{e=vu(),await this.keychain.set(rd,e)}return WD(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class S2 extends N3{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=t2,this.version=r2,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const h=Fn(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=a,this.messages.set(s,p),await this.persist()),h},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const h=this.get(s),p=Fn(a);return typeof h[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,tp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?rp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class I2 extends T3{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new lr.EventEmitter,this.name=n2,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,h)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}});try{const f=(h==null?void 0:h.ttl)||i2,g=yu(h),w=(h==null?void 0:h.prompt)||!1,D=(h==null?void 0:h.tag)||0,O=(h==null?void 0:h.id)||mp().toString(),$={topic:s,message:a,opts:{ttl:f,relay:g,prompt:w,tag:D,id:O}},A=setTimeout(()=>this.queue.set(O,$),this.publishTimeout);try{await await bs(this.rpcPublish(s,a,f,g,w,D,O),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(O),this.relayer.events.emit(er.publish,$)}catch(M){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=h==null?void 0:h.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(O),M;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,r,s,a,h,p,f){var g,w,D,O;const $={method:jo(a.protocol).publish,params:{topic:e,message:r,ttl:s,prompt:h,tag:p},id:f};return cr((g=$.params)==null?void 0:g.prompt)&&((w=$.params)==null||delete w.prompt),cr((D=$.params)==null?void 0:D.tag)&&((O=$.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:$}),this.relayer.request($)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:s,opts:a}=e;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(jn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class x2{constructor(){this.map=new Map,this.set=(e,r)=>{const s=this.get(e);this.exists(e,r)||this.map.set(e,[...s,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,r))return;const a=s.filter(h=>h!==r);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var C2=Object.defineProperty,O2=Object.defineProperties,P2=Object.getOwnPropertyDescriptors,sd=Object.getOwnPropertySymbols,A2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable,od=(n,e,r)=>e in n?C2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,fs=(n,e)=>{for(var r in e||(e={}))A2.call(e,r)&&od(n,r,e[r]);if(sd)for(var r of sd(e))N2.call(e,r)&&od(n,r,e[r]);return n},Wc=(n,e)=>O2(n,P2(e));class T2 extends U3{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new x2,this.events=new lr.EventEmitter,this.name=d2,this.version=p2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const h=yu(a),p={topic:s,relay:h};this.pending.set(s,p);const f=await this.rpcSubscribe(s,h);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,h)=>{const p=new ye.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=g2&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let s=!1;try{s=this.getSubscription(e).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,r)))}async unsubscribeById(e,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}});try{const a=yu(s);await this.rpcUnsubscribe(e,r,a);const h=Rt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,r){const s={method:jo(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await bs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return Fn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,s={method:jo(r.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await bs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,r,s){const a={method:jo(s.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,r){this.setSubscription(e,Wc(fs({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,fs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,fs({},r)),this.topicMap.set(r.topic,e),this.events.emit(ni.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(ni.deleted,Wc(fs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ni.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ni.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);oi(r)&&this.onBatchSubscribe(r.map((s,a)=>Wc(fs({},e[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(jn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(ni.created,async e=>{const r=ni.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(ni.deleted,async e=>{const r=ni.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var R2=Object.defineProperty,ad=Object.getOwnPropertySymbols,F2=Object.prototype.hasOwnProperty,U2=Object.prototype.propertyIsEnumerable,cd=(n,e,r)=>e in n?R2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,L2=(n,e)=>{for(var r in e||(e={}))F2.call(e,r)&&cd(n,r,e[r]);if(ad)for(var r of ad(e))U2.call(e,r)&&cd(n,r,e[r]);return n};class $2 extends R3{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new lr.EventEmitter,this.name=o2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(er.error,r)},this.registerProviderListeners=()=>{this.provider.on(wi.payload,this.onPayloadHandler),this.provider.on(wi.connect,this.onConnectHandler),this.provider.on(wi.disconnect,this.onDisconnectHandler),this.provider.on(wi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||s2})),this.messages=new S2(this.logger,e.core),this.subscriber=new T2(this,this.logger),this.publisher=new I2(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Up,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${id}...`),await this.restartTransport(id)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},h2)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,s){this.isInitialized(),await this.publisher.publish(e,r,s),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(h=>{this.subscriber.once(ni.created,p=>{p.topic===e&&h()})}),new Promise(async h=>{a=await this.subscriber.subscribe(e,r),h()})]),a)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await bs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(ni.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await bs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(wi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await xf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Mi(new E6(yE({sdkVersion:u2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:s}=e;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(e){const{topic:r,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),qu(e)){if(!e.method.endsWith(a2))return;const r=e.params,{topic:s,message:a,publishedAt:h}=r.data,p={topic:s,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(L2({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(e),await this.onMessageEvent(p)}else sa(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=ju(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(wi.payload,this.onPayloadHandler),this.provider.off(wi.connect,this.onConnectHandler),this.provider.off(wi.disconnect,this.onDisconnectHandler),this.provider.off(wi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await xf();u3(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ye.toMiliseconds(c2)))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var M2=Object.defineProperty,ud=Object.getOwnPropertySymbols,j2=Object.prototype.hasOwnProperty,q2=Object.prototype.propertyIsEnumerable,hd=(n,e,r)=>e in n?M2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ld=(n,e)=>{for(var r in e||(e={}))j2.call(e,r)&&hd(n,r,e[r]);if(ud)for(var r of ud(e))q2.call(e,r)&&hd(n,r,e[r]);return n};class aa extends F3{constructor(e,r,s,a=Li,h=void 0){super(e,r,s,a),this.core=e,this.logger=r,this.name=s,this.map=new Map,this.version=l2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!cr(p)?this.map.set(this.getKey(p),p):qE(p)?this.map.set(p.id,p):zE(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(g=>Go(f[g],p[g]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const g=ld(ld({},this.getData(p)),f);this.map.set(p,g),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class z2{constructor(e,r){this.core=e,this.logger=r,this.name=v2,this.version=y2,this.events=new lr,this.initialized=!1,this.storagePrefix=Li,this.ignoredPayloadTypes=[cn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=vu(),a=await this.core.crypto.setSymKey(s),h=Gr(ye.FIVE_MINUTES),p={protocol:Fp},f={topic:a,expiry:h,relay:p,active:!1},g=AE({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:h,relay:p}=CE(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Gr(ye.FIVE_MINUTES),g={topic:a,relay:p,expiry:f,active:!1};return await this.pairings.set(a,g),await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),g},this.activate=async({topic:s})=>{this.isInitialized();const a=Gr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:g}=Tn();this.events.once(Bt("pairing_ping",h),({error:w})=>{w?g(w):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Rt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,h)=>{const p=Es(a,h),f=await this.core.crypto.encode(s,p),g=ls[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,g),p.id},this.sendResult=async(s,a,h)=>{const p=ju(s,h),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),w=ls[g.request.method].res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.sendError=async(s,a,h)=>{const p=na(s,h),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),w=ls[g.request.method]?ls[g.request.method].res:ls.unregistered_method.res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Rt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ui(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:h}=s,p=(await this.core.history.get(a,h.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:h}=a;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit("pairing_ping",{id:h,topic:s})}catch(p){await this.sendError(h,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:h}=a;setTimeout(()=>{Di(a)?this.events.emit(Bt("pairing_ping",h),{}):Yr(a)&&this.events.emit(Bt("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:h,topic:s})}catch(p){await this.sendError(h,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:h,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=Rt("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,s,f),this.logger.error(f)}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Rt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!mr(s)){const{message:a}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!jE(s.uri)){const{message:a}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!mr(s)){const{message:h}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!mr(s)){const{message:h}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:a}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ui(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new aa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:r,message:s}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{qu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):sa(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(jr.expired,async e=>{const{topic:r}=np(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class B2 extends A3{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new lr.EventEmitter,this.name=_2,this.version=m2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:h}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:h,expiry:Gr(ye.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(ii.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Yr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(ii.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===s){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(ii.deleted,h)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Es(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ii.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ii.created,e=>{const r=ii.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ii.updated,e=>{const r=ii.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ii.deleted,e=>{const r=ii.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(jn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ye.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class H2 extends L3{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new lr.EventEmitter,this.name=b2,this.version=w2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const h=this.formatTarget(s),p={target:h,expiry:a};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(jr.created,{target:h,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(jr.deleted,{target:a,expiration:h})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return _E(e);if(typeof e=="number")return mE(e);const{message:r}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(e,r){const{expiry:s}=r;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(jr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(jn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(jr.created,e=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.expired,e=>{const r=jr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jr.deleted,e=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class k2 extends $3{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Vc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||ra()||!xs())return;const a=(s==null?void 0:s.verifyUrl)||zo;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=nd;try{await this.createIframe()}catch(h){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=(s==null?void 0:s.verifyUrl)||zo;let h="";try{h=await this.fetchAttestation(s.attestationId,a)}catch(p){this.logger.warn(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.warn(p),h=await this.fetchAttestation(s.attestationId,nd)}return h},this.fetchAttestation=async(s,a)=>{var h;this.logger.info(`resolving attestation: ${s} from url: ${a}`);const p=this.startAbortTimer(ye.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(p),f.status===200?(h=await f.json())==null?void 0:h.origin:""},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(h=>{if(document.getElementById(Vc))return h();window.addEventListener("message",a);const p=document.createElement("iframe");p.id=Vc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,s=h}),new Promise((h,p)=>setTimeout(()=>{window.removeEventListener("message",a),p("verify iframe load timeout")},ye.toMiliseconds(ye.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=zo,this.abortController=new AbortController,this.isDevEnv=Tu()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var K2=Object.defineProperty,fd=Object.getOwnPropertySymbols,V2=Object.prototype.hasOwnProperty,W2=Object.prototype.propertyIsEnumerable,dd=(n,e,r)=>e in n?K2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,pd=(n,e)=>{for(var r in e||(e={}))V2.call(e,r)&&dd(n,r,e[r]);if(fd)for(var r of fd(e))W2.call(e,r)&&dd(n,r,e[r]);return n};class Bu extends P3{constructor(e){super(e),this.protocol=Rp,this.version=GD,this.name=zu,this.events=new lr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Up;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||YD.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new jn.HeartBeat,this.crypto=new D2(this,this.logger,e==null?void 0:e.keychain),this.history=new B2(this,this.logger),this.expirer=new H2(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new b3(pd(pd({},JD),e==null?void 0:e.storageOptions)),this.relayer=new $2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new z2(this,this.logger),this.verify=new k2(this.projectId||"",this.logger)}static async init(e){const r=new Bu(e);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(f2,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const G2=Bu,Lp="wc",$p=2,Mp="client",Hu=`${Lp}@${$p}:${Mp}:`,Gc={name:Mp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},gd="WALLETCONNECT_DEEPLINK_CHOICE",Y2="proposal",jp="Proposal expired",J2="session",Lo=ye.SEVEN_DAYS,Q2="engine",ds={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},Yc={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},Ei={idle:"IDLE",active:"ACTIVE"},X2="request",Z2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var e5=Object.defineProperty,t5=Object.defineProperties,r5=Object.getOwnPropertyDescriptors,vd=Object.getOwnPropertySymbols,i5=Object.prototype.hasOwnProperty,n5=Object.prototype.propertyIsEnumerable,yd=(n,e,r)=>e in n?e5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,_r=(n,e)=>{for(var r in e||(e={}))i5.call(e,r)&&yd(n,r,e[r]);if(vd)for(var r of vd(e))n5.call(e,r)&&yd(n,r,e[r]);return n},ps=(n,e)=>t5(n,r5(e));class s5 extends j3{constructor(e){super(e),this.name=Q2,this.events=new lr,this.initialized=!1,this.ignoredPayloadTypes=[cn],this.requestQueue={state:Ei.idle,queue:[]},this.sessionRequestQueue={state:Ei.idle,queue:[]},this.requestQueueDelay=ye.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ds)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=ps(_r({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:f,relays:g}=s;let w=a,D,O=!1;if(w&&(O=this.client.core.pairing.pairings.get(w).active),!w||!O){const{topic:U,uri:S}=await this.client.core.pairing.create();w=U,D=S}const $=await this.client.core.crypto.generateKeyPair(),A=_r({requiredNamespaces:h,optionalNamespaces:p,relays:g??[{protocol:Fp}],proposer:{publicKey:$,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:M,resolve:H,done:k}=Tn(ye.FIVE_MINUTES,jp);if(this.events.once(Bt("session_connect"),async({error:U,session:S})=>{if(U)M(U);else if(S){S.self.publicKey=$;const x=ps(_r({},S),{requiredNamespaces:S.requiredNamespaces,optionalNamespaces:S.optionalNamespaces});await this.client.session.set(S.topic,x),await this.setExpiry(S.topic,S.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:S.peer.metadata}),H(x)}}),!w){const{message:U}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(U)}const ie=await this.sendRequest({topic:w,method:"wc_sessionPropose",params:A}),P=Gr(ye.FIVE_MINUTES);return await this.setProposal(ie,_r({id:ie,expiry:P},A)),{uri:D,approval:k}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:h,sessionProperties:p}=r,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:w,requiredNamespaces:D,optionalNamespaces:O}=f;g=g||"",Un(D)||(D=FE(h,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),A=w.publicKey,M=await this.client.core.crypto.generateSharedKey($,A);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:w.metadata}),await this.sendResult({id:s,topic:g,result:{relay:{protocol:a??"irn"},responderPublicKey:$}}),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const H=_r({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:D,optionalNamespaces:O,pairingTopic:g,controller:{publicKey:$,metadata:this.client.metadata},expiry:Gr(Lo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(M),await this.sendRequest({topic:M,method:"wc_sessionSettle",params:H,throwOnFailedPublish:!0});const k=ps(_r({},H),{topic:M,pairingTopic:g,acknowledged:!1,self:H.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:$});return await this.client.session.set(M,k),await this.setExpiry(M,Gr(Lo)),{topic:M,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(M)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,a),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:p,resolve:f,reject:g}=Tn();return this.events.once(Bt("session_update",h),({error:w})=>{w?g(w):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:p,reject:f}=Tn();return this.events.once(Bt("session_extend",a),({error:g})=>{g?f(g):p()}),await this.setExpiry(s,Gr(Lo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:h,expiry:p}=r,f=Mu(),{done:g,resolve:w,reject:D}=Tn(p);return this.events.once(Bt("session_request",f),({error:O,result:$})=>{O?D(O):w($)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:f,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:p,throwOnFailedPublish:!0}).catch($=>D($)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:s,id:f}),O()}),new Promise(async O=>{const $=await this.client.core.storage.getItem(gd);bE({id:f,topic:h,wcDeepLink:$}),O()}),g()]).then(O=>O[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:h}=a;Di(a)?await this.sendResult({id:h,topic:s,result:a.result,throwOnFailedPublish:!0}):Yr(a)&&await this.sendError(h,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:p,reject:f}=Tn();this.events.once(Bt("session_ping",a),({error:g})=>{g?f(g):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:h}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Rt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>$E(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var p,f;return((p=h.peerMetadata)==null?void 0:p.url)&&((f=h.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(gd).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Rt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=Ei.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ds.wc_sessionRequest.req.ttl,{id:a,topic:h,params:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:p}),s&&this.client.core.expirer.set(a,Gr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:h,expiry:p,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:w}=r,D=Es(a,h,g);if(xs()&&Z2.includes(a)){const A=Fn(JSON.stringify(D));this.client.core.verify.register({attestationId:A})}const O=await this.client.core.crypto.encode(s,D),$=ds[a].req;return p&&($.ttl=p),f&&($.id=f),this.client.core.history.set(s,D),w?($.internal=ps(_r({},$.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,O,$)):this.client.core.relayer.publish(s,O,$).catch(A=>this.client.logger.error(A)),D.id},this.sendResult=async r=>{const{id:s,topic:a,result:h,throwOnFailedPublish:p}=r,f=ju(s,h),g=await this.client.core.crypto.encode(a,f),w=await this.client.core.history.get(a,s),D=ds[w.request.method].res;p?(D.internal=ps(_r({},D.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,g,D)):this.client.core.relayer.publish(a,g,D).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(f)},this.sendError=async(r,s,a)=>{const h=na(r,a),p=await this.client.core.crypto.encode(s,h),f=await this.client.core.history.get(s,r),g=ds[f.request.method].res;this.client.core.relayer.publish(s,p,g),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ui(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ui(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Ei.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ei.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Ei.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,h=(await this.client.core.history.get(s,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:h}=s;try{this.isValidConnect(_r({},s.params));const p=Gr(ye.FIVE_MINUTES),f=_r({id:h,pairingTopic:r,expiry:p},a);await this.setProposal(h,f);const g=Fn(JSON.stringify(s)),w=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:f,verifyContext:w})}catch(p){await this.sendError(h,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(Di(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const w=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const D=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:D}),await this.client.core.pairing.activate({topic:r})}else Yr(s)&&(await this.client.proposal.delete(a,Rt("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:f,expiry:g,namespaces:w,requiredNamespaces:D,optionalNamespaces:O,sessionProperties:$,pairingTopic:A}=s.params,M=_r({topic:r,relay:p,expiry:g,namespaces:w,acknowledged:!0,pairingTopic:A,requiredNamespaces:D,optionalNamespaces:O,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},$&&{sessionProperties:$});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Bt("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;Di(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",a),{})):Yr(s)&&(await this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:h}=s;try{const p=`${r}_session_update`,f=Uo.get(p);if(f&&this.isRequestOutOfSync(f,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(_r({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),Uo.set(p,h)}catch(p){await this.sendError(h,r,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;Di(s)?this.events.emit(Bt("session_update",a),{}):Yr(s)&&this.events.emit(Bt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Gr(Lo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;Di(s)?this.events.emit(Bt("session_extend",a),{}):Yr(s)&&this.events.emit(Bt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{Di(s)?this.events.emit(Bt("session_ping",a),{}):Yr(s)&&this.events.emit(Bt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(er.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidRequest(_r({topic:r},h)),await this.setPendingSessionRequest({id:a,topic:r,params:h}),this.addSessionRequestToSessionRequestQueue({id:a,topic:r,params:h}),await this.processSessionRequestQueue()}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;Di(s)?this.events.emit(Bt("session_request",a),{result:s.result}):Yr(s)&&this.events.emit(Bt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:h}=s;try{const p=`${r}_session_event_${h.event.name}`,f=Uo.get(p);if(f&&this.isRequestOutOfSync(f,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(_r({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),Uo.set(p,a)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ei.idle,this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===Ei.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:a,params:h}=r,p=Fn(JSON.stringify(Es("wc_sessionRequest",h,s))),f=this.client.session.get(a),g=await this.getVerifyContext(p,f.peer.metadata);this.sessionRequestQueue.state=Ei.active,this.client.events.emit("session_request",{id:s,topic:a,params:h,verifyContext:g})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async r=>{if(!mr(r)){const{message:g}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:p,relays:f}=r;if(cr(s)||await this.isValidPairingTopic(s),!YE(f,!0)){const{message:g}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!cr(a)&&Un(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!cr(h)&&Un(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),cr(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=GE(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!mr(r))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:h,sessionProperties:p}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=qo(a,"approve()");if(g)throw new Error(g.message);const w=Sf(f.requiredNamespaces,a,"approve()");if(w)throw new Error(w.message);if(!Wt(h,!0)){const{message:D}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(D)}cr(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!mr(r)){const{message:h}=ue("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!QE(a)){const{message:h}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!mr(r)){const{message:w}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:s,controller:a,namespaces:h,expiry:p}=r;if(!op(s)){const{message:w}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const f=BE(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=qo(h,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Ui(p)){const{message:w}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!mr(r)){const{message:g}=ue("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(g)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const h=this.client.session.get(s),p=qo(a,"update()");if(p)throw new Error(p.message);const f=Sf(h.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!mr(r)){const{message:a}=ue("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!mr(r)){const{message:g}=ue("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(g)}const{topic:s,request:a,chainId:h,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Df(f,h)){const{message:g}=ue("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(g)}if(!XE(a)){const{message:g}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(g)}if(!t3(f,h,a.method)){const{message:g}=ue("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(g)}if(p&&!s3(p,Yc)){const{message:g}=ue("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Yc.min} and ${Yc.max}`);throw new Error(g)}},this.isValidRespond=async r=>{if(!mr(r)){const{message:h}=ue("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!ZE(a)){const{message:h}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!mr(r)){const{message:a}=ue("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!mr(r)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:a,chainId:h}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!Df(p,h)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(f)}if(!e3(a)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!r3(p,h,a.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!mr(r)){const{message:a}=ue("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||zo,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});h&&(a.verified.origin=h,a.verified.validation=h===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Wt(a,!1)){const{message:h}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{qu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):sa(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(jr.expired,async e=>{const{topic:r,id:s}=np(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:r}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:r}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=ue("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:r}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!JE(e)){const{message:r}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class o5 extends aa{constructor(e,r){super(e,r,Y2,Hu),this.core=e,this.logger=r}}class a5 extends aa{constructor(e,r){super(e,r,J2,Hu),this.core=e,this.logger=r}}class c5 extends aa{constructor(e,r){super(e,r,X2,Hu,s=>s.id),this.core=e,this.logger=r}}let qp=class extends M3{constructor(e){super(e),this.protocol=Lp,this.version=$p,this.name=Gc.name,this.events=new lr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Gc.name,this.metadata=(e==null?void 0:e.metadata)||dE();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Gc.logger}));this.core=(e==null?void 0:e.core)||new G2(e),this.logger=Ze.generateChildLogger(r,this.name),this.session=new a5(this.core,this.logger),this.proposal=new o5(this.core,this.logger),this.pendingRequest=new c5(this.core,this.logger),this.engine=new s5(this)}static async init(e){const r=new qp(e);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const u5={Accept:"application/json","Content-Type":"application/json"},h5="POST",_d={headers:u5,method:h5},md=10;class hn{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Vf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const s=ws(e),h=await(await Vl(this.url,Object.assign(Object.assign({},_d),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Vf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=ws({id:1,jsonrpc:"2.0",method:"test",params:[]});await Vl(e,Object.assign(Object.assign({},_d),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Uu(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),h=na(e,a);this.events.emit("payload",h)}parseError(e,r=this.url){return yp(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>md&&this.events.setMaxListeners(md)}}const bd="error",l5="wss://relay.walletconnect.com",f5="wc",d5="universal_provider",wd=`${f5}@2:${d5}:`,p5="https://rpc.walletconnect.com/v1",ji={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof wt<"u"?wt:typeof self<"u"?self:{},bu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var r,s="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",w=500,D="__lodash_placeholder__",O=1,$=2,A=4,M=1,H=2,k=1,ie=2,P=4,U=8,S=16,x=32,m=64,c=128,_=256,K=512,W=30,oe="...",ce=800,ge=16,T=1,z=2,le=3,te=1/0,G=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ne=re>>>1,be=[["ary",c],["bind",k],["bindKey",ie],["curry",U],["curryRight",S],["flip",K],["partial",x],["partialRight",m],["rearg",_]],he="[object Arguments]",_e="[object Array]",q="[object AsyncFunction]",j="[object Boolean]",N="[object Date]",l="[object DOMException]",I="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Se="[object Map]",Be="[object Number]",Ke="[object Null]",$e="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",Ie="[object Set]",Re="[object String]",Fe="[object Symbol]",qe="[object Undefined]",Oe="[object WeakMap]",Ue="[object WeakSet]",De="[object ArrayBuffer]",Pe="[object DataView]",He="[object Float32Array]",Ce="[object Float64Array]",Ve="[object Int8Array]",Ge="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",tr="[object Uint16Array]",fr="[object Uint32Array]",Jr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,ai=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Si=/&(?:amp|lt|gt|quot|#39);/g,qi=/[&<>"']/g,Et=RegExp(Si.source),vt=RegExp(qi.source),Dt=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,$t=RegExp(It.source),xt=/^\s+/,Pt=/\s/,Ct=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ca=/[()=,{}\[\]\/\s]/,ua=/\\(\\)?/g,ha=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ar=/\w*$/,la=/^[-+]0x[0-9a-f]+$/i,fa=/^0b[01]+$/i,da=/^\[object .+?Constructor\]$/,pa=/^0o[0-7]+$/i,ga=/^(?:0|[1-9]\d*)$/,ci=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ln=/($^)/,va=/['\n\r\u2028\u2029\\]/g,fn="\\ud800-\\udfff",ya="\\u0300-\\u036f",_a="\\ufe20-\\ufe2f",dn="\\u20d0-\\u20ff",As=ya+_a+dn,Ns="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",ma="\\xac\\xb1\\xd7\\xf7",ba="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wa="\\u2000-\\u206f",Ea=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ts="A-Z\\xc0-\\xd6\\xd8-\\xde",Rs="\\ufe0e\\ufe0f",zi=ma+ba+wa+Ea,qn="['’]",Bi="["+fn+"]",zn="["+zi+"]",Hi="["+As+"]",Fs="\\d+",Da="["+Ns+"]",Us="["+Br+"]",Ls="[^"+fn+zi+Fs+Ns+Br+Ts+"]",pn="\\ud83c[\\udffb-\\udfff]",Sa="(?:"+Hi+"|"+pn+")",$s="[^"+fn+"]",gn="(?:\\ud83c[\\udde6-\\uddff]){2}",Ii="[\\ud800-\\udbff][\\udc00-\\udfff]",wr="["+Ts+"]",Ms="\\u200d",js="(?:"+Us+"|"+Ls+")",Qr="(?:"+wr+"|"+Ls+")",qs="(?:"+qn+"(?:d|ll|m|re|s|t|ve))?",zs="(?:"+qn+"(?:D|LL|M|RE|S|T|VE))?",Bs=Sa+"?",Hs="["+Rs+"]?",Ia="(?:"+Ms+"(?:"+[$s,gn,Ii].join("|")+")"+Hs+Bs+")*",ui="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ks="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ks=Hs+Bs+Ia,vn="(?:"+[Da,gn,Ii].join("|")+")"+Ks,xa="(?:"+[$s+Hi+"?",Hi,gn,Ii,Bi].join("|")+")",Bn=RegExp(qn,"g"),Ca=RegExp(Hi,"g"),yn=RegExp(pn+"(?="+pn+")|"+xa+Ks,"g"),Vs=RegExp([wr+"?"+Us+"+"+qs+"(?="+[zn,wr,"$"].join("|")+")",Qr+"+"+zs+"(?="+[zn,wr+js,"$"].join("|")+")",wr+"?"+js+"+"+qs,wr+"+"+zs,ks,ui,Fs,vn].join("|"),"g"),Ws=RegExp("["+Ms+fn+As+Rs+"]"),ki=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Oa=-1,ot={};ot[He]=ot[Ce]=ot[Ve]=ot[Ge]=ot[et]=ot[tt]=ot[Je]=ot[tr]=ot[fr]=!0,ot[he]=ot[_e]=ot[De]=ot[j]=ot[Pe]=ot[N]=ot[I]=ot[se]=ot[Se]=ot[Be]=ot[$e]=ot[je]=ot[Ie]=ot[Re]=ot[Oe]=!1;var st={};st[he]=st[_e]=st[De]=st[Pe]=st[j]=st[N]=st[He]=st[Ce]=st[Ve]=st[Ge]=st[et]=st[Se]=st[Be]=st[$e]=st[je]=st[Ie]=st[Re]=st[Fe]=st[tt]=st[Je]=st[tr]=st[fr]=!0,st[I]=st[se]=st[Oe]=!1;var b={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ne=parseInt,ft=typeof gs=="object"&&gs&&gs.Object===Object&&gs,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=ft||qt||Function("return this")(),ct=e&&!e.nodeType&&e,At=ct&&!0&&n&&!n.nodeType&&n,dr=At&&At.exports===ct,zt=dr&&ft.process,dt=function(){try{var F=At&&At.require&&At.require("util").types;return F||zt&&zt.binding&&zt.binding("util")}catch{}}(),ir=dt&&dt.isArrayBuffer,Hr=dt&&dt.isDate,Nr=dt&&dt.isMap,Xr=dt&&dt.isRegExp,Hn=dt&&dt.isSet,Ki=dt&&dt.isTypedArray;function Kt(F,V,B){switch(B.length){case 0:return F.call(V);case 1:return F.call(V,B[0]);case 2:return F.call(V,B[0],B[1]);case 3:return F.call(V,B[0],B[1],B[2])}return F.apply(V,B)}function Hp(F,V,B,pe){for(var Ae=-1,rt=F==null?0:F.length;++Ae<rt;){var Ht=F[Ae];V(pe,Ht,B(Ht),F)}return pe}function Tr(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe&&V(F[B],B,F)!==!1;);return F}function kp(F,V){for(var B=F==null?0:F.length;B--&&V(F[B],B,F)!==!1;);return F}function Vu(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe;)if(!V(F[B],B,F))return!1;return!0}function xi(F,V){for(var B=-1,pe=F==null?0:F.length,Ae=0,rt=[];++B<pe;){var Ht=F[B];V(Ht,B,F)&&(rt[Ae++]=Ht)}return rt}function Ys(F,V){var B=F==null?0:F.length;return!!B&&_n(F,V,0)>-1}function Pa(F,V,B){for(var pe=-1,Ae=F==null?0:F.length;++pe<Ae;)if(B(V,F[pe]))return!0;return!1}function _t(F,V){for(var B=-1,pe=F==null?0:F.length,Ae=Array(pe);++B<pe;)Ae[B]=V(F[B],B,F);return Ae}function Ci(F,V){for(var B=-1,pe=V.length,Ae=F.length;++B<pe;)F[Ae+B]=V[B];return F}function Aa(F,V,B,pe){var Ae=-1,rt=F==null?0:F.length;for(pe&&rt&&(B=F[++Ae]);++Ae<rt;)B=V(B,F[Ae],Ae,F);return B}function Kp(F,V,B,pe){var Ae=F==null?0:F.length;for(pe&&Ae&&(B=F[--Ae]);Ae--;)B=V(B,F[Ae],Ae,F);return B}function Na(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe;)if(V(F[B],B,F))return!0;return!1}var Vp=Ta("length");function Wp(F){return F.split("")}function Gp(F){return F.match(jt)||[]}function Wu(F,V,B){var pe;return B(F,function(Ae,rt,Ht){if(V(Ae,rt,Ht))return pe=rt,!1}),pe}function Js(F,V,B,pe){for(var Ae=F.length,rt=B+(pe?1:-1);pe?rt--:++rt<Ae;)if(V(F[rt],rt,F))return rt;return-1}function _n(F,V,B){return V===V?og(F,V,B):Js(F,Gu,B)}function Yp(F,V,B,pe){for(var Ae=B-1,rt=F.length;++Ae<rt;)if(pe(F[Ae],V))return Ae;return-1}function Gu(F){return F!==F}function Yu(F,V){var B=F==null?0:F.length;return B?Fa(F,V)/B:Y}function Ta(F){return function(V){return V==null?r:V[F]}}function Ra(F){return function(V){return F==null?r:F[V]}}function Ju(F,V,B,pe,Ae){return Ae(F,function(rt,Ht,ut){B=pe?(pe=!1,rt):V(B,rt,Ht,ut)}),B}function Jp(F,V){var B=F.length;for(F.sort(V);B--;)F[B]=F[B].value;return F}function Fa(F,V){for(var B,pe=-1,Ae=F.length;++pe<Ae;){var rt=V(F[pe]);rt!==r&&(B=B===r?rt:B+rt)}return B}function Ua(F,V){for(var B=-1,pe=Array(F);++B<F;)pe[B]=V(B);return pe}function Qp(F,V){return _t(V,function(B){return[B,F[B]]})}function Qu(F){return F&&F.slice(0,th(F)+1).replace(xt,"")}function Er(F){return function(V){return F(V)}}function La(F,V){return _t(V,function(B){return F[B]})}function kn(F,V){return F.has(V)}function Xu(F,V){for(var B=-1,pe=F.length;++B<pe&&_n(V,F[B],0)>-1;);return B}function Zu(F,V){for(var B=F.length;B--&&_n(V,F[B],0)>-1;);return B}function Xp(F,V){for(var B=F.length,pe=0;B--;)F[B]===V&&++pe;return pe}var Zp=Ra(b),eg=Ra(R);function tg(F){return"\\"+de[F]}function rg(F,V){return F==null?r:F[V]}function mn(F){return Ws.test(F)}function ig(F){return ki.test(F)}function ng(F){for(var V,B=[];!(V=F.next()).done;)B.push(V.value);return B}function $a(F){var V=-1,B=Array(F.size);return F.forEach(function(pe,Ae){B[++V]=[Ae,pe]}),B}function eh(F,V){return function(B){return F(V(B))}}function Oi(F,V){for(var B=-1,pe=F.length,Ae=0,rt=[];++B<pe;){var Ht=F[B];(Ht===V||Ht===D)&&(F[B]=D,rt[Ae++]=B)}return rt}function Qs(F){var V=-1,B=Array(F.size);return F.forEach(function(pe){B[++V]=pe}),B}function sg(F){var V=-1,B=Array(F.size);return F.forEach(function(pe){B[++V]=[pe,pe]}),B}function og(F,V,B){for(var pe=B-1,Ae=F.length;++pe<Ae;)if(F[pe]===V)return pe;return-1}function ag(F,V,B){for(var pe=B+1;pe--;)if(F[pe]===V)return pe;return pe}function bn(F){return mn(F)?ug(F):Vp(F)}function kr(F){return mn(F)?hg(F):Wp(F)}function th(F){for(var V=F.length;V--&&Pt.test(F.charAt(V)););return V}var cg=Ra(X);function ug(F){for(var V=yn.lastIndex=0;yn.test(F);)++V;return V}function hg(F){return F.match(yn)||[]}function lg(F){return F.match(Vs)||[]}var fg=function F(V){V=V==null?Qe:wn.defaults(Qe.Object(),V,wn.pick(Qe,Gs));var B=V.Array,pe=V.Date,Ae=V.Error,rt=V.Function,Ht=V.Math,ut=V.Object,Ma=V.RegExp,dg=V.String,Rr=V.TypeError,Xs=B.prototype,pg=rt.prototype,En=ut.prototype,Zs=V["__core-js_shared__"],eo=pg.toString,nt=En.hasOwnProperty,gg=0,rh=function(){var t=/[^.]+$/.exec(Zs&&Zs.keys&&Zs.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),to=En.toString,vg=eo.call(ut),yg=Qe._,_g=Ma("^"+eo.call(nt).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ro=dr?V.Buffer:r,Pi=V.Symbol,io=V.Uint8Array,ih=ro?ro.allocUnsafe:r,no=eh(ut.getPrototypeOf,ut),nh=ut.create,sh=En.propertyIsEnumerable,so=Xs.splice,oh=Pi?Pi.isConcatSpreadable:r,Kn=Pi?Pi.iterator:r,Vi=Pi?Pi.toStringTag:r,oo=function(){try{var t=Qi(ut,"defineProperty");return t({},"",{}),t}catch{}}(),mg=V.clearTimeout!==Qe.clearTimeout&&V.clearTimeout,bg=pe&&pe.now!==Qe.Date.now&&pe.now,wg=V.setTimeout!==Qe.setTimeout&&V.setTimeout,ao=Ht.ceil,co=Ht.floor,ja=ut.getOwnPropertySymbols,Eg=ro?ro.isBuffer:r,ah=V.isFinite,Dg=Xs.join,Sg=eh(ut.keys,ut),kt=Ht.max,Qt=Ht.min,Ig=pe.now,xg=V.parseInt,ch=Ht.random,Cg=Xs.reverse,qa=Qi(V,"DataView"),Vn=Qi(V,"Map"),za=Qi(V,"Promise"),Dn=Qi(V,"Set"),Wn=Qi(V,"WeakMap"),Gn=Qi(ut,"create"),uo=Wn&&new Wn,Sn={},Og=Xi(qa),Pg=Xi(Vn),Ag=Xi(za),Ng=Xi(Dn),Tg=Xi(Wn),ho=Pi?Pi.prototype:r,Yn=ho?ho.valueOf:r,uh=ho?ho.toString:r;function v(t){if(Ot(t)&&!Te(t)&&!(t instanceof Ye)){if(t instanceof Fr)return t;if(nt.call(t,"__wrapped__"))return hl(t)}return new Fr(t)}var In=function(){function t(){}return function(i){if(!bt(i))return{};if(nh)return nh(i);t.prototype=i;var o=new t;return t.prototype=r,o}}();function lo(){}function Fr(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}v.templateSettings={escape:Dt,evaluate:St,interpolate:mt,variable:"",imports:{_:v}},v.prototype=lo.prototype,v.prototype.constructor=v,Fr.prototype=In(lo.prototype),Fr.prototype.constructor=Fr;function Ye(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Rg(){var t=new Ye(this.__wrapped__);return t.__actions__=pr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=pr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=pr(this.__views__),t}function Fg(){if(this.__filtered__){var t=new Ye(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Ug(){var t=this.__wrapped__.value(),i=this.__dir__,o=Te(t),u=i<0,d=o?t.length:0,y=W0(0,d,this.__views__),E=y.start,C=y.end,L=C-E,J=u?C:E-1,Q=this.__iteratees__,Z=Q.length,ae=0,ve=Qt(L,this.__takeCount__);if(!o||!u&&d==L&&ve==L)return Rh(t,this.__actions__);var we=[];e:for(;L--&&ae<ve;){J+=i;for(var ze=-1,Ee=t[J];++ze<Z;){var We=Q[ze],Xe=We.iteratee,Ir=We.type,or=Xe(Ee);if(Ir==z)Ee=or;else if(!or){if(Ir==T)continue e;break e}}we[ae++]=Ee}return we}Ye.prototype=In(lo.prototype),Ye.prototype.constructor=Ye;function Wi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function Lg(){this.__data__=Gn?Gn(null):{},this.size=0}function $g(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function Mg(t){var i=this.__data__;if(Gn){var o=i[t];return o===g?r:o}return nt.call(i,t)?i[t]:r}function jg(t){var i=this.__data__;return Gn?i[t]!==r:nt.call(i,t)}function qg(t,i){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=Gn&&i===r?g:i,this}Wi.prototype.clear=Lg,Wi.prototype.delete=$g,Wi.prototype.get=Mg,Wi.prototype.has=jg,Wi.prototype.set=qg;function hi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function zg(){this.__data__=[],this.size=0}function Bg(t){var i=this.__data__,o=fo(i,t);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():so.call(i,o,1),--this.size,!0}function Hg(t){var i=this.__data__,o=fo(i,t);return o<0?r:i[o][1]}function kg(t){return fo(this.__data__,t)>-1}function Kg(t,i){var o=this.__data__,u=fo(o,t);return u<0?(++this.size,o.push([t,i])):o[u][1]=i,this}hi.prototype.clear=zg,hi.prototype.delete=Bg,hi.prototype.get=Hg,hi.prototype.has=kg,hi.prototype.set=Kg;function li(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function Vg(){this.size=0,this.__data__={hash:new Wi,map:new(Vn||hi),string:new Wi}}function Wg(t){var i=Io(this,t).delete(t);return this.size-=i?1:0,i}function Gg(t){return Io(this,t).get(t)}function Yg(t){return Io(this,t).has(t)}function Jg(t,i){var o=Io(this,t),u=o.size;return o.set(t,i),this.size+=o.size==u?0:1,this}li.prototype.clear=Vg,li.prototype.delete=Wg,li.prototype.get=Gg,li.prototype.has=Yg,li.prototype.set=Jg;function Gi(t){var i=-1,o=t==null?0:t.length;for(this.__data__=new li;++i<o;)this.add(t[i])}function Qg(t){return this.__data__.set(t,g),this}function Xg(t){return this.__data__.has(t)}Gi.prototype.add=Gi.prototype.push=Qg,Gi.prototype.has=Xg;function Kr(t){var i=this.__data__=new hi(t);this.size=i.size}function Zg(){this.__data__=new hi,this.size=0}function e0(t){var i=this.__data__,o=i.delete(t);return this.size=i.size,o}function t0(t){return this.__data__.get(t)}function r0(t){return this.__data__.has(t)}function i0(t,i){var o=this.__data__;if(o instanceof hi){var u=o.__data__;if(!Vn||u.length<a-1)return u.push([t,i]),this.size=++o.size,this;o=this.__data__=new li(u)}return o.set(t,i),this.size=o.size,this}Kr.prototype.clear=Zg,Kr.prototype.delete=e0,Kr.prototype.get=t0,Kr.prototype.has=r0,Kr.prototype.set=i0;function hh(t,i){var o=Te(t),u=!o&&Zi(t),d=!o&&!u&&Fi(t),y=!o&&!u&&!d&&Pn(t),E=o||u||d||y,C=E?Ua(t.length,dg):[],L=C.length;for(var J in t)(i||nt.call(t,J))&&!(E&&(J=="length"||d&&(J=="offset"||J=="parent")||y&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||gi(J,L)))&&C.push(J);return C}function lh(t){var i=t.length;return i?t[Xa(0,i-1)]:r}function n0(t,i){return xo(pr(t),Yi(i,0,t.length))}function s0(t){return xo(pr(t))}function Ba(t,i,o){(o!==r&&!Vr(t[i],o)||o===r&&!(i in t))&&fi(t,i,o)}function Jn(t,i,o){var u=t[i];(!(nt.call(t,i)&&Vr(u,o))||o===r&&!(i in t))&&fi(t,i,o)}function fo(t,i){for(var o=t.length;o--;)if(Vr(t[o][0],i))return o;return-1}function o0(t,i,o,u){return Ai(t,function(d,y,E){i(u,d,o(d),E)}),u}function fh(t,i){return t&&ei(i,Vt(i),t)}function a0(t,i){return t&&ei(i,vr(i),t)}function fi(t,i,o){i=="__proto__"&&oo?oo(t,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[i]=o}function Ha(t,i){for(var o=-1,u=i.length,d=B(u),y=t==null;++o<u;)d[o]=y?r:Dc(t,i[o]);return d}function Yi(t,i,o){return t===t&&(o!==r&&(t=t<=o?t:o),i!==r&&(t=t>=i?t:i)),t}function Ur(t,i,o,u,d,y){var E,C=i&O,L=i&$,J=i&A;if(o&&(E=d?o(t,u,d,y):o(t)),E!==r)return E;if(!bt(t))return t;var Q=Te(t);if(Q){if(E=Y0(t),!C)return pr(t,E)}else{var Z=Xt(t),ae=Z==se||Z==fe;if(Fi(t))return Lh(t,C);if(Z==$e||Z==he||ae&&!d){if(E=L||ae?{}:tl(t),!C)return L?M0(t,a0(E,t)):$0(t,fh(E,t))}else{if(!st[Z])return d?t:{};E=J0(t,Z,C)}}y||(y=new Kr);var ve=y.get(t);if(ve)return ve;y.set(t,E),Al(t)?t.forEach(function(Ee){E.add(Ur(Ee,i,o,Ee,t,y))}):Ol(t)&&t.forEach(function(Ee,We){E.set(We,Ur(Ee,i,o,We,t,y))});var we=J?L?uc:cc:L?vr:Vt,ze=Q?r:we(t);return Tr(ze||t,function(Ee,We){ze&&(We=Ee,Ee=t[We]),Jn(E,We,Ur(Ee,i,o,We,t,y))}),E}function c0(t){var i=Vt(t);return function(o){return dh(o,t,i)}}function dh(t,i,o){var u=o.length;if(t==null)return!u;for(t=ut(t);u--;){var d=o[u],y=i[d],E=t[d];if(E===r&&!(d in t)||!y(E))return!1}return!0}function ph(t,i,o){if(typeof t!="function")throw new Rr(p);return is(function(){t.apply(r,o)},i)}function Qn(t,i,o,u){var d=-1,y=Ys,E=!0,C=t.length,L=[],J=i.length;if(!C)return L;o&&(i=_t(i,Er(o))),u?(y=Pa,E=!1):i.length>=a&&(y=kn,E=!1,i=new Gi(i));e:for(;++d<C;){var Q=t[d],Z=o==null?Q:o(Q);if(Q=u||Q!==0?Q:0,E&&Z===Z){for(var ae=J;ae--;)if(i[ae]===Z)continue e;L.push(Q)}else y(i,Z,u)||L.push(Q)}return L}var Ai=zh(Zr),gh=zh(Ka,!0);function u0(t,i){var o=!0;return Ai(t,function(u,d,y){return o=!!i(u,d,y),o}),o}function po(t,i,o){for(var u=-1,d=t.length;++u<d;){var y=t[u],E=i(y);if(E!=null&&(C===r?E===E&&!Sr(E):o(E,C)))var C=E,L=y}return L}function h0(t,i,o,u){var d=t.length;for(o=Me(o),o<0&&(o=-o>d?0:d+o),u=u===r||u>d?d:Me(u),u<0&&(u+=d),u=o>u?0:Tl(u);o<u;)t[o++]=i;return t}function vh(t,i){var o=[];return Ai(t,function(u,d,y){i(u,d,y)&&o.push(u)}),o}function Gt(t,i,o,u,d){var y=-1,E=t.length;for(o||(o=X0),d||(d=[]);++y<E;){var C=t[y];i>0&&o(C)?i>1?Gt(C,i-1,o,u,d):Ci(d,C):u||(d[d.length]=C)}return d}var ka=Bh(),yh=Bh(!0);function Zr(t,i){return t&&ka(t,i,Vt)}function Ka(t,i){return t&&yh(t,i,Vt)}function go(t,i){return xi(i,function(o){return vi(t[o])})}function Ji(t,i){i=Ti(i,t);for(var o=0,u=i.length;t!=null&&o<u;)t=t[ti(i[o++])];return o&&o==u?t:r}function _h(t,i,o){var u=i(t);return Te(t)?u:Ci(u,o(t))}function nr(t){return t==null?t===r?qe:Ke:Vi&&Vi in ut(t)?V0(t):s1(t)}function Va(t,i){return t>i}function l0(t,i){return t!=null&&nt.call(t,i)}function f0(t,i){return t!=null&&i in ut(t)}function d0(t,i,o){return t>=Qt(i,o)&&t<kt(i,o)}function Wa(t,i,o){for(var u=o?Pa:Ys,d=t[0].length,y=t.length,E=y,C=B(y),L=1/0,J=[];E--;){var Q=t[E];E&&i&&(Q=_t(Q,Er(i))),L=Qt(Q.length,L),C[E]=!o&&(i||d>=120&&Q.length>=120)?new Gi(E&&Q):r}Q=t[0];var Z=-1,ae=C[0];e:for(;++Z<d&&J.length<L;){var ve=Q[Z],we=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(ae?kn(ae,we):u(J,we,o))){for(E=y;--E;){var ze=C[E];if(!(ze?kn(ze,we):u(t[E],we,o)))continue e}ae&&ae.push(we),J.push(ve)}}return J}function p0(t,i,o,u){return Zr(t,function(d,y,E){i(u,o(d),y,E)}),u}function Xn(t,i,o){i=Ti(i,t),t=sl(t,i);var u=t==null?t:t[ti($r(i))];return u==null?r:Kt(u,t,o)}function mh(t){return Ot(t)&&nr(t)==he}function g0(t){return Ot(t)&&nr(t)==De}function v0(t){return Ot(t)&&nr(t)==N}function Zn(t,i,o,u,d){return t===i?!0:t==null||i==null||!Ot(t)&&!Ot(i)?t!==t&&i!==i:y0(t,i,o,u,Zn,d)}function y0(t,i,o,u,d,y){var E=Te(t),C=Te(i),L=E?_e:Xt(t),J=C?_e:Xt(i);L=L==he?$e:L,J=J==he?$e:J;var Q=L==$e,Z=J==$e,ae=L==J;if(ae&&Fi(t)){if(!Fi(i))return!1;E=!0,Q=!1}if(ae&&!Q)return y||(y=new Kr),E||Pn(t)?Xh(t,i,o,u,d,y):k0(t,i,L,o,u,d,y);if(!(o&M)){var ve=Q&&nt.call(t,"__wrapped__"),we=Z&&nt.call(i,"__wrapped__");if(ve||we){var ze=ve?t.value():t,Ee=we?i.value():i;return y||(y=new Kr),d(ze,Ee,o,u,y)}}return ae?(y||(y=new Kr),K0(t,i,o,u,d,y)):!1}function _0(t){return Ot(t)&&Xt(t)==Se}function Ga(t,i,o,u){var d=o.length,y=d,E=!u;if(t==null)return!y;for(t=ut(t);d--;){var C=o[d];if(E&&C[2]?C[1]!==t[C[0]]:!(C[0]in t))return!1}for(;++d<y;){C=o[d];var L=C[0],J=t[L],Q=C[1];if(E&&C[2]){if(J===r&&!(L in t))return!1}else{var Z=new Kr;if(u)var ae=u(J,Q,L,t,i,Z);if(!(ae===r?Zn(Q,J,M|H,u,Z):ae))return!1}}return!0}function bh(t){if(!bt(t)||e1(t))return!1;var i=vi(t)?_g:da;return i.test(Xi(t))}function m0(t){return Ot(t)&&nr(t)==je}function b0(t){return Ot(t)&&Xt(t)==Ie}function w0(t){return Ot(t)&&To(t.length)&&!!ot[nr(t)]}function wh(t){return typeof t=="function"?t:t==null?yr:typeof t=="object"?Te(t)?Sh(t[0],t[1]):Dh(t):Hl(t)}function Ya(t){if(!rs(t))return Sg(t);var i=[];for(var o in ut(t))nt.call(t,o)&&o!="constructor"&&i.push(o);return i}function E0(t){if(!bt(t))return n1(t);var i=rs(t),o=[];for(var u in t)u=="constructor"&&(i||!nt.call(t,u))||o.push(u);return o}function Ja(t,i){return t<i}function Eh(t,i){var o=-1,u=gr(t)?B(t.length):[];return Ai(t,function(d,y,E){u[++o]=i(d,y,E)}),u}function Dh(t){var i=lc(t);return i.length==1&&i[0][2]?il(i[0][0],i[0][1]):function(o){return o===t||Ga(o,t,i)}}function Sh(t,i){return dc(t)&&rl(i)?il(ti(t),i):function(o){var u=Dc(o,t);return u===r&&u===i?Sc(o,t):Zn(i,u,M|H)}}function vo(t,i,o,u,d){t!==i&&ka(i,function(y,E){if(d||(d=new Kr),bt(y))D0(t,i,E,o,vo,u,d);else{var C=u?u(gc(t,E),y,E+"",t,i,d):r;C===r&&(C=y),Ba(t,E,C)}},vr)}function D0(t,i,o,u,d,y,E){var C=gc(t,o),L=gc(i,o),J=E.get(L);if(J){Ba(t,o,J);return}var Q=y?y(C,L,o+"",t,i,E):r,Z=Q===r;if(Z){var ae=Te(L),ve=!ae&&Fi(L),we=!ae&&!ve&&Pn(L);Q=L,ae||ve||we?Te(C)?Q=C:Nt(C)?Q=pr(C):ve?(Z=!1,Q=Lh(L,!0)):we?(Z=!1,Q=$h(L,!0)):Q=[]:ns(L)||Zi(L)?(Q=C,Zi(C)?Q=Rl(C):(!bt(C)||vi(C))&&(Q=tl(L))):Z=!1}Z&&(E.set(L,Q),d(Q,L,u,y,E),E.delete(L)),Ba(t,o,Q)}function Ih(t,i){var o=t.length;if(o)return i+=i<0?o:0,gi(i,o)?t[i]:r}function xh(t,i,o){i.length?i=_t(i,function(y){return Te(y)?function(E){return Ji(E,y.length===1?y[0]:y)}:y}):i=[yr];var u=-1;i=_t(i,Er(me()));var d=Eh(t,function(y,E,C){var L=_t(i,function(J){return J(y)});return{criteria:L,index:++u,value:y}});return Jp(d,function(y,E){return L0(y,E,o)})}function S0(t,i){return Ch(t,i,function(o,u){return Sc(t,u)})}function Ch(t,i,o){for(var u=-1,d=i.length,y={};++u<d;){var E=i[u],C=Ji(t,E);o(C,E)&&es(y,Ti(E,t),C)}return y}function I0(t){return function(i){return Ji(i,t)}}function Qa(t,i,o,u){var d=u?Yp:_n,y=-1,E=i.length,C=t;for(t===i&&(i=pr(i)),o&&(C=_t(t,Er(o)));++y<E;)for(var L=0,J=i[y],Q=o?o(J):J;(L=d(C,Q,L,u))>-1;)C!==t&&so.call(C,L,1),so.call(t,L,1);return t}function Oh(t,i){for(var o=t?i.length:0,u=o-1;o--;){var d=i[o];if(o==u||d!==y){var y=d;gi(d)?so.call(t,d,1):tc(t,d)}}return t}function Xa(t,i){return t+co(ch()*(i-t+1))}function x0(t,i,o,u){for(var d=-1,y=kt(ao((i-t)/(o||1)),0),E=B(y);y--;)E[u?y:++d]=t,t+=o;return E}function Za(t,i){var o="";if(!t||i<1||i>G)return o;do i%2&&(o+=t),i=co(i/2),i&&(t+=t);while(i);return o}function ke(t,i){return vc(nl(t,i,yr),t+"")}function C0(t){return lh(An(t))}function O0(t,i){var o=An(t);return xo(o,Yi(i,0,o.length))}function es(t,i,o,u){if(!bt(t))return t;i=Ti(i,t);for(var d=-1,y=i.length,E=y-1,C=t;C!=null&&++d<y;){var L=ti(i[d]),J=o;if(L==="__proto__"||L==="constructor"||L==="prototype")return t;if(d!=E){var Q=C[L];J=u?u(Q,L,C):r,J===r&&(J=bt(Q)?Q:gi(i[d+1])?[]:{})}Jn(C,L,J),C=C[L]}return t}var Ph=uo?function(t,i){return uo.set(t,i),t}:yr,P0=oo?function(t,i){return oo(t,"toString",{configurable:!0,enumerable:!1,value:xc(i),writable:!0})}:yr;function A0(t){return xo(An(t))}function Lr(t,i,o){var u=-1,d=t.length;i<0&&(i=-i>d?0:d+i),o=o>d?d:o,o<0&&(o+=d),d=i>o?0:o-i>>>0,i>>>=0;for(var y=B(d);++u<d;)y[u]=t[u+i];return y}function N0(t,i){var o;return Ai(t,function(u,d,y){return o=i(u,d,y),!o}),!!o}function yo(t,i,o){var u=0,d=t==null?u:t.length;if(typeof i=="number"&&i===i&&d<=ne){for(;u<d;){var y=u+d>>>1,E=t[y];E!==null&&!Sr(E)&&(o?E<=i:E<i)?u=y+1:d=y}return d}return ec(t,i,yr,o)}function ec(t,i,o,u){var d=0,y=t==null?0:t.length;if(y===0)return 0;i=o(i);for(var E=i!==i,C=i===null,L=Sr(i),J=i===r;d<y;){var Q=co((d+y)/2),Z=o(t[Q]),ae=Z!==r,ve=Z===null,we=Z===Z,ze=Sr(Z);if(E)var Ee=u||we;else J?Ee=we&&(u||ae):C?Ee=we&&ae&&(u||!ve):L?Ee=we&&ae&&!ve&&(u||!ze):ve||ze?Ee=!1:Ee=u?Z<=i:Z<i;Ee?d=Q+1:y=Q}return Qt(y,xe)}function Ah(t,i){for(var o=-1,u=t.length,d=0,y=[];++o<u;){var E=t[o],C=i?i(E):E;if(!o||!Vr(C,L)){var L=C;y[d++]=E===0?0:E}}return y}function Nh(t){return typeof t=="number"?t:Sr(t)?Y:+t}function Dr(t){if(typeof t=="string")return t;if(Te(t))return _t(t,Dr)+"";if(Sr(t))return uh?uh.call(t):"";var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Ni(t,i,o){var u=-1,d=Ys,y=t.length,E=!0,C=[],L=C;if(o)E=!1,d=Pa;else if(y>=a){var J=i?null:B0(t);if(J)return Qs(J);E=!1,d=kn,L=new Gi}else L=i?[]:C;e:for(;++u<y;){var Q=t[u],Z=i?i(Q):Q;if(Q=o||Q!==0?Q:0,E&&Z===Z){for(var ae=L.length;ae--;)if(L[ae]===Z)continue e;i&&L.push(Z),C.push(Q)}else d(L,Z,o)||(L!==C&&L.push(Z),C.push(Q))}return C}function tc(t,i){return i=Ti(i,t),t=sl(t,i),t==null||delete t[ti($r(i))]}function Th(t,i,o,u){return es(t,i,o(Ji(t,i)),u)}function _o(t,i,o,u){for(var d=t.length,y=u?d:-1;(u?y--:++y<d)&&i(t[y],y,t););return o?Lr(t,u?0:y,u?y+1:d):Lr(t,u?y+1:0,u?d:y)}function Rh(t,i){var o=t;return o instanceof Ye&&(o=o.value()),Aa(i,function(u,d){return d.func.apply(d.thisArg,Ci([u],d.args))},o)}function rc(t,i,o){var u=t.length;if(u<2)return u?Ni(t[0]):[];for(var d=-1,y=B(u);++d<u;)for(var E=t[d],C=-1;++C<u;)C!=d&&(y[d]=Qn(y[d]||E,t[C],i,o));return Ni(Gt(y,1),i,o)}function Fh(t,i,o){for(var u=-1,d=t.length,y=i.length,E={};++u<d;){var C=u<y?i[u]:r;o(E,t[u],C)}return E}function ic(t){return Nt(t)?t:[]}function nc(t){return typeof t=="function"?t:yr}function Ti(t,i){return Te(t)?t:dc(t,i)?[t]:ul(it(t))}var T0=ke;function Ri(t,i,o){var u=t.length;return o=o===r?u:o,!i&&o>=u?t:Lr(t,i,o)}var Uh=mg||function(t){return Qe.clearTimeout(t)};function Lh(t,i){if(i)return t.slice();var o=t.length,u=ih?ih(o):new t.constructor(o);return t.copy(u),u}function sc(t){var i=new t.constructor(t.byteLength);return new io(i).set(new io(t)),i}function R0(t,i){var o=i?sc(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.byteLength)}function F0(t){var i=new t.constructor(t.source,Ar.exec(t));return i.lastIndex=t.lastIndex,i}function U0(t){return Yn?ut(Yn.call(t)):{}}function $h(t,i){var o=i?sc(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}function Mh(t,i){if(t!==i){var o=t!==r,u=t===null,d=t===t,y=Sr(t),E=i!==r,C=i===null,L=i===i,J=Sr(i);if(!C&&!J&&!y&&t>i||y&&E&&L&&!C&&!J||u&&E&&L||!o&&L||!d)return 1;if(!u&&!y&&!J&&t<i||J&&o&&d&&!u&&!y||C&&o&&d||!E&&d||!L)return-1}return 0}function L0(t,i,o){for(var u=-1,d=t.criteria,y=i.criteria,E=d.length,C=o.length;++u<E;){var L=Mh(d[u],y[u]);if(L){if(u>=C)return L;var J=o[u];return L*(J=="desc"?-1:1)}}return t.index-i.index}function jh(t,i,o,u){for(var d=-1,y=t.length,E=o.length,C=-1,L=i.length,J=kt(y-E,0),Q=B(L+J),Z=!u;++C<L;)Q[C]=i[C];for(;++d<E;)(Z||d<y)&&(Q[o[d]]=t[d]);for(;J--;)Q[C++]=t[d++];return Q}function qh(t,i,o,u){for(var d=-1,y=t.length,E=-1,C=o.length,L=-1,J=i.length,Q=kt(y-C,0),Z=B(Q+J),ae=!u;++d<Q;)Z[d]=t[d];for(var ve=d;++L<J;)Z[ve+L]=i[L];for(;++E<C;)(ae||d<y)&&(Z[ve+o[E]]=t[d++]);return Z}function pr(t,i){var o=-1,u=t.length;for(i||(i=B(u));++o<u;)i[o]=t[o];return i}function ei(t,i,o,u){var d=!o;o||(o={});for(var y=-1,E=i.length;++y<E;){var C=i[y],L=u?u(o[C],t[C],C,o,t):r;L===r&&(L=t[C]),d?fi(o,C,L):Jn(o,C,L)}return o}function $0(t,i){return ei(t,fc(t),i)}function M0(t,i){return ei(t,Zh(t),i)}function mo(t,i){return function(o,u){var d=Te(o)?Hp:o0,y=i?i():{};return d(o,t,me(u,2),y)}}function xn(t){return ke(function(i,o){var u=-1,d=o.length,y=d>1?o[d-1]:r,E=d>2?o[2]:r;for(y=t.length>3&&typeof y=="function"?(d--,y):r,E&&sr(o[0],o[1],E)&&(y=d<3?r:y,d=1),i=ut(i);++u<d;){var C=o[u];C&&t(i,C,u,y)}return i})}function zh(t,i){return function(o,u){if(o==null)return o;if(!gr(o))return t(o,u);for(var d=o.length,y=i?d:-1,E=ut(o);(i?y--:++y<d)&&u(E[y],y,E)!==!1;);return o}}function Bh(t){return function(i,o,u){for(var d=-1,y=ut(i),E=u(i),C=E.length;C--;){var L=E[t?C:++d];if(o(y[L],L,y)===!1)break}return i}}function j0(t,i,o){var u=i&k,d=ts(t);function y(){var E=this&&this!==Qe&&this instanceof y?d:t;return E.apply(u?o:this,arguments)}return y}function Hh(t){return function(i){i=it(i);var o=mn(i)?kr(i):r,u=o?o[0]:i.charAt(0),d=o?Ri(o,1).join(""):i.slice(1);return u[t]()+d}}function Cn(t){return function(i){return Aa(zl(ql(i).replace(Bn,"")),t,"")}}function ts(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=In(t.prototype),u=t.apply(o,i);return bt(u)?u:o}}function q0(t,i,o){var u=ts(t);function d(){for(var y=arguments.length,E=B(y),C=y,L=On(d);C--;)E[C]=arguments[C];var J=y<3&&E[0]!==L&&E[y-1]!==L?[]:Oi(E,L);if(y-=J.length,y<o)return Gh(t,i,bo,d.placeholder,r,E,J,r,r,o-y);var Q=this&&this!==Qe&&this instanceof d?u:t;return Kt(Q,this,E)}return d}function kh(t){return function(i,o,u){var d=ut(i);if(!gr(i)){var y=me(o,3);i=Vt(i),o=function(C){return y(d[C],C,d)}}var E=t(i,o,u);return E>-1?d[y?i[E]:E]:r}}function Kh(t){return pi(function(i){var o=i.length,u=o,d=Fr.prototype.thru;for(t&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new Rr(p);if(d&&!E&&So(y)=="wrapper")var E=new Fr([],!0)}for(u=E?u:o;++u<o;){y=i[u];var C=So(y),L=C=="wrapper"?hc(y):r;L&&pc(L[0])&&L[1]==(c|U|x|_)&&!L[4].length&&L[9]==1?E=E[So(L[0])].apply(E,L[3]):E=y.length==1&&pc(y)?E[C]():E.thru(y)}return function(){var J=arguments,Q=J[0];if(E&&J.length==1&&Te(Q))return E.plant(Q).value();for(var Z=0,ae=o?i[Z].apply(this,J):Q;++Z<o;)ae=i[Z].call(this,ae);return ae}})}function bo(t,i,o,u,d,y,E,C,L,J){var Q=i&c,Z=i&k,ae=i&ie,ve=i&(U|S),we=i&K,ze=ae?r:ts(t);function Ee(){for(var We=arguments.length,Xe=B(We),Ir=We;Ir--;)Xe[Ir]=arguments[Ir];if(ve)var or=On(Ee),xr=Xp(Xe,or);if(u&&(Xe=jh(Xe,u,d,ve)),y&&(Xe=qh(Xe,y,E,ve)),We-=xr,ve&&We<J){var Tt=Oi(Xe,or);return Gh(t,i,bo,Ee.placeholder,o,Xe,Tt,C,L,J-We)}var Wr=Z?o:this,_i=ae?Wr[t]:t;return We=Xe.length,C?Xe=o1(Xe,C):we&&We>1&&Xe.reverse(),Q&&L<We&&(Xe.length=L),this&&this!==Qe&&this instanceof Ee&&(_i=ze||ts(_i)),_i.apply(Wr,Xe)}return Ee}function Vh(t,i){return function(o,u){return p0(o,t,i(u),{})}}function wo(t,i){return function(o,u){var d;if(o===r&&u===r)return i;if(o!==r&&(d=o),u!==r){if(d===r)return u;typeof o=="string"||typeof u=="string"?(o=Dr(o),u=Dr(u)):(o=Nh(o),u=Nh(u)),d=t(o,u)}return d}}function oc(t){return pi(function(i){return i=_t(i,Er(me())),ke(function(o){var u=this;return t(i,function(d){return Kt(d,u,o)})})})}function Eo(t,i){i=i===r?" ":Dr(i);var o=i.length;if(o<2)return o?Za(i,t):i;var u=Za(i,ao(t/bn(i)));return mn(i)?Ri(kr(u),0,t).join(""):u.slice(0,t)}function z0(t,i,o,u){var d=i&k,y=ts(t);function E(){for(var C=-1,L=arguments.length,J=-1,Q=u.length,Z=B(Q+L),ae=this&&this!==Qe&&this instanceof E?y:t;++J<Q;)Z[J]=u[J];for(;L--;)Z[J++]=arguments[++C];return Kt(ae,d?o:this,Z)}return E}function Wh(t){return function(i,o,u){return u&&typeof u!="number"&&sr(i,o,u)&&(o=u=r),i=yi(i),o===r?(o=i,i=0):o=yi(o),u=u===r?i<o?1:-1:yi(u),x0(i,o,u,t)}}function Do(t){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Mr(i),o=Mr(o)),t(i,o)}}function Gh(t,i,o,u,d,y,E,C,L,J){var Q=i&U,Z=Q?E:r,ae=Q?r:E,ve=Q?y:r,we=Q?r:y;i|=Q?x:m,i&=~(Q?m:x),i&P||(i&=~(k|ie));var ze=[t,i,d,ve,Z,we,ae,C,L,J],Ee=o.apply(r,ze);return pc(t)&&ol(Ee,ze),Ee.placeholder=u,al(Ee,t,i)}function ac(t){var i=Ht[t];return function(o,u){if(o=Mr(o),u=u==null?0:Qt(Me(u),292),u&&ah(o)){var d=(it(o)+"e").split("e"),y=i(d[0]+"e"+(+d[1]+u));return d=(it(y)+"e").split("e"),+(d[0]+"e"+(+d[1]-u))}return i(o)}}var B0=Dn&&1/Qs(new Dn([,-0]))[1]==te?function(t){return new Dn(t)}:Pc;function Yh(t){return function(i){var o=Xt(i);return o==Se?$a(i):o==Ie?sg(i):Qp(i,t(i))}}function di(t,i,o,u,d,y,E,C){var L=i&ie;if(!L&&typeof t!="function")throw new Rr(p);var J=u?u.length:0;if(J||(i&=~(x|m),u=d=r),E=E===r?E:kt(Me(E),0),C=C===r?C:Me(C),J-=d?d.length:0,i&m){var Q=u,Z=d;u=d=r}var ae=L?r:hc(t),ve=[t,i,o,u,d,Q,Z,y,E,C];if(ae&&i1(ve,ae),t=ve[0],i=ve[1],o=ve[2],u=ve[3],d=ve[4],C=ve[9]=ve[9]===r?L?0:t.length:kt(ve[9]-J,0),!C&&i&(U|S)&&(i&=~(U|S)),!i||i==k)var we=j0(t,i,o);else i==U||i==S?we=q0(t,i,C):(i==x||i==(k|x))&&!d.length?we=z0(t,i,o,u):we=bo.apply(r,ve);var ze=ae?Ph:ol;return al(ze(we,ve),t,i)}function Jh(t,i,o,u){return t===r||Vr(t,En[o])&&!nt.call(u,o)?i:t}function Qh(t,i,o,u,d,y){return bt(t)&&bt(i)&&(y.set(i,t),vo(t,i,r,Qh,y),y.delete(i)),t}function H0(t){return ns(t)?r:t}function Xh(t,i,o,u,d,y){var E=o&M,C=t.length,L=i.length;if(C!=L&&!(E&&L>C))return!1;var J=y.get(t),Q=y.get(i);if(J&&Q)return J==i&&Q==t;var Z=-1,ae=!0,ve=o&H?new Gi:r;for(y.set(t,i),y.set(i,t);++Z<C;){var we=t[Z],ze=i[Z];if(u)var Ee=E?u(ze,we,Z,i,t,y):u(we,ze,Z,t,i,y);if(Ee!==r){if(Ee)continue;ae=!1;break}if(ve){if(!Na(i,function(We,Xe){if(!kn(ve,Xe)&&(we===We||d(we,We,o,u,y)))return ve.push(Xe)})){ae=!1;break}}else if(!(we===ze||d(we,ze,o,u,y))){ae=!1;break}}return y.delete(t),y.delete(i),ae}function k0(t,i,o,u,d,y,E){switch(o){case Pe:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case De:return!(t.byteLength!=i.byteLength||!y(new io(t),new io(i)));case j:case N:case Be:return Vr(+t,+i);case I:return t.name==i.name&&t.message==i.message;case je:case Re:return t==i+"";case Se:var C=$a;case Ie:var L=u&M;if(C||(C=Qs),t.size!=i.size&&!L)return!1;var J=E.get(t);if(J)return J==i;u|=H,E.set(t,i);var Q=Xh(C(t),C(i),u,d,y,E);return E.delete(t),Q;case Fe:if(Yn)return Yn.call(t)==Yn.call(i)}return!1}function K0(t,i,o,u,d,y){var E=o&M,C=cc(t),L=C.length,J=cc(i),Q=J.length;if(L!=Q&&!E)return!1;for(var Z=L;Z--;){var ae=C[Z];if(!(E?ae in i:nt.call(i,ae)))return!1}var ve=y.get(t),we=y.get(i);if(ve&&we)return ve==i&&we==t;var ze=!0;y.set(t,i),y.set(i,t);for(var Ee=E;++Z<L;){ae=C[Z];var We=t[ae],Xe=i[ae];if(u)var Ir=E?u(Xe,We,ae,i,t,y):u(We,Xe,ae,t,i,y);if(!(Ir===r?We===Xe||d(We,Xe,o,u,y):Ir)){ze=!1;break}Ee||(Ee=ae=="constructor")}if(ze&&!Ee){var or=t.constructor,xr=i.constructor;or!=xr&&"constructor"in t&&"constructor"in i&&!(typeof or=="function"&&or instanceof or&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return y.delete(t),y.delete(i),ze}function pi(t){return vc(nl(t,r,dl),t+"")}function cc(t){return _h(t,Vt,fc)}function uc(t){return _h(t,vr,Zh)}var hc=uo?function(t){return uo.get(t)}:Pc;function So(t){for(var i=t.name+"",o=Sn[i],u=nt.call(Sn,i)?o.length:0;u--;){var d=o[u],y=d.func;if(y==null||y==t)return d.name}return i}function On(t){var i=nt.call(v,"placeholder")?v:t;return i.placeholder}function me(){var t=v.iteratee||Cc;return t=t===Cc?wh:t,arguments.length?t(arguments[0],arguments[1]):t}function Io(t,i){var o=t.__data__;return Z0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function lc(t){for(var i=Vt(t),o=i.length;o--;){var u=i[o],d=t[u];i[o]=[u,d,rl(d)]}return i}function Qi(t,i){var o=rg(t,i);return bh(o)?o:r}function V0(t){var i=nt.call(t,Vi),o=t[Vi];try{t[Vi]=r;var u=!0}catch{}var d=to.call(t);return u&&(i?t[Vi]=o:delete t[Vi]),d}var fc=ja?function(t){return t==null?[]:(t=ut(t),xi(ja(t),function(i){return sh.call(t,i)}))}:Ac,Zh=ja?function(t){for(var i=[];t;)Ci(i,fc(t)),t=no(t);return i}:Ac,Xt=nr;(qa&&Xt(new qa(new ArrayBuffer(1)))!=Pe||Vn&&Xt(new Vn)!=Se||za&&Xt(za.resolve())!=pt||Dn&&Xt(new Dn)!=Ie||Wn&&Xt(new Wn)!=Oe)&&(Xt=function(t){var i=nr(t),o=i==$e?t.constructor:r,u=o?Xi(o):"";if(u)switch(u){case Og:return Pe;case Pg:return Se;case Ag:return pt;case Ng:return Ie;case Tg:return Oe}return i});function W0(t,i,o){for(var u=-1,d=o.length;++u<d;){var y=o[u],E=y.size;switch(y.type){case"drop":t+=E;break;case"dropRight":i-=E;break;case"take":i=Qt(i,t+E);break;case"takeRight":t=kt(t,i-E);break}}return{start:t,end:i}}function G0(t){var i=t.match(ht);return i?i[1].split(Mt):[]}function el(t,i,o){i=Ti(i,t);for(var u=-1,d=i.length,y=!1;++u<d;){var E=ti(i[u]);if(!(y=t!=null&&o(t,E)))break;t=t[E]}return y||++u!=d?y:(d=t==null?0:t.length,!!d&&To(d)&&gi(E,d)&&(Te(t)||Zi(t)))}function Y0(t){var i=t.length,o=new t.constructor(i);return i&&typeof t[0]=="string"&&nt.call(t,"index")&&(o.index=t.index,o.input=t.input),o}function tl(t){return typeof t.constructor=="function"&&!rs(t)?In(no(t)):{}}function J0(t,i,o){var u=t.constructor;switch(i){case De:return sc(t);case j:case N:return new u(+t);case Pe:return R0(t,o);case He:case Ce:case Ve:case Ge:case et:case tt:case Je:case tr:case fr:return $h(t,o);case Se:return new u;case Be:case Re:return new u(t);case je:return F0(t);case Ie:return new u;case Fe:return U0(t)}}function Q0(t,i){var o=i.length;if(!o)return t;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),t.replace(Ct,`{
/* [wrapped with `+i+`] */
`)}function X0(t){return Te(t)||Zi(t)||!!(oh&&t&&t[oh])}function gi(t,i){var o=typeof t;return i=i??G,!!i&&(o=="number"||o!="symbol"&&ga.test(t))&&t>-1&&t%1==0&&t<i}function sr(t,i,o){if(!bt(o))return!1;var u=typeof i;return(u=="number"?gr(o)&&gi(i,o.length):u=="string"&&i in o)?Vr(o[i],t):!1}function dc(t,i){if(Te(t))return!1;var o=typeof t;return o=="number"||o=="symbol"||o=="boolean"||t==null||Sr(t)?!0:Ut.test(t)||!yt.test(t)||i!=null&&t in ut(i)}function Z0(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function pc(t){var i=So(t),o=v[i];if(typeof o!="function"||!(i in Ye.prototype))return!1;if(t===o)return!0;var u=hc(o);return!!u&&t===u[0]}function e1(t){return!!rh&&rh in t}var t1=Zs?vi:Nc;function rs(t){var i=t&&t.constructor,o=typeof i=="function"&&i.prototype||En;return t===o}function rl(t){return t===t&&!bt(t)}function il(t,i){return function(o){return o==null?!1:o[t]===i&&(i!==r||t in ut(o))}}function r1(t){var i=Ao(t,function(u){return o.size===w&&o.clear(),u}),o=i.cache;return i}function i1(t,i){var o=t[1],u=i[1],d=o|u,y=d<(k|ie|c),E=u==c&&o==U||u==c&&o==_&&t[7].length<=i[8]||u==(c|_)&&i[7].length<=i[8]&&o==U;if(!(y||E))return t;u&k&&(t[2]=i[2],d|=o&k?0:P);var C=i[3];if(C){var L=t[3];t[3]=L?jh(L,C,i[4]):C,t[4]=L?Oi(t[3],D):i[4]}return C=i[5],C&&(L=t[5],t[5]=L?qh(L,C,i[6]):C,t[6]=L?Oi(t[5],D):i[6]),C=i[7],C&&(t[7]=C),u&c&&(t[8]=t[8]==null?i[8]:Qt(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=d,t}function n1(t){var i=[];if(t!=null)for(var o in ut(t))i.push(o);return i}function s1(t){return to.call(t)}function nl(t,i,o){return i=kt(i===r?t.length-1:i,0),function(){for(var u=arguments,d=-1,y=kt(u.length-i,0),E=B(y);++d<y;)E[d]=u[i+d];d=-1;for(var C=B(i+1);++d<i;)C[d]=u[d];return C[i]=o(E),Kt(t,this,C)}}function sl(t,i){return i.length<2?t:Ji(t,Lr(i,0,-1))}function o1(t,i){for(var o=t.length,u=Qt(i.length,o),d=pr(t);u--;){var y=i[u];t[u]=gi(y,o)?d[y]:r}return t}function gc(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var ol=cl(Ph),is=wg||function(t,i){return Qe.setTimeout(t,i)},vc=cl(P0);function al(t,i,o){var u=i+"";return vc(t,Q0(u,a1(G0(u),o)))}function cl(t){var i=0,o=0;return function(){var u=Ig(),d=ge-(u-o);if(o=u,d>0){if(++i>=ce)return arguments[0]}else i=0;return t.apply(r,arguments)}}function xo(t,i){var o=-1,u=t.length,d=u-1;for(i=i===r?u:i;++o<i;){var y=Xa(o,d),E=t[y];t[y]=t[o],t[o]=E}return t.length=i,t}var ul=r1(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(Lt,function(o,u,d,y){i.push(d?y.replace(ua,"$1"):u||o)}),i});function ti(t){if(typeof t=="string"||Sr(t))return t;var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Xi(t){if(t!=null){try{return eo.call(t)}catch{}try{return t+""}catch{}}return""}function a1(t,i){return Tr(be,function(o){var u="_."+o[0];i&o[1]&&!Ys(t,u)&&t.push(u)}),t.sort()}function hl(t){if(t instanceof Ye)return t.clone();var i=new Fr(t.__wrapped__,t.__chain__);return i.__actions__=pr(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function c1(t,i,o){(o?sr(t,i,o):i===r)?i=1:i=kt(Me(i),0);var u=t==null?0:t.length;if(!u||i<1)return[];for(var d=0,y=0,E=B(ao(u/i));d<u;)E[y++]=Lr(t,d,d+=i);return E}function u1(t){for(var i=-1,o=t==null?0:t.length,u=0,d=[];++i<o;){var y=t[i];y&&(d[u++]=y)}return d}function h1(){var t=arguments.length;if(!t)return[];for(var i=B(t-1),o=arguments[0],u=t;u--;)i[u-1]=arguments[u];return Ci(Te(o)?pr(o):[o],Gt(i,1))}var l1=ke(function(t,i){return Nt(t)?Qn(t,Gt(i,1,Nt,!0)):[]}),f1=ke(function(t,i){var o=$r(i);return Nt(o)&&(o=r),Nt(t)?Qn(t,Gt(i,1,Nt,!0),me(o,2)):[]}),d1=ke(function(t,i){var o=$r(i);return Nt(o)&&(o=r),Nt(t)?Qn(t,Gt(i,1,Nt,!0),r,o):[]});function p1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Me(i),Lr(t,i<0?0:i,u)):[]}function g1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Me(i),i=u-i,Lr(t,0,i<0?0:i)):[]}function v1(t,i){return t&&t.length?_o(t,me(i,3),!0,!0):[]}function y1(t,i){return t&&t.length?_o(t,me(i,3),!0):[]}function _1(t,i,o,u){var d=t==null?0:t.length;return d?(o&&typeof o!="number"&&sr(t,i,o)&&(o=0,u=d),h0(t,i,o,u)):[]}function ll(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=o==null?0:Me(o);return d<0&&(d=kt(u+d,0)),Js(t,me(i,3),d)}function fl(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=u-1;return o!==r&&(d=Me(o),d=o<0?kt(u+d,0):Qt(d,u-1)),Js(t,me(i,3),d,!0)}function dl(t){var i=t==null?0:t.length;return i?Gt(t,1):[]}function m1(t){var i=t==null?0:t.length;return i?Gt(t,te):[]}function b1(t,i){var o=t==null?0:t.length;return o?(i=i===r?1:Me(i),Gt(t,i)):[]}function w1(t){for(var i=-1,o=t==null?0:t.length,u={};++i<o;){var d=t[i];u[d[0]]=d[1]}return u}function pl(t){return t&&t.length?t[0]:r}function E1(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=o==null?0:Me(o);return d<0&&(d=kt(u+d,0)),_n(t,i,d)}function D1(t){var i=t==null?0:t.length;return i?Lr(t,0,-1):[]}var S1=ke(function(t){var i=_t(t,ic);return i.length&&i[0]===t[0]?Wa(i):[]}),I1=ke(function(t){var i=$r(t),o=_t(t,ic);return i===$r(o)?i=r:o.pop(),o.length&&o[0]===t[0]?Wa(o,me(i,2)):[]}),x1=ke(function(t){var i=$r(t),o=_t(t,ic);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===t[0]?Wa(o,r,i):[]});function C1(t,i){return t==null?"":Dg.call(t,i)}function $r(t){var i=t==null?0:t.length;return i?t[i-1]:r}function O1(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=u;return o!==r&&(d=Me(o),d=d<0?kt(u+d,0):Qt(d,u-1)),i===i?ag(t,i,d):Js(t,Gu,d,!0)}function P1(t,i){return t&&t.length?Ih(t,Me(i)):r}var A1=ke(gl);function gl(t,i){return t&&t.length&&i&&i.length?Qa(t,i):t}function N1(t,i,o){return t&&t.length&&i&&i.length?Qa(t,i,me(o,2)):t}function T1(t,i,o){return t&&t.length&&i&&i.length?Qa(t,i,r,o):t}var R1=pi(function(t,i){var o=t==null?0:t.length,u=Ha(t,i);return Oh(t,_t(i,function(d){return gi(d,o)?+d:d}).sort(Mh)),u});function F1(t,i){var o=[];if(!(t&&t.length))return o;var u=-1,d=[],y=t.length;for(i=me(i,3);++u<y;){var E=t[u];i(E,u,t)&&(o.push(E),d.push(u))}return Oh(t,d),o}function yc(t){return t==null?t:Cg.call(t)}function U1(t,i,o){var u=t==null?0:t.length;return u?(o&&typeof o!="number"&&sr(t,i,o)?(i=0,o=u):(i=i==null?0:Me(i),o=o===r?u:Me(o)),Lr(t,i,o)):[]}function L1(t,i){return yo(t,i)}function $1(t,i,o){return ec(t,i,me(o,2))}function M1(t,i){var o=t==null?0:t.length;if(o){var u=yo(t,i);if(u<o&&Vr(t[u],i))return u}return-1}function j1(t,i){return yo(t,i,!0)}function q1(t,i,o){return ec(t,i,me(o,2),!0)}function z1(t,i){var o=t==null?0:t.length;if(o){var u=yo(t,i,!0)-1;if(Vr(t[u],i))return u}return-1}function B1(t){return t&&t.length?Ah(t):[]}function H1(t,i){return t&&t.length?Ah(t,me(i,2)):[]}function k1(t){var i=t==null?0:t.length;return i?Lr(t,1,i):[]}function K1(t,i,o){return t&&t.length?(i=o||i===r?1:Me(i),Lr(t,0,i<0?0:i)):[]}function V1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Me(i),i=u-i,Lr(t,i<0?0:i,u)):[]}function W1(t,i){return t&&t.length?_o(t,me(i,3),!1,!0):[]}function G1(t,i){return t&&t.length?_o(t,me(i,3)):[]}var Y1=ke(function(t){return Ni(Gt(t,1,Nt,!0))}),J1=ke(function(t){var i=$r(t);return Nt(i)&&(i=r),Ni(Gt(t,1,Nt,!0),me(i,2))}),Q1=ke(function(t){var i=$r(t);return i=typeof i=="function"?i:r,Ni(Gt(t,1,Nt,!0),r,i)});function X1(t){return t&&t.length?Ni(t):[]}function Z1(t,i){return t&&t.length?Ni(t,me(i,2)):[]}function ev(t,i){return i=typeof i=="function"?i:r,t&&t.length?Ni(t,r,i):[]}function _c(t){if(!(t&&t.length))return[];var i=0;return t=xi(t,function(o){if(Nt(o))return i=kt(o.length,i),!0}),Ua(i,function(o){return _t(t,Ta(o))})}function vl(t,i){if(!(t&&t.length))return[];var o=_c(t);return i==null?o:_t(o,function(u){return Kt(i,r,u)})}var tv=ke(function(t,i){return Nt(t)?Qn(t,i):[]}),rv=ke(function(t){return rc(xi(t,Nt))}),iv=ke(function(t){var i=$r(t);return Nt(i)&&(i=r),rc(xi(t,Nt),me(i,2))}),nv=ke(function(t){var i=$r(t);return i=typeof i=="function"?i:r,rc(xi(t,Nt),r,i)}),sv=ke(_c);function ov(t,i){return Fh(t||[],i||[],Jn)}function av(t,i){return Fh(t||[],i||[],es)}var cv=ke(function(t){var i=t.length,o=i>1?t[i-1]:r;return o=typeof o=="function"?(t.pop(),o):r,vl(t,o)});function yl(t){var i=v(t);return i.__chain__=!0,i}function uv(t,i){return i(t),t}function Co(t,i){return i(t)}var hv=pi(function(t){var i=t.length,o=i?t[0]:0,u=this.__wrapped__,d=function(y){return Ha(y,t)};return i>1||this.__actions__.length||!(u instanceof Ye)||!gi(o)?this.thru(d):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:Co,args:[d],thisArg:r}),new Fr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function lv(){return yl(this)}function fv(){return new Fr(this.value(),this.__chain__)}function dv(){this.__values__===r&&(this.__values__=Nl(this.value()));var t=this.__index__>=this.__values__.length,i=t?r:this.__values__[this.__index__++];return{done:t,value:i}}function pv(){return this}function gv(t){for(var i,o=this;o instanceof lo;){var u=hl(o);u.__index__=0,u.__values__=r,i?d.__wrapped__=u:i=u;var d=u;o=o.__wrapped__}return d.__wrapped__=t,i}function vv(){var t=this.__wrapped__;if(t instanceof Ye){var i=t;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:Co,args:[yc],thisArg:r}),new Fr(i,this.__chain__)}return this.thru(yc)}function yv(){return Rh(this.__wrapped__,this.__actions__)}var _v=mo(function(t,i,o){nt.call(t,o)?++t[o]:fi(t,o,1)});function mv(t,i,o){var u=Te(t)?Vu:u0;return o&&sr(t,i,o)&&(i=r),u(t,me(i,3))}function bv(t,i){var o=Te(t)?xi:vh;return o(t,me(i,3))}var wv=kh(ll),Ev=kh(fl);function Dv(t,i){return Gt(Oo(t,i),1)}function Sv(t,i){return Gt(Oo(t,i),te)}function Iv(t,i,o){return o=o===r?1:Me(o),Gt(Oo(t,i),o)}function _l(t,i){var o=Te(t)?Tr:Ai;return o(t,me(i,3))}function ml(t,i){var o=Te(t)?kp:gh;return o(t,me(i,3))}var xv=mo(function(t,i,o){nt.call(t,o)?t[o].push(i):fi(t,o,[i])});function Cv(t,i,o,u){t=gr(t)?t:An(t),o=o&&!u?Me(o):0;var d=t.length;return o<0&&(o=kt(d+o,0)),Ro(t)?o<=d&&t.indexOf(i,o)>-1:!!d&&_n(t,i,o)>-1}var Ov=ke(function(t,i,o){var u=-1,d=typeof i=="function",y=gr(t)?B(t.length):[];return Ai(t,function(E){y[++u]=d?Kt(i,E,o):Xn(E,i,o)}),y}),Pv=mo(function(t,i,o){fi(t,o,i)});function Oo(t,i){var o=Te(t)?_t:Eh;return o(t,me(i,3))}function Av(t,i,o,u){return t==null?[]:(Te(i)||(i=i==null?[]:[i]),o=u?r:o,Te(o)||(o=o==null?[]:[o]),xh(t,i,o))}var Nv=mo(function(t,i,o){t[o?0:1].push(i)},function(){return[[],[]]});function Tv(t,i,o){var u=Te(t)?Aa:Ju,d=arguments.length<3;return u(t,me(i,4),o,d,Ai)}function Rv(t,i,o){var u=Te(t)?Kp:Ju,d=arguments.length<3;return u(t,me(i,4),o,d,gh)}function Fv(t,i){var o=Te(t)?xi:vh;return o(t,No(me(i,3)))}function Uv(t){var i=Te(t)?lh:C0;return i(t)}function Lv(t,i,o){(o?sr(t,i,o):i===r)?i=1:i=Me(i);var u=Te(t)?n0:O0;return u(t,i)}function $v(t){var i=Te(t)?s0:A0;return i(t)}function Mv(t){if(t==null)return 0;if(gr(t))return Ro(t)?bn(t):t.length;var i=Xt(t);return i==Se||i==Ie?t.size:Ya(t).length}function jv(t,i,o){var u=Te(t)?Na:N0;return o&&sr(t,i,o)&&(i=r),u(t,me(i,3))}var qv=ke(function(t,i){if(t==null)return[];var o=i.length;return o>1&&sr(t,i[0],i[1])?i=[]:o>2&&sr(i[0],i[1],i[2])&&(i=[i[0]]),xh(t,Gt(i,1),[])}),Po=bg||function(){return Qe.Date.now()};function zv(t,i){if(typeof i!="function")throw new Rr(p);return t=Me(t),function(){if(--t<1)return i.apply(this,arguments)}}function bl(t,i,o){return i=o?r:i,i=t&&i==null?t.length:i,di(t,c,r,r,r,r,i)}function wl(t,i){var o;if(typeof i!="function")throw new Rr(p);return t=Me(t),function(){return--t>0&&(o=i.apply(this,arguments)),t<=1&&(i=r),o}}var mc=ke(function(t,i,o){var u=k;if(o.length){var d=Oi(o,On(mc));u|=x}return di(t,u,i,o,d)}),El=ke(function(t,i,o){var u=k|ie;if(o.length){var d=Oi(o,On(El));u|=x}return di(i,u,t,o,d)});function Dl(t,i,o){i=o?r:i;var u=di(t,U,r,r,r,r,r,i);return u.placeholder=Dl.placeholder,u}function Sl(t,i,o){i=o?r:i;var u=di(t,S,r,r,r,r,r,i);return u.placeholder=Sl.placeholder,u}function Il(t,i,o){var u,d,y,E,C,L,J=0,Q=!1,Z=!1,ae=!0;if(typeof t!="function")throw new Rr(p);i=Mr(i)||0,bt(o)&&(Q=!!o.leading,Z="maxWait"in o,y=Z?kt(Mr(o.maxWait)||0,i):y,ae="trailing"in o?!!o.trailing:ae);function ve(Tt){var Wr=u,_i=d;return u=d=r,J=Tt,E=t.apply(_i,Wr),E}function we(Tt){return J=Tt,C=is(We,i),Q?ve(Tt):E}function ze(Tt){var Wr=Tt-L,_i=Tt-J,kl=i-Wr;return Z?Qt(kl,y-_i):kl}function Ee(Tt){var Wr=Tt-L,_i=Tt-J;return L===r||Wr>=i||Wr<0||Z&&_i>=y}function We(){var Tt=Po();if(Ee(Tt))return Xe(Tt);C=is(We,ze(Tt))}function Xe(Tt){return C=r,ae&&u?ve(Tt):(u=d=r,E)}function Ir(){C!==r&&Uh(C),J=0,u=L=d=C=r}function or(){return C===r?E:Xe(Po())}function xr(){var Tt=Po(),Wr=Ee(Tt);if(u=arguments,d=this,L=Tt,Wr){if(C===r)return we(L);if(Z)return Uh(C),C=is(We,i),ve(L)}return C===r&&(C=is(We,i)),E}return xr.cancel=Ir,xr.flush=or,xr}var Bv=ke(function(t,i){return ph(t,1,i)}),Hv=ke(function(t,i,o){return ph(t,Mr(i)||0,o)});function kv(t){return di(t,K)}function Ao(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new Rr(p);var o=function(){var u=arguments,d=i?i.apply(this,u):u[0],y=o.cache;if(y.has(d))return y.get(d);var E=t.apply(this,u);return o.cache=y.set(d,E)||y,E};return o.cache=new(Ao.Cache||li),o}Ao.Cache=li;function No(t){if(typeof t!="function")throw new Rr(p);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function Kv(t){return wl(2,t)}var Vv=T0(function(t,i){i=i.length==1&&Te(i[0])?_t(i[0],Er(me())):_t(Gt(i,1),Er(me()));var o=i.length;return ke(function(u){for(var d=-1,y=Qt(u.length,o);++d<y;)u[d]=i[d].call(this,u[d]);return Kt(t,this,u)})}),bc=ke(function(t,i){var o=Oi(i,On(bc));return di(t,x,r,i,o)}),xl=ke(function(t,i){var o=Oi(i,On(xl));return di(t,m,r,i,o)}),Wv=pi(function(t,i){return di(t,_,r,r,r,i)});function Gv(t,i){if(typeof t!="function")throw new Rr(p);return i=i===r?i:Me(i),ke(t,i)}function Yv(t,i){if(typeof t!="function")throw new Rr(p);return i=i==null?0:kt(Me(i),0),ke(function(o){var u=o[i],d=Ri(o,0,i);return u&&Ci(d,u),Kt(t,this,d)})}function Jv(t,i,o){var u=!0,d=!0;if(typeof t!="function")throw new Rr(p);return bt(o)&&(u="leading"in o?!!o.leading:u,d="trailing"in o?!!o.trailing:d),Il(t,i,{leading:u,maxWait:i,trailing:d})}function Qv(t){return bl(t,1)}function Xv(t,i){return bc(nc(i),t)}function Zv(){if(!arguments.length)return[];var t=arguments[0];return Te(t)?t:[t]}function ey(t){return Ur(t,A)}function ty(t,i){return i=typeof i=="function"?i:r,Ur(t,A,i)}function ry(t){return Ur(t,O|A)}function iy(t,i){return i=typeof i=="function"?i:r,Ur(t,O|A,i)}function ny(t,i){return i==null||dh(t,i,Vt(i))}function Vr(t,i){return t===i||t!==t&&i!==i}var sy=Do(Va),oy=Do(function(t,i){return t>=i}),Zi=mh(function(){return arguments}())?mh:function(t){return Ot(t)&&nt.call(t,"callee")&&!sh.call(t,"callee")},Te=B.isArray,ay=ir?Er(ir):g0;function gr(t){return t!=null&&To(t.length)&&!vi(t)}function Nt(t){return Ot(t)&&gr(t)}function cy(t){return t===!0||t===!1||Ot(t)&&nr(t)==j}var Fi=Eg||Nc,uy=Hr?Er(Hr):v0;function hy(t){return Ot(t)&&t.nodeType===1&&!ns(t)}function ly(t){if(t==null)return!0;if(gr(t)&&(Te(t)||typeof t=="string"||typeof t.splice=="function"||Fi(t)||Pn(t)||Zi(t)))return!t.length;var i=Xt(t);if(i==Se||i==Ie)return!t.size;if(rs(t))return!Ya(t).length;for(var o in t)if(nt.call(t,o))return!1;return!0}function fy(t,i){return Zn(t,i)}function dy(t,i,o){o=typeof o=="function"?o:r;var u=o?o(t,i):r;return u===r?Zn(t,i,r,o):!!u}function wc(t){if(!Ot(t))return!1;var i=nr(t);return i==I||i==l||typeof t.message=="string"&&typeof t.name=="string"&&!ns(t)}function py(t){return typeof t=="number"&&ah(t)}function vi(t){if(!bt(t))return!1;var i=nr(t);return i==se||i==fe||i==q||i==gt}function Cl(t){return typeof t=="number"&&t==Me(t)}function To(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=G}function bt(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function Ot(t){return t!=null&&typeof t=="object"}var Ol=Nr?Er(Nr):_0;function gy(t,i){return t===i||Ga(t,i,lc(i))}function vy(t,i,o){return o=typeof o=="function"?o:r,Ga(t,i,lc(i),o)}function yy(t){return Pl(t)&&t!=+t}function _y(t){if(t1(t))throw new Ae(h);return bh(t)}function my(t){return t===null}function by(t){return t==null}function Pl(t){return typeof t=="number"||Ot(t)&&nr(t)==Be}function ns(t){if(!Ot(t)||nr(t)!=$e)return!1;var i=no(t);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&eo.call(o)==vg}var Ec=Xr?Er(Xr):m0;function wy(t){return Cl(t)&&t>=-G&&t<=G}var Al=Hn?Er(Hn):b0;function Ro(t){return typeof t=="string"||!Te(t)&&Ot(t)&&nr(t)==Re}function Sr(t){return typeof t=="symbol"||Ot(t)&&nr(t)==Fe}var Pn=Ki?Er(Ki):w0;function Ey(t){return t===r}function Dy(t){return Ot(t)&&Xt(t)==Oe}function Sy(t){return Ot(t)&&nr(t)==Ue}var Iy=Do(Ja),xy=Do(function(t,i){return t<=i});function Nl(t){if(!t)return[];if(gr(t))return Ro(t)?kr(t):pr(t);if(Kn&&t[Kn])return ng(t[Kn]());var i=Xt(t),o=i==Se?$a:i==Ie?Qs:An;return o(t)}function yi(t){if(!t)return t===0?t:0;if(t=Mr(t),t===te||t===-te){var i=t<0?-1:1;return i*ee}return t===t?t:0}function Me(t){var i=yi(t),o=i%1;return i===i?o?i-o:i:0}function Tl(t){return t?Yi(Me(t),0,re):0}function Mr(t){if(typeof t=="number")return t;if(Sr(t))return Y;if(bt(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=bt(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=Qu(t);var o=fa.test(t);return o||pa.test(t)?Ne(t.slice(2),o?2:8):la.test(t)?Y:+t}function Rl(t){return ei(t,vr(t))}function Cy(t){return t?Yi(Me(t),-G,G):t===0?t:0}function it(t){return t==null?"":Dr(t)}var Oy=xn(function(t,i){if(rs(i)||gr(i)){ei(i,Vt(i),t);return}for(var o in i)nt.call(i,o)&&Jn(t,o,i[o])}),Fl=xn(function(t,i){ei(i,vr(i),t)}),Fo=xn(function(t,i,o,u){ei(i,vr(i),t,u)}),Py=xn(function(t,i,o,u){ei(i,Vt(i),t,u)}),Ay=pi(Ha);function Ny(t,i){var o=In(t);return i==null?o:fh(o,i)}var Ty=ke(function(t,i){t=ut(t);var o=-1,u=i.length,d=u>2?i[2]:r;for(d&&sr(i[0],i[1],d)&&(u=1);++o<u;)for(var y=i[o],E=vr(y),C=-1,L=E.length;++C<L;){var J=E[C],Q=t[J];(Q===r||Vr(Q,En[J])&&!nt.call(t,J))&&(t[J]=y[J])}return t}),Ry=ke(function(t){return t.push(r,Qh),Kt(Ul,r,t)});function Fy(t,i){return Wu(t,me(i,3),Zr)}function Uy(t,i){return Wu(t,me(i,3),Ka)}function Ly(t,i){return t==null?t:ka(t,me(i,3),vr)}function $y(t,i){return t==null?t:yh(t,me(i,3),vr)}function My(t,i){return t&&Zr(t,me(i,3))}function jy(t,i){return t&&Ka(t,me(i,3))}function qy(t){return t==null?[]:go(t,Vt(t))}function zy(t){return t==null?[]:go(t,vr(t))}function Dc(t,i,o){var u=t==null?r:Ji(t,i);return u===r?o:u}function By(t,i){return t!=null&&el(t,i,l0)}function Sc(t,i){return t!=null&&el(t,i,f0)}var Hy=Vh(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=to.call(i)),t[i]=o},xc(yr)),ky=Vh(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=to.call(i)),nt.call(t,i)?t[i].push(o):t[i]=[o]},me),Ky=ke(Xn);function Vt(t){return gr(t)?hh(t):Ya(t)}function vr(t){return gr(t)?hh(t,!0):E0(t)}function Vy(t,i){var o={};return i=me(i,3),Zr(t,function(u,d,y){fi(o,i(u,d,y),u)}),o}function Wy(t,i){var o={};return i=me(i,3),Zr(t,function(u,d,y){fi(o,d,i(u,d,y))}),o}var Gy=xn(function(t,i,o){vo(t,i,o)}),Ul=xn(function(t,i,o,u){vo(t,i,o,u)}),Yy=pi(function(t,i){var o={};if(t==null)return o;var u=!1;i=_t(i,function(y){return y=Ti(y,t),u||(u=y.length>1),y}),ei(t,uc(t),o),u&&(o=Ur(o,O|$|A,H0));for(var d=i.length;d--;)tc(o,i[d]);return o});function Jy(t,i){return Ll(t,No(me(i)))}var Qy=pi(function(t,i){return t==null?{}:S0(t,i)});function Ll(t,i){if(t==null)return{};var o=_t(uc(t),function(u){return[u]});return i=me(i),Ch(t,o,function(u,d){return i(u,d[0])})}function Xy(t,i,o){i=Ti(i,t);var u=-1,d=i.length;for(d||(d=1,t=r);++u<d;){var y=t==null?r:t[ti(i[u])];y===r&&(u=d,y=o),t=vi(y)?y.call(t):y}return t}function Zy(t,i,o){return t==null?t:es(t,i,o)}function e_(t,i,o,u){return u=typeof u=="function"?u:r,t==null?t:es(t,i,o,u)}var $l=Yh(Vt),Ml=Yh(vr);function t_(t,i,o){var u=Te(t),d=u||Fi(t)||Pn(t);if(i=me(i,4),o==null){var y=t&&t.constructor;d?o=u?new y:[]:bt(t)?o=vi(y)?In(no(t)):{}:o={}}return(d?Tr:Zr)(t,function(E,C,L){return i(o,E,C,L)}),o}function r_(t,i){return t==null?!0:tc(t,i)}function i_(t,i,o){return t==null?t:Th(t,i,nc(o))}function n_(t,i,o,u){return u=typeof u=="function"?u:r,t==null?t:Th(t,i,nc(o),u)}function An(t){return t==null?[]:La(t,Vt(t))}function s_(t){return t==null?[]:La(t,vr(t))}function o_(t,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Mr(o),o=o===o?o:0),i!==r&&(i=Mr(i),i=i===i?i:0),Yi(Mr(t),i,o)}function a_(t,i,o){return i=yi(i),o===r?(o=i,i=0):o=yi(o),t=Mr(t),d0(t,i,o)}function c_(t,i,o){if(o&&typeof o!="boolean"&&sr(t,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof t=="boolean"&&(o=t,t=r)),t===r&&i===r?(t=0,i=1):(t=yi(t),i===r?(i=t,t=0):i=yi(i)),t>i){var u=t;t=i,i=u}if(o||t%1||i%1){var d=ch();return Qt(t+d*(i-t+at("1e-"+((d+"").length-1))),i)}return Xa(t,i)}var u_=Cn(function(t,i,o){return i=i.toLowerCase(),t+(o?jl(i):i)});function jl(t){return Ic(it(t).toLowerCase())}function ql(t){return t=it(t),t&&t.replace(ci,Zp).replace(Ca,"")}function h_(t,i,o){t=it(t),i=Dr(i);var u=t.length;o=o===r?u:Yi(Me(o),0,u);var d=o;return o-=i.length,o>=0&&t.slice(o,d)==i}function l_(t){return t=it(t),t&&vt.test(t)?t.replace(qi,eg):t}function f_(t){return t=it(t),t&&$t.test(t)?t.replace(It,"\\$&"):t}var d_=Cn(function(t,i,o){return t+(o?"-":"")+i.toLowerCase()}),p_=Cn(function(t,i,o){return t+(o?" ":"")+i.toLowerCase()}),g_=Hh("toLowerCase");function v_(t,i,o){t=it(t),i=Me(i);var u=i?bn(t):0;if(!i||u>=i)return t;var d=(i-u)/2;return Eo(co(d),o)+t+Eo(ao(d),o)}function y_(t,i,o){t=it(t),i=Me(i);var u=i?bn(t):0;return i&&u<i?t+Eo(i-u,o):t}function __(t,i,o){t=it(t),i=Me(i);var u=i?bn(t):0;return i&&u<i?Eo(i-u,o)+t:t}function m_(t,i,o){return o||i==null?i=0:i&&(i=+i),xg(it(t).replace(xt,""),i||0)}function b_(t,i,o){return(o?sr(t,i,o):i===r)?i=1:i=Me(i),Za(it(t),i)}function w_(){var t=arguments,i=it(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var E_=Cn(function(t,i,o){return t+(o?"_":"")+i.toLowerCase()});function D_(t,i,o){return o&&typeof o!="number"&&sr(t,i,o)&&(i=o=r),o=o===r?re:o>>>0,o?(t=it(t),t&&(typeof i=="string"||i!=null&&!Ec(i))&&(i=Dr(i),!i&&mn(t))?Ri(kr(t),0,o):t.split(i,o)):[]}var S_=Cn(function(t,i,o){return t+(o?" ":"")+Ic(i)});function I_(t,i,o){return t=it(t),o=o==null?0:Yi(Me(o),0,t.length),i=Dr(i),t.slice(o,o+i.length)==i}function x_(t,i,o){var u=v.templateSettings;o&&sr(t,i,o)&&(i=r),t=it(t),i=Fo({},i,u,Jh);var d=Fo({},i.imports,u.imports,Jh),y=Vt(d),E=La(d,y),C,L,J=0,Q=i.interpolate||ln,Z="__p += '",ae=Ma((i.escape||ln).source+"|"+Q.source+"|"+(Q===mt?ha:ln).source+"|"+(i.evaluate||ln).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Oa+"]")+`
`;t.replace(ae,function(Ee,We,Xe,Ir,or,xr){return Xe||(Xe=Ir),Z+=t.slice(J,xr).replace(va,tg),We&&(C=!0,Z+=`' +
__e(`+We+`) +
'`),or&&(L=!0,Z+=`';
`+or+`;
__p += '`),Xe&&(Z+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),J=xr+Ee.length,Ee}),Z+=`';
`;var we=nt.call(i,"variable")&&i.variable;if(!we)Z=`with (obj) {
`+Z+`
}
`;else if(ca.test(we))throw new Ae(f);Z=(L?Z.replace(Jr,""):Z).replace(rr,"$1").replace(ai,"$1;"),Z="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var ze=Bl(function(){return rt(y,ve+"return "+Z).apply(r,E)});if(ze.source=Z,wc(ze))throw ze;return ze}function C_(t){return it(t).toLowerCase()}function O_(t){return it(t).toUpperCase()}function P_(t,i,o){if(t=it(t),t&&(o||i===r))return Qu(t);if(!t||!(i=Dr(i)))return t;var u=kr(t),d=kr(i),y=Xu(u,d),E=Zu(u,d)+1;return Ri(u,y,E).join("")}function A_(t,i,o){if(t=it(t),t&&(o||i===r))return t.slice(0,th(t)+1);if(!t||!(i=Dr(i)))return t;var u=kr(t),d=Zu(u,kr(i))+1;return Ri(u,0,d).join("")}function N_(t,i,o){if(t=it(t),t&&(o||i===r))return t.replace(xt,"");if(!t||!(i=Dr(i)))return t;var u=kr(t),d=Xu(u,kr(i));return Ri(u,d).join("")}function T_(t,i){var o=W,u=oe;if(bt(i)){var d="separator"in i?i.separator:d;o="length"in i?Me(i.length):o,u="omission"in i?Dr(i.omission):u}t=it(t);var y=t.length;if(mn(t)){var E=kr(t);y=E.length}if(o>=y)return t;var C=o-bn(u);if(C<1)return u;var L=E?Ri(E,0,C).join(""):t.slice(0,C);if(d===r)return L+u;if(E&&(C+=L.length-C),Ec(d)){if(t.slice(C).search(d)){var J,Q=L;for(d.global||(d=Ma(d.source,it(Ar.exec(d))+"g")),d.lastIndex=0;J=d.exec(Q);)var Z=J.index;L=L.slice(0,Z===r?C:Z)}}else if(t.indexOf(Dr(d),C)!=C){var ae=L.lastIndexOf(d);ae>-1&&(L=L.slice(0,ae))}return L+u}function R_(t){return t=it(t),t&&Et.test(t)?t.replace(Si,cg):t}var F_=Cn(function(t,i,o){return t+(o?" ":"")+i.toUpperCase()}),Ic=Hh("toUpperCase");function zl(t,i,o){return t=it(t),i=o?r:i,i===r?ig(t)?lg(t):Gp(t):t.match(i)||[]}var Bl=ke(function(t,i){try{return Kt(t,r,i)}catch(o){return wc(o)?o:new Ae(o)}}),U_=pi(function(t,i){return Tr(i,function(o){o=ti(o),fi(t,o,mc(t[o],t))}),t});function L_(t){var i=t==null?0:t.length,o=me();return t=i?_t(t,function(u){if(typeof u[1]!="function")throw new Rr(p);return[o(u[0]),u[1]]}):[],ke(function(u){for(var d=-1;++d<i;){var y=t[d];if(Kt(y[0],this,u))return Kt(y[1],this,u)}})}function $_(t){return c0(Ur(t,O))}function xc(t){return function(){return t}}function M_(t,i){return t==null||t!==t?i:t}var j_=Kh(),q_=Kh(!0);function yr(t){return t}function Cc(t){return wh(typeof t=="function"?t:Ur(t,O))}function z_(t){return Dh(Ur(t,O))}function B_(t,i){return Sh(t,Ur(i,O))}var H_=ke(function(t,i){return function(o){return Xn(o,t,i)}}),k_=ke(function(t,i){return function(o){return Xn(t,o,i)}});function Oc(t,i,o){var u=Vt(i),d=go(i,u);o==null&&!(bt(i)&&(d.length||!u.length))&&(o=i,i=t,t=this,d=go(i,Vt(i)));var y=!(bt(o)&&"chain"in o)||!!o.chain,E=vi(t);return Tr(d,function(C){var L=i[C];t[C]=L,E&&(t.prototype[C]=function(){var J=this.__chain__;if(y||J){var Q=t(this.__wrapped__),Z=Q.__actions__=pr(this.__actions__);return Z.push({func:L,args:arguments,thisArg:t}),Q.__chain__=J,Q}return L.apply(t,Ci([this.value()],arguments))})}),t}function K_(){return Qe._===this&&(Qe._=yg),this}function Pc(){}function V_(t){return t=Me(t),ke(function(i){return Ih(i,t)})}var W_=oc(_t),G_=oc(Vu),Y_=oc(Na);function Hl(t){return dc(t)?Ta(ti(t)):I0(t)}function J_(t){return function(i){return t==null?r:Ji(t,i)}}var Q_=Wh(),X_=Wh(!0);function Ac(){return[]}function Nc(){return!1}function Z_(){return{}}function em(){return""}function tm(){return!0}function rm(t,i){if(t=Me(t),t<1||t>G)return[];var o=re,u=Qt(t,re);i=me(i),t-=re;for(var d=Ua(u,i);++o<t;)i(o);return d}function im(t){return Te(t)?_t(t,ti):Sr(t)?[t]:pr(ul(it(t)))}function nm(t){var i=++gg;return it(t)+i}var sm=wo(function(t,i){return t+i},0),om=ac("ceil"),am=wo(function(t,i){return t/i},1),cm=ac("floor");function um(t){return t&&t.length?po(t,yr,Va):r}function hm(t,i){return t&&t.length?po(t,me(i,2),Va):r}function lm(t){return Yu(t,yr)}function fm(t,i){return Yu(t,me(i,2))}function dm(t){return t&&t.length?po(t,yr,Ja):r}function pm(t,i){return t&&t.length?po(t,me(i,2),Ja):r}var gm=wo(function(t,i){return t*i},1),vm=ac("round"),ym=wo(function(t,i){return t-i},0);function _m(t){return t&&t.length?Fa(t,yr):0}function mm(t,i){return t&&t.length?Fa(t,me(i,2)):0}return v.after=zv,v.ary=bl,v.assign=Oy,v.assignIn=Fl,v.assignInWith=Fo,v.assignWith=Py,v.at=Ay,v.before=wl,v.bind=mc,v.bindAll=U_,v.bindKey=El,v.castArray=Zv,v.chain=yl,v.chunk=c1,v.compact=u1,v.concat=h1,v.cond=L_,v.conforms=$_,v.constant=xc,v.countBy=_v,v.create=Ny,v.curry=Dl,v.curryRight=Sl,v.debounce=Il,v.defaults=Ty,v.defaultsDeep=Ry,v.defer=Bv,v.delay=Hv,v.difference=l1,v.differenceBy=f1,v.differenceWith=d1,v.drop=p1,v.dropRight=g1,v.dropRightWhile=v1,v.dropWhile=y1,v.fill=_1,v.filter=bv,v.flatMap=Dv,v.flatMapDeep=Sv,v.flatMapDepth=Iv,v.flatten=dl,v.flattenDeep=m1,v.flattenDepth=b1,v.flip=kv,v.flow=j_,v.flowRight=q_,v.fromPairs=w1,v.functions=qy,v.functionsIn=zy,v.groupBy=xv,v.initial=D1,v.intersection=S1,v.intersectionBy=I1,v.intersectionWith=x1,v.invert=Hy,v.invertBy=ky,v.invokeMap=Ov,v.iteratee=Cc,v.keyBy=Pv,v.keys=Vt,v.keysIn=vr,v.map=Oo,v.mapKeys=Vy,v.mapValues=Wy,v.matches=z_,v.matchesProperty=B_,v.memoize=Ao,v.merge=Gy,v.mergeWith=Ul,v.method=H_,v.methodOf=k_,v.mixin=Oc,v.negate=No,v.nthArg=V_,v.omit=Yy,v.omitBy=Jy,v.once=Kv,v.orderBy=Av,v.over=W_,v.overArgs=Vv,v.overEvery=G_,v.overSome=Y_,v.partial=bc,v.partialRight=xl,v.partition=Nv,v.pick=Qy,v.pickBy=Ll,v.property=Hl,v.propertyOf=J_,v.pull=A1,v.pullAll=gl,v.pullAllBy=N1,v.pullAllWith=T1,v.pullAt=R1,v.range=Q_,v.rangeRight=X_,v.rearg=Wv,v.reject=Fv,v.remove=F1,v.rest=Gv,v.reverse=yc,v.sampleSize=Lv,v.set=Zy,v.setWith=e_,v.shuffle=$v,v.slice=U1,v.sortBy=qv,v.sortedUniq=B1,v.sortedUniqBy=H1,v.split=D_,v.spread=Yv,v.tail=k1,v.take=K1,v.takeRight=V1,v.takeRightWhile=W1,v.takeWhile=G1,v.tap=uv,v.throttle=Jv,v.thru=Co,v.toArray=Nl,v.toPairs=$l,v.toPairsIn=Ml,v.toPath=im,v.toPlainObject=Rl,v.transform=t_,v.unary=Qv,v.union=Y1,v.unionBy=J1,v.unionWith=Q1,v.uniq=X1,v.uniqBy=Z1,v.uniqWith=ev,v.unset=r_,v.unzip=_c,v.unzipWith=vl,v.update=i_,v.updateWith=n_,v.values=An,v.valuesIn=s_,v.without=tv,v.words=zl,v.wrap=Xv,v.xor=rv,v.xorBy=iv,v.xorWith=nv,v.zip=sv,v.zipObject=ov,v.zipObjectDeep=av,v.zipWith=cv,v.entries=$l,v.entriesIn=Ml,v.extend=Fl,v.extendWith=Fo,Oc(v,v),v.add=sm,v.attempt=Bl,v.camelCase=u_,v.capitalize=jl,v.ceil=om,v.clamp=o_,v.clone=ey,v.cloneDeep=ry,v.cloneDeepWith=iy,v.cloneWith=ty,v.conformsTo=ny,v.deburr=ql,v.defaultTo=M_,v.divide=am,v.endsWith=h_,v.eq=Vr,v.escape=l_,v.escapeRegExp=f_,v.every=mv,v.find=wv,v.findIndex=ll,v.findKey=Fy,v.findLast=Ev,v.findLastIndex=fl,v.findLastKey=Uy,v.floor=cm,v.forEach=_l,v.forEachRight=ml,v.forIn=Ly,v.forInRight=$y,v.forOwn=My,v.forOwnRight=jy,v.get=Dc,v.gt=sy,v.gte=oy,v.has=By,v.hasIn=Sc,v.head=pl,v.identity=yr,v.includes=Cv,v.indexOf=E1,v.inRange=a_,v.invoke=Ky,v.isArguments=Zi,v.isArray=Te,v.isArrayBuffer=ay,v.isArrayLike=gr,v.isArrayLikeObject=Nt,v.isBoolean=cy,v.isBuffer=Fi,v.isDate=uy,v.isElement=hy,v.isEmpty=ly,v.isEqual=fy,v.isEqualWith=dy,v.isError=wc,v.isFinite=py,v.isFunction=vi,v.isInteger=Cl,v.isLength=To,v.isMap=Ol,v.isMatch=gy,v.isMatchWith=vy,v.isNaN=yy,v.isNative=_y,v.isNil=by,v.isNull=my,v.isNumber=Pl,v.isObject=bt,v.isObjectLike=Ot,v.isPlainObject=ns,v.isRegExp=Ec,v.isSafeInteger=wy,v.isSet=Al,v.isString=Ro,v.isSymbol=Sr,v.isTypedArray=Pn,v.isUndefined=Ey,v.isWeakMap=Dy,v.isWeakSet=Sy,v.join=C1,v.kebabCase=d_,v.last=$r,v.lastIndexOf=O1,v.lowerCase=p_,v.lowerFirst=g_,v.lt=Iy,v.lte=xy,v.max=um,v.maxBy=hm,v.mean=lm,v.meanBy=fm,v.min=dm,v.minBy=pm,v.stubArray=Ac,v.stubFalse=Nc,v.stubObject=Z_,v.stubString=em,v.stubTrue=tm,v.multiply=gm,v.nth=P1,v.noConflict=K_,v.noop=Pc,v.now=Po,v.pad=v_,v.padEnd=y_,v.padStart=__,v.parseInt=m_,v.random=c_,v.reduce=Tv,v.reduceRight=Rv,v.repeat=b_,v.replace=w_,v.result=Xy,v.round=vm,v.runInContext=F,v.sample=Uv,v.size=Mv,v.snakeCase=E_,v.some=jv,v.sortedIndex=L1,v.sortedIndexBy=$1,v.sortedIndexOf=M1,v.sortedLastIndex=j1,v.sortedLastIndexBy=q1,v.sortedLastIndexOf=z1,v.startCase=S_,v.startsWith=I_,v.subtract=ym,v.sum=_m,v.sumBy=mm,v.template=x_,v.times=rm,v.toFinite=yi,v.toInteger=Me,v.toLength=Tl,v.toLower=C_,v.toNumber=Mr,v.toSafeInteger=Cy,v.toString=it,v.toUpper=O_,v.trim=P_,v.trimEnd=A_,v.trimStart=N_,v.truncate=T_,v.unescape=R_,v.uniqueId=nm,v.upperCase=F_,v.upperFirst=Ic,v.each=_l,v.eachRight=ml,v.first=pl,Oc(v,function(){var t={};return Zr(v,function(i,o){nt.call(v.prototype,o)||(t[o]=i)}),t}(),{chain:!1}),v.VERSION=s,Tr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){v[t].placeholder=v}),Tr(["drop","take"],function(t,i){Ye.prototype[t]=function(o){o=o===r?1:kt(Me(o),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Qt(o,u.__takeCount__):u.__views__.push({size:Qt(o,re),type:t+(u.__dir__<0?"Right":"")}),u},Ye.prototype[t+"Right"]=function(o){return this.reverse()[t](o).reverse()}}),Tr(["filter","map","takeWhile"],function(t,i){var o=i+1,u=o==T||o==le;Ye.prototype[t]=function(d){var y=this.clone();return y.__iteratees__.push({iteratee:me(d,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),Tr(["head","last"],function(t,i){var o="take"+(i?"Right":"");Ye.prototype[t]=function(){return this[o](1).value()[0]}}),Tr(["initial","tail"],function(t,i){var o="drop"+(i?"":"Right");Ye.prototype[t]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(yr)},Ye.prototype.find=function(t){return this.filter(t).head()},Ye.prototype.findLast=function(t){return this.reverse().find(t)},Ye.prototype.invokeMap=ke(function(t,i){return typeof t=="function"?new Ye(this):this.map(function(o){return Xn(o,t,i)})}),Ye.prototype.reject=function(t){return this.filter(No(me(t)))},Ye.prototype.slice=function(t,i){t=Me(t);var o=this;return o.__filtered__&&(t>0||i<0)?new Ye(o):(t<0?o=o.takeRight(-t):t&&(o=o.drop(t)),i!==r&&(i=Me(i),o=i<0?o.dropRight(-i):o.take(i-t)),o)},Ye.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Zr(Ye.prototype,function(t,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),d=v[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);d&&(v.prototype[i]=function(){var E=this.__wrapped__,C=u?[1]:arguments,L=E instanceof Ye,J=C[0],Q=L||Te(E),Z=function(We){var Xe=d.apply(v,Ci([We],C));return u&&ae?Xe[0]:Xe};Q&&o&&typeof J=="function"&&J.length!=1&&(L=Q=!1);var ae=this.__chain__,ve=!!this.__actions__.length,we=y&&!ae,ze=L&&!ve;if(!y&&Q){E=ze?E:new Ye(this);var Ee=t.apply(E,C);return Ee.__actions__.push({func:Co,args:[Z],thisArg:r}),new Fr(Ee,ae)}return we&&ze?t.apply(this,C):(Ee=this.thru(Z),we?u?Ee.value()[0]:Ee.value():Ee)})}),Tr(["pop","push","shift","sort","splice","unshift"],function(t){var i=Xs[t],o=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",u=/^(?:pop|shift)$/.test(t);v.prototype[t]=function(){var d=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(Te(y)?y:[],d)}return this[o](function(E){return i.apply(Te(E)?E:[],d)})}}),Zr(Ye.prototype,function(t,i){var o=v[i];if(o){var u=o.name+"";nt.call(Sn,u)||(Sn[u]=[]),Sn[u].push({name:i,func:o})}}),Sn[bo(r,ie).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=Rg,Ye.prototype.reverse=Fg,Ye.prototype.value=Ug,v.prototype.at=hv,v.prototype.chain=lv,v.prototype.commit=fv,v.prototype.next=dv,v.prototype.plant=gv,v.prototype.reverse=vv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=yv,v.prototype.first=v.prototype.head,Kn&&(v.prototype[Kn]=pv),v},wn=fg();At?((At.exports=wn)._=wn,ct._=wn):Qe._=wn}).call(gs)})(bu,bu.exports);var g5=Object.defineProperty,v5=Object.defineProperties,y5=Object.getOwnPropertyDescriptors,Ed=Object.getOwnPropertySymbols,_5=Object.prototype.hasOwnProperty,m5=Object.prototype.propertyIsEnumerable,Dd=(n,e,r)=>e in n?g5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,$o=(n,e)=>{for(var r in e||(e={}))_5.call(e,r)&&Dd(n,r,e[r]);if(Ed)for(var r of Ed(e))m5.call(e,r)&&Dd(n,r,e[r]);return n},b5=(n,e)=>v5(n,y5(e));function qr(n,e,r){let s;const a=wu(n);return e.rpcMap&&(s=e.rpcMap[a]),s||(s=`${p5}?chainId=eip155:${a}&projectId=${r}`),s}function wu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function zp(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function w5(n,e){const r=Object.keys(e.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const h=e.namespaces[a].accounts;s.push(...h)}),s}function E5(n={},e={}){const r=Sd(n),s=Sd(e);return bu.exports.merge(r,s)}function Sd(n){var e,r,s,a;const h={};if(!Un(n))return h;for(const[p,f]of Object.entries(n)){const g=Ru(p)?[p]:f.chains,w=f.methods||[],D=f.events||[],O=f.rpcMap||{},$=vs(p);h[$]=b5($o($o({},h[$]),f),{chains:$c(g,(e=h[$])==null?void 0:e.chains),methods:$c(w,(r=h[$])==null?void 0:r.methods),events:$c(D,(s=h[$])==null?void 0:s.events),rpcMap:$o($o({},O),(a=h[$])==null?void 0:a.rpcMap)})}return h}function D5(n){return n.includes(":")?n.split(":")[2]:n}function S5(n){const e={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],h=s.events||[],p=s.accounts||[],f=Ru(r)?[r]:s.chains?s.chains:zp(s.accounts);e[r]={chains:f,methods:a,events:h,accounts:p}}return e}function Jc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Bp={},Ft=n=>Bp[n],Qc=(n,e)=>{Bp[n]=e};class I5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||qr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||qr(e,this.namespace);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}class x5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const s=wu(e);if(!this.httpProviders[s]){const a=r||qr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const s=r||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=wu(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,s;let a=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class C5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||qr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}class O5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||qr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}class P5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);e[r]=this.createHttpProvider(r,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}class A5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||qr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}class N5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||qr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||qr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Mi(new hn(s,Ft("disableProviderPing")))}}var T5=Object.defineProperty,R5=Object.defineProperties,F5=Object.getOwnPropertyDescriptors,Id=Object.getOwnPropertySymbols,U5=Object.prototype.hasOwnProperty,L5=Object.prototype.propertyIsEnumerable,xd=(n,e,r)=>e in n?T5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Mo=(n,e)=>{for(var r in e||(e={}))U5.call(e,r)&&xd(n,r,e[r]);if(Id)for(var r of Id(e))L5.call(e,r)&&xd(n,r,e[r]);return n},Xc=(n,e)=>R5(n,F5(e));class ku{constructor(e){this.events=new lr,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||bd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new ku(e);return await r.initialize(),r}async request(e,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Mo({},e),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(e,r,s){this.request(e,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Rt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=S5(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==jp)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[s,a]=this.validateChain(e);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(oi(r)){for(const s of r)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await qp.init({logger:this.providerOpts.logger||bd,relayUrl:this.providerOpts.relayUrl||l5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>vs(r)))];Qc("client",this.client),Qc("events",this.events),Qc("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const s=w5(r,this.session),a=zp(s),h=E5(this.namespaces,this.optionalNamespaces),p=Xc(Mo({},h[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new x5({namespace:p});break;case"solana":this.rpcProviders[r]=new C5({namespace:p});break;case"cosmos":this.rpcProviders[r]=new O5({namespace:p});break;case"polkadot":this.rpcProviders[r]=new I5({namespace:p});break;case"cip34":this.rpcProviders[r]=new P5({namespace:p});break;case"elrond":this.rpcProviders[r]=new A5({namespace:p});break;case"multiversx":this.rpcProviders[r]=new N5({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&oi(a)&&this.events.emit("accountsChanged",a.map(D5))}else if(s.name==="chainChanged"){const a=r.chainId,h=r.event.data,p=vs(a),f=Jc(a)!==Jc(h)?`${p}:${Jc(h)}`:a;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var s;const{namespaces:a}=r,h=(s=this.client)==null?void 0:s.session.get(e);this.session=Xc(Mo({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Xc(Mo({},Rt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(ji.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=e;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(e){const[r,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>vs(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=vs(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){var s;if(!this.namespaces)return;const[a,h]=this.validateChain(e);r||this.getProvider(a).setDefaultChain(h),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${wd}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${wd}/${e}`)}}const $5=ku,M5="wc",j5="ethereum_provider",q5=`${M5}@2:${j5}:`,z5="https://rpc.walletconnect.com/v1/",Eu=["eth_sendTransaction","personal_sign"],B5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Du=["chainChanged","accountsChanged"],H5=["message","disconnect","connect"];var k5=Object.defineProperty,K5=Object.defineProperties,V5=Object.getOwnPropertyDescriptors,Cd=Object.getOwnPropertySymbols,W5=Object.prototype.hasOwnProperty,G5=Object.prototype.propertyIsEnumerable,Od=(n,e,r)=>e in n?k5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ys=(n,e)=>{for(var r in e||(e={}))W5.call(e,r)&&Od(n,r,e[r]);if(Cd)for(var r of Cd(e))G5.call(e,r)&&Od(n,r,e[r]);return n},Pd=(n,e)=>K5(n,V5(e));function Yo(n){return Number(n[0].split(":")[1])}function Zc(n){return`0x${n.toString(16)}`}function Y5(n){const{chains:e,optionalChains:r,methods:s,optionalMethods:a,events:h,optionalEvents:p,rpcMap:f}=n;if(!oi(e))throw new Error("Invalid chains");const g={chains:e,methods:s||Eu,events:h||Du,rpcMap:ys({},e.length?{[Yo(e)]:f[Yo(e)]}:{})},w=h==null?void 0:h.filter(A=>!Du.includes(A)),D=s==null?void 0:s.filter(A=>!Eu.includes(A));if(!r&&!p&&!a&&!(w!=null&&w.length)&&!(D!=null&&D.length))return{required:e.length?g:void 0};const O=(w==null?void 0:w.length)&&(D==null?void 0:D.length)||!r,$={chains:[...new Set(O?g.chains.concat(r||[]):r)],methods:[...new Set(g.methods.concat(a!=null&&a.length?a:B5))],events:[...new Set(g.events.concat(p||H5))],rpcMap:f};return{required:e.length?g:void 0,optional:r.length?$:void 0}}class Ku{constructor(){this.events=new lr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=q5,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new Ku;return await r.initialize(e),r}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,r){this.signer.sendAsync(e,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:s}=Y5(this.rpc);try{const a=await new Promise(async(p,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(w=>{!w.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Pd(ys({namespaces:ys({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(w=>{p(w)}).catch(w=>{f(new Error(w.message))})});if(!a)return;const h=Qw(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:Zc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Zc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Pd(ys({},Rt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Zc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,s,a]=e.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,s;const a=(r=e==null?void 0:e.chains)!=null?r:[],h=(s=e==null?void 0:e.optionalChains)!=null?s:[],p=a.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=a.length?(e==null?void 0:e.methods)||Eu:[],g=a.length?(e==null?void 0:e.events)||Du:[],w=(e==null?void 0:e.optionalMethods)||[],D=(e==null?void 0:e.optionalEvents)||[],O=(e==null?void 0:e.rpcMap)||this.buildRpcMap(p,e.projectId),$=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(A=>this.formatChainId(A)),optionalChains:h.map(A=>this.formatChainId(A)),methods:f,events:g,optionalMethods:w,optionalEvents:D,rpcMap:O,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:$,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const s={};return e.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Yo(this.rpc.chains):Yo(this.rpc.optionalChains),this.signer=await $5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Em(()=>import("./index-3f03bcf9.js").then(a=>a.i),["assets/index-3f03bcf9.js","assets/useDarkMode-6a81be08.js","assets/browser-6c45db04.js","assets/runtime-core.esm-bundler-558f8953.js","assets/_commonjsHelpers-87174ba5.js","assets/connector-16147cef.js"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ys({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:s,rpcMap:a}=e;r&&oi(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),s&&oi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(e,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${z5}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const J5=Ku,{MAINNET:eu,ARBITRUM:tu,AVALANCHE:ru,BASE:iu,GNOSIS:nu,POLYGON:su,ZKEVM:ou}=xm;class _S extends Sm{constructor(){super(...arguments);Kl(this,"id",Im.WalletConnect)}async connect(){const r=await J5.init({projectId:"ee9c0c7e1b8b86ebdfb8fd93bb116ca8",chains:[eu],optionalChains:[ru,tu,iu,nu,su,ou],rpcMap:{[eu]:en.getNetworkRpc(eu),[tu]:en.getNetworkRpc(tu),[ru]:en.getNetworkRpc(ru),[iu]:en.getNetworkRpc(iu),[nu]:en.getNetworkRpc(nu),[su]:en.getNetworkRpc(su),[ou]:en.getNetworkRpc(ou)},showQrModal:!0,qrModalOptions:{themeMode:Dm().darkMode?"dark":"light"}});this.provider=r;try{const s=await r.enable(),a=await r.request({method:"eth_chainId"});this.handleChainChanged(a),this.handleAccountsChanged(s)}catch(s){s.code===4001?console.log("Please connect to WalletConnect."):console.error(s)}return{provider:r,account:this.account,chainId:this.chainId}}}export{_S as WalletConnectConnector};
//# sourceMappingURL=walletconnect.connector-d9a3fa55.js.map
